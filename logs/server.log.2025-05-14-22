[2025-05-14 22:49:11,064] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-14 22:49:11,693] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-14 22:49:11,696] INFO [ControllerServer id=10] Starting controller (kafka.server.ControllerServer)
[2025-05-14 22:49:11,729] INFO [StandardAuthorizer 10] set super.users=User:admin, default result=DENIED (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:49:12,213] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-14 22:49:12,265] INFO [SocketServer listenerType=CONTROLLER, nodeId=10] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-14 22:49:12,275] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU. (org.apache.kafka.metadata.ListenerInfo)
[2025-05-14 22:49:12,286] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-14 22:49:12,288] INFO [SharedServer id=10] Starting SharedServer (kafka.server.SharedServer)
[2025-05-14 22:49:12,380] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:49:12,381] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:49:12,385] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:49:12,432] INFO Initialized snapshots with IDs SortedSet() from /home/ammar/kafka_data/broker_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-14 22:49:12,453] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-14 22:49:12,469] INFO [RaftManager id=10] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:49:12,472] INFO [RaftManager id=10] Starting voters are VoterSet(voters={10=VoterNode(voterKey=ReplicaKey(id=10, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:49:12,474] INFO [RaftManager id=10] Starting request manager with static voters: [localhost:9093 (id: 10 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:49:12,479] INFO [RaftManager id=10] Attempting durable transition to UnattachedState(epoch=0, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[10], electionTimeoutMs=1164, highWatermark=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:49:12,511] INFO [RaftManager id=10] Completed transition to UnattachedState(epoch=0, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[10], electionTimeoutMs=1164, highWatermark=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:49:12,518] INFO [RaftManager id=10] Completed transition to ProspectiveState(epoch=0, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1660, highWatermark=Optional.empty) from UnattachedState(epoch=0, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[10], electionTimeoutMs=1164, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:49:12,523] INFO [RaftManager id=10] Attempting durable transition to CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=1, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1420) from ProspectiveState(epoch=0, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1660, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:49:12,537] INFO [RaftManager id=10] Completed transition to CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=1, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1420) from ProspectiveState(epoch=0, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1660, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:49:12,544] INFO [RaftManager id=10] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=10, directoryId=Cco6adTtSDDCzLYisIcG7w), epoch=1, epochStartOffset=0, highWatermark=Optional.empty, voterStates={10=ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=1, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1420) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:49:12,554] INFO [RaftManager id=10] Completed transition to Leader(localReplicaKey=ReplicaKey(id=10, directoryId=Cco6adTtSDDCzLYisIcG7w), epoch=1, epochStartOffset=0, highWatermark=Optional.empty, voterStates={10=ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=1, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1420) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:49:12,586] INFO [kafka-10-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-14 22:49:12,586] INFO [kafka-10-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-14 22:49:12,606] INFO [MetadataLoader id=10] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,607] INFO [ControllerServer id=10] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-14 22:49:12,608] INFO [ControllerServer id=10] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-14 22:49:12,625] INFO [RaftManager id=10] High watermark set to LogOffsetMetadata(offset=1, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=91)]) for the first time for epoch 1 based on indexOfHw 0 and voters [ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=1, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=91)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-14 22:49:12,641] INFO [RaftManager id=10] Registered the listener org.apache.kafka.image.loader.MetadataLoader@1216506173 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:49:12,643] INFO [RaftManager id=10] Setting the next offset of org.apache.kafka.image.loader.MetadataLoader@1216506173 to 0 since there are no snapshots (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:49:12,646] INFO [MetadataLoader id=10] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have not loaded a controller record as of offset 0 and high water mark is 1 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,663] INFO [RaftManager id=10] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@1693760040 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:49:12,664] INFO [RaftManager id=10] Setting the next offset of org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@1693760040 to 0 since there are no snapshots (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:49:12,672] INFO [controller-10-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,675] INFO [controller-10-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,677] INFO [controller-10-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,680] INFO [controller-10-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,702] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:12,707] INFO [MetadataLoader id=10] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 0, but the high water mark is 6 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,714] INFO [MetadataLoader id=10] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 6 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,717] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,728] INFO [ControllerServer id=10] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-14 22:49:12,728] INFO [ControllerServer id=10] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-14 22:49:12,728] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,729] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,729] INFO [SocketServer listenerType=CONTROLLER, nodeId=10] Enabling request processing. (kafka.network.SocketServer)
[2025-05-14 22:49:12,732] INFO [ControllerServer id=10] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=5). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-14 22:49:12,733] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,733] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,733] INFO Awaiting socket connections on 0.0.0.0:9093. (kafka.network.DataPlaneAcceptor)
[2025-05-14 22:49:12,747] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=10 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,748] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=10 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,751] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=10 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,752] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ScramPublisher controller id=10 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,753] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=10 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,757] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,761] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing AclPublisher controller id=10 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:12,763] INFO [AclPublisher controller id=10] Loading authorizer snapshot at offset 5 (kafka.server.metadata.AclPublisher)
[2025-05-14 22:49:12,764] INFO [StandardAuthorizer 10] Initialized with 0 acl(s). (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:49:12,765] INFO [StandardAuthorizer 10] Completed initial ACL load process. (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:49:12,768] INFO [controller-10-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,771] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:12,772] INFO [ControllerServer id=10] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-14 22:49:12,773] INFO [ControllerServer id=10] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-14 22:49:12,773] INFO [ControllerServer id=10] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-14 22:49:12,773] INFO [controller-10-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,774] INFO [ControllerServer id=10] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-14 22:49:12,776] INFO [BrokerServer id=10] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-14 22:49:12,778] INFO [BrokerServer id=10] Starting broker (kafka.server.BrokerServer)
[2025-05-14 22:49:12,788] INFO [broker-10-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,789] INFO [broker-10-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,790] INFO [broker-10-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,790] INFO [broker-10-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:49:12,792] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:12,818] INFO [BrokerServer id=10] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-14 22:49:12,818] INFO [BrokerServer id=10] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-14 22:49:12,821] INFO [broker-10-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,822] INFO [broker-10-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,835] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:49:12,876] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-14 22:49:12,883] INFO [SocketServer listenerType=BROKER, nodeId=10] Created data-plane acceptor and processors for endpoint : ListenerName(PLAINTEXT) (kafka.network.SocketServer)
[2025-05-14 22:49:12,885] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-14 22:49:12,906] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=0, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=0, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@5b2b5748, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:12,921] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:12,943] INFO Successfully logged in. (org.apache.kafka.common.security.authenticator.AbstractLogin)
[2025-05-14 22:49:12,950] INFO [SocketServer listenerType=BROKER, nodeId=10] Created data-plane acceptor and processors for endpoint : ListenerName(SASL_PLAINTEXT) (kafka.network.SocketServer)
[2025-05-14 22:49:12,957] INFO [broker-10-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,958] INFO [broker-10-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,971] INFO [broker-10-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,972] INFO [broker-10-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:12,988] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:12,989] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:12,990] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:12,992] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:12,994] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:12,995] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:13,018] INFO [BrokerServer id=10] Using no op persister (kafka.server.BrokerServer)
[2025-05-14 22:49:13,020] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:49:13,023] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:13,027] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=2, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=2, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@4d519a67, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:13,029] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:13,057] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:49:13,057] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:49:13,057] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:49:13,058] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:49:13,092] INFO Unable to read the broker epoch in /home/ammar/kafka_data/broker_4.0.0. (kafka.log.LogManager)
[2025-05-14 22:49:13,093] INFO [broker-10-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:13,094] INFO [StandardAuthorizer 10] set super.users=User:admin, default result=DENIED (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:49:13,094] INFO [broker-10-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:49:13,098] INFO [BrokerLifecycleManager id=10] Incarnation 51flxqKiTv21WCq9PErskw of broker 10 in cluster 53umScLzTeajz4ICoMMl1A is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:13,144] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:49:13,147] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=0, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=0, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@31820587, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:13,156] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:13,177] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:49:13,204] INFO [BrokerServer id=10] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-14 22:49:13,204] INFO [BrokerServer id=10] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-14 22:49:13,205] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing MetadataVersionPublisher(id=10) with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:13,205] INFO [BrokerServer id=10] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-14 22:49:13,205] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:13,206] INFO [BrokerMetadataPublisher id=10] Publishing initial metadata at offset OffsetAndEpoch(offset=5, epoch=1) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-14 22:49:13,208] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker_4.0.0) (kafka.log.LogManager)
[2025-05-14 22:49:13,212] INFO No logs found to be loaded in /home/ammar/kafka_data/broker_4.0.0 (kafka.log.LogManager)
[2025-05-14 22:49:13,233] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:13,233] INFO Loaded 0 logs in 21ms (kafka.log.LogManager)
[2025-05-14 22:49:13,235] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-14 22:49:13,236] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=3, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=3, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@7017af54, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:13,238] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:13,239] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-14 22:49:13,261] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=2, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=2, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@2486deba, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:13,263] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:13,370] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-14 22:49:13,375] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-14 22:49:13,376] INFO [AddPartitionsToTxnSenderThread-10]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-14 22:49:13,377] INFO [GroupCoordinator id=10] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-14 22:49:13,379] INFO [GroupCoordinator id=10] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-14 22:49:13,381] INFO [TransactionCoordinator id=10] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-14 22:49:13,384] INFO [TxnMarkerSenderThread-10]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-14 22:49:13,384] INFO [TransactionCoordinator id=10] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-14 22:49:13,394] INFO [AclPublisher broker id=10] Loading authorizer snapshot at offset 5 (kafka.server.metadata.AclPublisher)
[2025-05-14 22:49:13,394] INFO [StandardAuthorizer 10] Initialized with 0 acl(s). (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:49:13,395] INFO [StandardAuthorizer 10] Completed initial ACL load process. (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:49:13,398] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=10) with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:49:13,464] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=3, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=3, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@7ed04f26, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:13,465] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:13,644] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:13,646] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=4, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=4, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@12b8b6d2, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:13,647] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:13,864] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=4, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=4, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@55804d1f, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:13,865] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:14,459] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:14,463] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=5, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=5, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@2a41345a, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:14,465] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:14,664] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=5, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=5, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@7aefc424, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:14,665] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:16,042] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:16,044] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=6, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=6, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@524f73f1, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:16,046] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:16,247] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=6, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=6, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@2e7eb5ca, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:16,248] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:19,226] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:19,228] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=7, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=7, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@6b7c3e61, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:19,229] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:19,511] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=7, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=7, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@799d4eba, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:19,513] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:24,017] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=8, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=8, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@5b47b9df, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:24,019] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:25,681] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:25,683] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=8, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=8, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@50cced91, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:25,684] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:28,471] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=9, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=9, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@3fed451d, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:28,472] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:35,913] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=10, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=10, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@5a5d5637, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:35,915] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:40,351] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=11, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=11, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@72cd20bb, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:40,352] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:41,341] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:41,343] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=9, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=9, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@5f78266f, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:41,344] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:49:44,788] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=12, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=12, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@350df814, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:44,790] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:49,263] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=13, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=13, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@468aa36f, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:49,267] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:53,769] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=14, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=14, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@30f39e7, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:53,770] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:49:58,222] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=15, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=15, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@484d55ce, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:49:58,223] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:50:02,725] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=16, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=16, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@40da52b4, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:50:02,726] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:50:07,228] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=17, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=17, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@7fe78f53, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:50:07,229] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:50:07,306] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:50:07,308] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=10, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=10, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@14feea3c, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:50:07,309] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:50:14,649] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=18, headerVersion=2) -- BrokerRegistrationRequestData(brokerId=10, clusterId='53umScLzTeajz4ICoMMl1A', incarnationId=51flxqKiTv21WCq9PErskw, listeners=[Listener(name='PLAINTEXT', host='172.23.38.230', port=9092, securityProtocol=0), Listener(name='SASL_PLAINTEXT', host='172.23.38.230', port=9094, securityProtocol=2)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)], rack=null, isMigratingZkBroker=false, logDirs=[Cco6adTtSDDCzLYisIcG7w], previousBrokerEpoch=-1) with context RequestContext(header=RequestHeader(apiKey=BROKER_REGISTRATION, apiVersion=4, clientId=10, correlationId=18, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44530-1-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b95340a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=1, connectionId=127.0.0.1:9093-127.0.0.1:44530-1-0, session=org.apache.kafka.network.Session@4c72c81f, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:50:14,652] INFO [BrokerLifecycleManager id=10] Unable to register broker 10 because the controller returned error CLUSTER_AUTHORIZATION_FAILED (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:50:15,192] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-14 22:50:15,817] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-14 22:50:15,821] INFO [ControllerServer id=10] Starting controller (kafka.server.ControllerServer)
[2025-05-14 22:50:15,851] INFO [StandardAuthorizer 10] set super.users=User:ANONYMOUS,User:admin, default result=DENIED (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:50:16,283] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-14 22:50:16,328] INFO [SocketServer listenerType=CONTROLLER, nodeId=10] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-14 22:50:16,337] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU. (org.apache.kafka.metadata.ListenerInfo)
[2025-05-14 22:50:16,343] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-14 22:50:16,345] INFO [SharedServer id=10] Starting SharedServer (kafka.server.SharedServer)
[2025-05-14 22:50:16,411] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Recovering unflushed segment 0. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-14 22:50:16,415] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:50:16,417] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:50:16,425] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:50:16,455] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 121 with 0 producer ids in 8 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-14 22:50:16,465] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Loading producer state till offset 121 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:50:16,467] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 121 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:50:16,470] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=121, file=/home/ammar/kafka_data/broker_4.0.0/__cluster_metadata-0/00000000000000000121.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-14 22:50:16,473] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Producer state recovery took 6ms for snapshot load and 0ms for segment recovery from offset 121 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:50:16,525] INFO Initialized snapshots with IDs SortedSet() from /home/ammar/kafka_data/broker_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-14 22:50:16,547] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-14 22:50:16,569] INFO [RaftManager id=10] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:16,595] INFO [RaftManager id=10] Starting voters are VoterSet(voters={10=VoterNode(voterKey=ReplicaKey(id=10, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:16,598] INFO [RaftManager id=10] Starting request manager with static voters: [localhost:9093 (id: 10 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:16,618] INFO [RaftManager id=10] Attempting durable transition to ResignedState(localId=10, epoch=1, voters=[10], electionTimeoutMs=1495, unackedVoters=[], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:50:16,641] INFO [RaftManager id=10] Completed transition to ResignedState(localId=10, epoch=1, voters=[10], electionTimeoutMs=1495, unackedVoters=[], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:50:16,647] INFO [RaftManager id=10] Completed transition to ProspectiveState(epoch=1, leaderId=OptionalInt[10], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1466, highWatermark=Optional.empty) from ResignedState(localId=10, epoch=1, voters=[10], electionTimeoutMs=1495, unackedVoters=[], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:50:16,649] INFO [RaftManager id=10] Attempting durable transition to CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=2, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1452) from ProspectiveState(epoch=1, leaderId=OptionalInt[10], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1466, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:50:16,660] INFO [RaftManager id=10] Completed transition to CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=2, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1452) from ProspectiveState(epoch=1, leaderId=OptionalInt[10], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1466, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:50:16,664] INFO [RaftManager id=10] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=10, directoryId=Cco6adTtSDDCzLYisIcG7w), epoch=2, epochStartOffset=121, highWatermark=Optional.empty, voterStates={10=ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=2, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1452) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:50:16,675] INFO [RaftManager id=10] Completed transition to Leader(localReplicaKey=ReplicaKey(id=10, directoryId=Cco6adTtSDDCzLYisIcG7w), epoch=2, epochStartOffset=121, highWatermark=Optional.empty, voterStates={10=ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=2, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1452) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:50:16,696] INFO [kafka-10-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-14 22:50:16,696] INFO [kafka-10-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-14 22:50:16,720] INFO [MetadataLoader id=10] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,722] INFO [ControllerServer id=10] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-14 22:50:16,722] INFO [ControllerServer id=10] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-14 22:50:16,730] INFO [RaftManager id=10] High watermark set to LogOffsetMetadata(offset=122, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=8655)]) for the first time for epoch 2 based on indexOfHw 0 and voters [ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=122, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=8655)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-14 22:50:16,746] INFO [RaftManager id=10] Registered the listener org.apache.kafka.image.loader.MetadataLoader@1948959165 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:16,748] INFO [RaftManager id=10] Setting the next offset of org.apache.kafka.image.loader.MetadataLoader@1948959165 to 0 since there are no snapshots (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:16,752] INFO [MetadataLoader id=10] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have loaded up to offset 0, but the high water mark is 122 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,767] INFO [MetadataLoader id=10] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 122 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,770] INFO [RaftManager id=10] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@501452296 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:16,770] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,770] INFO [RaftManager id=10] Setting the next offset of org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@501452296 to 0 since there are no snapshots (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:16,779] INFO [controller-10-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:16,783] INFO [controller-10-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:16,786] INFO [controller-10-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:16,788] INFO [controller-10-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:16,807] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:16,827] INFO [ControllerServer id=10] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-14 22:50:16,827] INFO [ControllerServer id=10] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-14 22:50:16,827] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,827] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,828] INFO [SocketServer listenerType=CONTROLLER, nodeId=10] Enabling request processing. (kafka.network.SocketServer)
[2025-05-14 22:50:16,830] INFO [ControllerServer id=10] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=121). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-14 22:50:16,840] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,840] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,842] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,845] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,847] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,848] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ScramPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,858] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,861] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,862] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing AclPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:50:16,864] INFO [AclPublisher controller id=10] Loading authorizer snapshot at offset 121 (kafka.server.metadata.AclPublisher)
[2025-05-14 22:50:16,866] INFO [StandardAuthorizer 10] Initialized with 0 acl(s). (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:50:16,866] INFO [StandardAuthorizer 10] Completed initial ACL load process. (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:50:16,844] ERROR Unable to start acceptor for ListenerName(CONTROLLER) (kafka.network.DataPlaneAcceptor)
org.apache.kafka.common.KafkaException: Socket server failed to bind to 0.0.0.0:9093: Address already in use.
	at org.apache.kafka.server.ServerSocketFactory$KafkaServerSocketFactory.openServerSocket(ServerSocketFactory.java:56) ~[kafka-server-4.0.0.jar:?]
	at kafka.network.Acceptor.openServerSocket(SocketServer.scala:642) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.liftedTree1$1(SocketServer.scala:543) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.start(SocketServer.scala:538) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$2(SocketServer.scala:196) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:887) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2325) ~[?:?]
	at kafka.network.SocketServer.chainAcceptorFuture$1(SocketServer.scala:189) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$4(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.ConcurrentHashMap$ValuesView.forEach(ConcurrentHashMap.java:4780) ~[?:?]
	at kafka.network.SocketServer.enableRequestProcessing(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.ControllerServer.startup(ControllerServer.scala:390) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$1(KafkaRaftServer.scala:95) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$1$adapted(KafkaRaftServer.scala:95) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.KafkaRaftServer.startup(KafkaRaftServer.scala:95) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka$.main(Kafka.scala:97) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka.main(Kafka.scala) [kafka_2.13-4.0.0.jar:?]
Caused by: java.net.BindException: Address already in use
	at java.base/sun.nio.ch.Net.bind0(Native Method) ~[?:?]
	at java.base/sun.nio.ch.Net.bind(Net.java:555) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.netBind(ServerSocketChannelImpl.java:337) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:294) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:89) ~[?:?]
	at org.apache.kafka.server.ServerSocketFactory$KafkaServerSocketFactory.openServerSocket(ServerSocketFactory.java:53) ~[kafka-server-4.0.0.jar:?]
	... 18 more
[2025-05-14 22:50:16,881] INFO [controller-10-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:16,882] INFO [ControllerRegistrationManager id=10 incarnation=OTscv7y-SSqnMKyRXgJvjw] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:50:16,882] INFO [ControllerServer id=10] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-14 22:50:16,882] INFO [ControllerServer id=10] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-14 22:50:16,882] INFO [controller-10-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:16,882] INFO [ControllerServer id=10] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-14 22:50:16,883] ERROR [ControllerServer id=10] Received a fatal error while waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
java.lang.RuntimeException: Unable to start acceptor for ListenerName(CONTROLLER)
	at kafka.network.Acceptor.liftedTree1$1(SocketServer.scala:558) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.start(SocketServer.scala:538) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$2(SocketServer.scala:196) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:887) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2325) ~[?:?]
	at kafka.network.SocketServer.chainAcceptorFuture$1(SocketServer.scala:189) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$4(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.ConcurrentHashMap$ValuesView.forEach(ConcurrentHashMap.java:4780) ~[?:?]
	at kafka.network.SocketServer.enableRequestProcessing(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.ControllerServer.startup(ControllerServer.scala:390) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$1(KafkaRaftServer.scala:95) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$1$adapted(KafkaRaftServer.scala:95) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.KafkaRaftServer.startup(KafkaRaftServer.scala:95) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka$.main(Kafka.scala:97) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka.main(Kafka.scala) [kafka_2.13-4.0.0.jar:?]
Caused by: org.apache.kafka.common.KafkaException: Socket server failed to bind to 0.0.0.0:9093: Address already in use.
	at org.apache.kafka.server.ServerSocketFactory$KafkaServerSocketFactory.openServerSocket(ServerSocketFactory.java:56) ~[kafka-server-4.0.0.jar:?]
	at kafka.network.Acceptor.openServerSocket(SocketServer.scala:642) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.liftedTree1$1(SocketServer.scala:543) ~[kafka_2.13-4.0.0.jar:?]
	... 16 more
Caused by: java.net.BindException: Address already in use
	at java.base/sun.nio.ch.Net.bind0(Native Method) ~[?:?]
	at java.base/sun.nio.ch.Net.bind(Net.java:555) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.netBind(ServerSocketChannelImpl.java:337) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:294) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:89) ~[?:?]
	at org.apache.kafka.server.ServerSocketFactory$KafkaServerSocketFactory.openServerSocket(ServerSocketFactory.java:53) ~[kafka-server-4.0.0.jar:?]
	at kafka.network.Acceptor.openServerSocket(SocketServer.scala:642) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.liftedTree1$1(SocketServer.scala:543) ~[kafka_2.13-4.0.0.jar:?]
	... 16 more
[2025-05-14 22:50:16,885] ERROR Encountered fatal fault: caught exception (org.apache.kafka.server.fault.ProcessTerminatingFaultHandler)
java.lang.RuntimeException: Received a fatal error while waiting for all of the SocketServer Acceptors to be started
	at org.apache.kafka.server.util.FutureUtils.waitWithLogging(FutureUtils.java:73) ~[kafka-server-common-4.0.0.jar:?]
	at kafka.server.ControllerServer.startup(ControllerServer.scala:415) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$1(KafkaRaftServer.scala:95) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$1$adapted(KafkaRaftServer.scala:95) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.KafkaRaftServer.startup(KafkaRaftServer.scala:95) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka$.main(Kafka.scala:97) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka.main(Kafka.scala) [kafka_2.13-4.0.0.jar:?]
Caused by: java.lang.RuntimeException: Unable to start acceptor for ListenerName(CONTROLLER)
	at kafka.network.Acceptor.liftedTree1$1(SocketServer.scala:558) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.start(SocketServer.scala:538) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$2(SocketServer.scala:196) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:887) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2325) ~[?:?]
	at kafka.network.SocketServer.chainAcceptorFuture$1(SocketServer.scala:189) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$4(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.ConcurrentHashMap$ValuesView.forEach(ConcurrentHashMap.java:4780) ~[?:?]
	at kafka.network.SocketServer.enableRequestProcessing(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.ControllerServer.startup(ControllerServer.scala:390) ~[kafka_2.13-4.0.0.jar:?]
	... 6 more
Caused by: org.apache.kafka.common.KafkaException: Socket server failed to bind to 0.0.0.0:9093: Address already in use.
	at org.apache.kafka.server.ServerSocketFactory$KafkaServerSocketFactory.openServerSocket(ServerSocketFactory.java:56) ~[kafka-server-4.0.0.jar:?]
	at kafka.network.Acceptor.openServerSocket(SocketServer.scala:642) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.liftedTree1$1(SocketServer.scala:543) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.start(SocketServer.scala:538) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$2(SocketServer.scala:196) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:887) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2325) ~[?:?]
	at kafka.network.SocketServer.chainAcceptorFuture$1(SocketServer.scala:189) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$4(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.ConcurrentHashMap$ValuesView.forEach(ConcurrentHashMap.java:4780) ~[?:?]
	at kafka.network.SocketServer.enableRequestProcessing(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.ControllerServer.startup(ControllerServer.scala:390) ~[kafka_2.13-4.0.0.jar:?]
	... 6 more
Caused by: java.net.BindException: Address already in use
	at java.base/sun.nio.ch.Net.bind0(Native Method) ~[?:?]
	at java.base/sun.nio.ch.Net.bind(Net.java:555) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.netBind(ServerSocketChannelImpl.java:337) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:294) ~[?:?]
	at java.base/sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:89) ~[?:?]
	at org.apache.kafka.server.ServerSocketFactory$KafkaServerSocketFactory.openServerSocket(ServerSocketFactory.java:53) ~[kafka-server-4.0.0.jar:?]
	at kafka.network.Acceptor.openServerSocket(SocketServer.scala:642) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.liftedTree1$1(SocketServer.scala:543) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.Acceptor.start(SocketServer.scala:538) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$2(SocketServer.scala:196) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:887) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2325) ~[?:?]
	at kafka.network.SocketServer.chainAcceptorFuture$1(SocketServer.scala:189) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.network.SocketServer.$anonfun$enableRequestProcessing$4(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at java.base/java.util.concurrent.ConcurrentHashMap$ValuesView.forEach(ConcurrentHashMap.java:4780) ~[?:?]
	at kafka.network.SocketServer.enableRequestProcessing(SocketServer.scala:202) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.ControllerServer.startup(ControllerServer.scala:390) ~[kafka_2.13-4.0.0.jar:?]
	... 6 more
[2025-05-14 22:50:18,971] ERROR [BrokerLifecycleManager id=10] Shutting down because we were unable to register with the controller quorum. (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:50:18,972] INFO [BrokerLifecycleManager id=10] registrationTimeout: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-14 22:50:18,972] INFO [BrokerLifecycleManager id=10] Transitioning from STARTING to SHUTTING_DOWN. (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:50:18,973] INFO [broker-10-to-controller-heartbeat-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:18,973] INFO [broker-10-to-controller-heartbeat-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:18,973] INFO [broker-10-to-controller-heartbeat-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:18,973] ERROR [BrokerServer id=10] Received a fatal error while waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
java.util.concurrent.CancellationException: null
	at java.base/java.util.concurrent.CompletableFuture.cancel(CompletableFuture.java:2478) ~[?:?]
	at kafka.server.BrokerLifecycleManager$ShutdownEvent.run(BrokerLifecycleManager.scala:638) ~[kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventHandler.run(KafkaEventQueue.java:191) ~[kafka-server-common-4.0.0.jar:?]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[?:?]
[2025-05-14 22:50:18,978] INFO [BrokerServer id=10] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-14 22:50:18,982] ERROR [BrokerServer id=10] Fatal error during broker startup. Prepare to shutdown (kafka.server.BrokerServer)
java.lang.RuntimeException: Received a fatal error while waiting for the controller to acknowledge that we are caught up
	at org.apache.kafka.server.util.FutureUtils.waitWithLogging(FutureUtils.java:73) ~[kafka-server-common-4.0.0.jar:?]
	at kafka.server.BrokerServer.startup(BrokerServer.scala:564) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$2(KafkaRaftServer.scala:96) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$2$adapted(KafkaRaftServer.scala:96) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.KafkaRaftServer.startup(KafkaRaftServer.scala:96) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka$.main(Kafka.scala:97) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka.main(Kafka.scala) [kafka_2.13-4.0.0.jar:?]
Caused by: java.util.concurrent.CancellationException
	at java.base/java.util.concurrent.CompletableFuture.cancel(CompletableFuture.java:2478) ~[?:?]
	at kafka.server.BrokerLifecycleManager$ShutdownEvent.run(BrokerLifecycleManager.scala:638) ~[kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventHandler.run(KafkaEventQueue.java:191) ~[kafka-server-common-4.0.0.jar:?]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[?:?]
[2025-05-14 22:50:18,983] INFO [BrokerServer id=10] Transition from STARTED to SHUTTING_DOWN (kafka.server.BrokerServer)
[2025-05-14 22:50:18,983] INFO [BrokerServer id=10] shutting down (kafka.server.BrokerServer)
[2025-05-14 22:50:18,986] INFO [SocketServer listenerType=BROKER, nodeId=10] Stopping socket server request processors (kafka.network.SocketServer)
[2025-05-14 22:50:18,986] INFO Node to controller channel manager for heartbeat shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-14 22:50:19,000] INFO [SocketServer listenerType=BROKER, nodeId=10] Stopped socket server request processors (kafka.network.SocketServer)
[2025-05-14 22:50:19,003] INFO [data-plane Kafka Request Handler on Broker 10], shutting down (kafka.server.KafkaRequestHandlerPool)
[2025-05-14 22:50:19,005] INFO [data-plane Kafka Request Handler on Broker 10], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2025-05-14 22:50:19,006] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,007] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,007] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,010] INFO [KafkaApi-10] Shutdown complete. (kafka.server.KafkaApis)
[2025-05-14 22:50:19,018] INFO [TransactionCoordinator id=10] Shutting down. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-14 22:50:19,019] INFO [Transaction State Manager 10]: Shutdown complete (kafka.coordinator.transaction.TransactionStateManager)
[2025-05-14 22:50:19,019] INFO [TxnMarkerSenderThread-10]: Shutting down (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-14 22:50:19,020] INFO [TxnMarkerSenderThread-10]: Stopped (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-14 22:50:19,020] INFO [TxnMarkerSenderThread-10]: Shutdown completed (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-14 22:50:19,023] INFO [TransactionCoordinator id=10] Shutdown complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-14 22:50:19,024] INFO [GroupCoordinator id=10] Shutting down. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-14 22:50:19,024] INFO [GroupCoordinator id=10] Closing coordinator runtime. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-14 22:50:19,024] INFO [group-coordinator-reaper]: Shutting down (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,025] INFO [group-coordinator-reaper]: Stopped (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,025] INFO [group-coordinator-reaper]: Shutdown completed (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,026] INFO [GroupCoordinator id=10] Shutting down event processor. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor)
[2025-05-14 22:50:19,026] INFO [group-coordinator-event-processor-3]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,026] INFO [group-coordinator-event-processor-0]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,026] INFO [group-coordinator-event-processor-2]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,026] INFO [group-coordinator-event-processor-0]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,026] INFO [group-coordinator-event-processor-2]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,026] INFO [group-coordinator-event-processor-1]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,027] INFO [group-coordinator-event-processor-1]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,026] INFO [group-coordinator-event-processor-3]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:50:19,028] INFO [GroupCoordinator id=10] Event processor closed. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor)
[2025-05-14 22:50:19,032] INFO [GroupCoordinator id=10] Coordinator runtime closed. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-14 22:50:19,034] INFO [GroupCoordinator id=10] Shutdown complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-14 22:50:19,035] INFO [AssignmentsManager id=10]KafkaEventQueue#close: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-14 22:50:19,036] INFO [AssignmentsManager id=10] shutting down. (org.apache.kafka.server.AssignmentsManager)
[2025-05-14 22:50:19,038] INFO [broker-10-to-controller-directory-assignments-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,038] INFO [broker-10-to-controller-directory-assignments-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,039] INFO [broker-10-to-controller-directory-assignments-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,039] INFO Node to controller channel manager for directory-assignments shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-14 22:50:19,040] INFO [AssignmentsManager id=10]closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-14 22:50:19,041] INFO [ReplicaManager broker=10] Shutting down (kafka.server.ReplicaManager)
[2025-05-14 22:50:19,043] INFO [LogDirFailureHandler]: Shutting down (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-14 22:50:19,043] INFO [LogDirFailureHandler]: Shutdown completed (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-14 22:50:19,043] INFO [LogDirFailureHandler]: Stopped (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-14 22:50:19,044] INFO [ReplicaFetcherManager on broker 10] shutting down (kafka.server.ReplicaFetcherManager)
[2025-05-14 22:50:19,046] INFO [ReplicaFetcherManager on broker 10] shutdown completed (kafka.server.ReplicaFetcherManager)
[2025-05-14 22:50:19,047] INFO [ReplicaAlterLogDirsManager on broker 10] shutting down (kafka.server.ReplicaAlterLogDirsManager)
[2025-05-14 22:50:19,048] INFO [ReplicaAlterLogDirsManager on broker 10] shutdown completed (kafka.server.ReplicaAlterLogDirsManager)
[2025-05-14 22:50:19,049] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,049] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,049] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,050] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,051] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,051] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,052] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,053] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,053] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,054] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,055] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,055] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,056] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,056] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,056] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,057] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,058] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,058] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:50:19,060] INFO [AddPartitionsToTxnSenderThread-10]: Shutting down (kafka.server.AddPartitionsToTxnManager)
[2025-05-14 22:50:19,060] INFO [AddPartitionsToTxnSenderThread-10]: Stopped (kafka.server.AddPartitionsToTxnManager)
[2025-05-14 22:50:19,060] INFO [AddPartitionsToTxnSenderThread-10]: Shutdown completed (kafka.server.AddPartitionsToTxnManager)
[2025-05-14 22:50:19,061] INFO [ReplicaManager broker=10] Shut down completely (kafka.server.ReplicaManager)
[2025-05-14 22:50:19,062] INFO [broker-10-to-controller-alter-partition-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,062] INFO [broker-10-to-controller-alter-partition-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,062] INFO [broker-10-to-controller-alter-partition-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,063] INFO Node to controller channel manager for alter-partition shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-14 22:50:19,064] INFO [broker-10-to-controller-forwarding-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,064] INFO [broker-10-to-controller-forwarding-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,065] INFO [broker-10-to-controller-forwarding-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:50:19,065] INFO Node to controller channel manager for forwarding shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-14 22:50:19,067] INFO Shutting down. (kafka.log.LogManager)
[2025-05-14 22:50:19,069] INFO [kafka-log-cleaner-thread-0]: Shutting down (kafka.log.LogCleaner$CleanerThread)
[2025-05-14 22:50:19,069] INFO [kafka-log-cleaner-thread-0]: Shutdown completed (kafka.log.LogCleaner$CleanerThread)
[2025-05-14 22:50:19,069] INFO [kafka-log-cleaner-thread-0]: Stopped (kafka.log.LogCleaner$CleanerThread)
[2025-05-14 22:50:19,129] INFO Shutdown complete. (kafka.log.LogManager)
[2025-05-14 22:50:19,130] INFO [broker-10-ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,131] INFO [broker-10-ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,131] INFO [broker-10-ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,131] INFO [broker-10-ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,131] INFO [broker-10-ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,131] INFO [broker-10-ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,131] INFO [broker-10-ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,132] INFO [broker-10-ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,132] INFO [broker-10-ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,132] INFO [broker-10-ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,132] INFO [broker-10-ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,132] INFO [broker-10-ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:50:19,134] INFO [SocketServer listenerType=BROKER, nodeId=10] Shutting down socket server (kafka.network.SocketServer)
[2025-05-14 22:50:19,153] INFO [SocketServer listenerType=BROKER, nodeId=10] Shutdown completed (kafka.network.SocketServer)
[2025-05-14 22:50:19,156] INFO Broker and topic stats closed (org.apache.kafka.storage.log.metrics.BrokerTopicStats)
[2025-05-14 22:50:19,156] INFO [share-group-lock-timeout-reaper]: Shutting down (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,156] INFO [share-group-lock-timeout-reaper]: Shutdown completed (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,156] INFO [share-group-lock-timeout-reaper]: Stopped (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,160] INFO [BrokerLifecycleManager id=10] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-14 22:50:19,161] INFO [client-metrics-reaper]: Shutting down (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,161] INFO [client-metrics-reaper]: Stopped (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,161] INFO [client-metrics-reaper]: Shutdown completed (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:50:19,163] INFO [BrokerServer id=10] shut down completed (kafka.server.BrokerServer)
[2025-05-14 22:50:19,163] INFO [BrokerServer id=10] Transition from SHUTTING_DOWN to SHUTDOWN (kafka.server.BrokerServer)
[2025-05-14 22:50:19,164] ERROR Exiting Kafka due to fatal exception during startup. (kafka.Kafka$)
java.lang.RuntimeException: Received a fatal error while waiting for the controller to acknowledge that we are caught up
	at org.apache.kafka.server.util.FutureUtils.waitWithLogging(FutureUtils.java:73) ~[kafka-server-common-4.0.0.jar:?]
	at kafka.server.BrokerServer.startup(BrokerServer.scala:564) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$2(KafkaRaftServer.scala:96) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.KafkaRaftServer.$anonfun$startup$2$adapted(KafkaRaftServer.scala:96) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) ~[scala-library-2.13.15.jar:?]
	at kafka.server.KafkaRaftServer.startup(KafkaRaftServer.scala:96) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka$.main(Kafka.scala:97) [kafka_2.13-4.0.0.jar:?]
	at kafka.Kafka.main(Kafka.scala) [kafka_2.13-4.0.0.jar:?]
Caused by: java.util.concurrent.CancellationException
	at java.base/java.util.concurrent.CompletableFuture.cancel(CompletableFuture.java:2478) ~[?:?]
	at kafka.server.BrokerLifecycleManager$ShutdownEvent.run(BrokerLifecycleManager.scala:638) ~[kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventHandler.run(KafkaEventQueue.java:191) ~[kafka-server-common-4.0.0.jar:?]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[?:?]
[2025-05-14 22:50:19,171] INFO [ControllerServer id=10] shutting down (kafka.server.ControllerServer)
[2025-05-14 22:50:19,172] INFO [raft-expiration-reaper]: Shutting down (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-14 22:50:19,172] INFO [raft-expiration-reaper]: Stopped (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-14 22:50:19,173] INFO [raft-expiration-reaper]: Shutdown completed (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-14 22:50:19,174] INFO [kafka-10-raft-io-thread]: Shutting down (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-14 22:50:19,174] INFO [RaftManager id=10] Beginning graceful shutdown (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:50:32,172] INFO Terminating process due to signal SIGTERM (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-14 22:51:02,872] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-14 22:51:03,376] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-14 22:51:03,379] INFO [ControllerServer id=10] Starting controller (kafka.server.ControllerServer)
[2025-05-14 22:51:03,406] INFO [StandardAuthorizer 10] set super.users=User:ANONYMOUS,User:admin, default result=DENIED (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:51:03,467] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:51:03,469] ERROR [ControllerApis nodeId=10] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=11, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=10, incarnationId=iHXFDYkJRWqKYL6ODfXHEw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9093, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=10, correlationId=11, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44518-0-0', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@503d379e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=0, connectionId=127.0.0.1:9093-127.0.0.1:44518-0-0, session=org.apache.kafka.network.Session@9705ff5, listenerName=ListenerName(CONTROLLER), securityProtocol=PLAINTEXT, buffer=null, envelope=None) is not authorized.
[2025-05-14 22:51:03,470] INFO [ControllerRegistrationManager id=10 incarnation=iHXFDYkJRWqKYL6ODfXHEw] RegistrationResponseHandler: controller returned error CLUSTER_AUTHORIZATION_FAILED (Cluster authorization failed.) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:51:03,872] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-14 22:51:03,931] INFO [SocketServer listenerType=CONTROLLER, nodeId=10] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-14 22:51:03,944] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU. (org.apache.kafka.metadata.ListenerInfo)
[2025-05-14 22:51:03,954] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-14 22:51:03,957] INFO [SharedServer id=10] Starting SharedServer (kafka.server.SharedServer)
[2025-05-14 22:51:04,057] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Recovering unflushed segment 0. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-14 22:51:04,065] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:51:04,067] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:51:04,069] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker_4.0.0/__cluster_metadata-0/00000000000000000121.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-14 22:51:04,078] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Producer state recovery took 1ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:51:04,115] WARN Found invalid messages in log segment /home/ammar/kafka_data/broker_4.0.0/__cluster_metadata-0/00000000000000000000.log at byte offset 8564. (org.apache.kafka.storage.internals.log.LogSegment)
org.apache.kafka.common.errors.CorruptRecordException: Record is corrupt (stored crc = 125399841, computed crc = 3972186305)
[2025-05-14 22:51:04,129] ERROR Encountered fatal fault: Unexpected error in raft IO thread (org.apache.kafka.server.fault.ProcessTerminatingFaultHandler)
org.apache.kafka.common.errors.CorruptRecordException: Unexpected EOF while attempting to read the next batch
Caused by: java.io.EOFException: Failed to read `log header` from file channel `sun.nio.ch.FileChannelImpl@46ffa8a3`. Expected to read 17 bytes, but reached end of file after reading 0 bytes. Started read from position 8564.
	at org.apache.kafka.common.utils.Utils.readFullyOrFail(Utils.java:1233) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.common.record.FileLogInputStream.nextBatch(FileLogInputStream.java:69) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.common.record.FileLogInputStream.nextBatch(FileLogInputStream.java:42) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.common.record.RecordBatchIterator.makeNext(RecordBatchIterator.java:37) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.common.record.RecordBatchIterator.makeNext(RecordBatchIterator.java:26) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.common.utils.AbstractIterator.maybeComputeNext(AbstractIterator.java:79) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.common.utils.AbstractIterator.hasNext(AbstractIterator.java:45) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.common.record.FileRecords.searchForOffsetWithSize(FileRecords.java:317) ~[kafka-clients-4.0.0.jar:?]
	at org.apache.kafka.storage.internals.log.LogSegment.translateOffset(LogSegment.java:390) ~[kafka-storage-4.0.0.jar:?]
	at org.apache.kafka.storage.internals.log.LogSegment.translateOffset(LogSegment.java:371) ~[kafka-storage-4.0.0.jar:?]
	at org.apache.kafka.storage.internals.log.LogSegment.read(LogSegment.java:429) ~[kafka-storage-4.0.0.jar:?]
	at org.apache.kafka.storage.internals.log.LocalLog.lambda$read$12(LocalLog.java:507) ~[kafka-storage-4.0.0.jar:?]
	at org.apache.kafka.storage.internals.log.LocalLog.maybeHandleIOException(LocalLog.java:818) ~[kafka-storage-4.0.0.jar:?]
	at org.apache.kafka.storage.internals.log.LocalLog.maybeHandleIOException(LocalLog.java:192) ~[kafka-storage-4.0.0.jar:?]
	at org.apache.kafka.storage.internals.log.LocalLog.read(LocalLog.java:470) ~[kafka-storage-4.0.0.jar:?]
	at kafka.log.UnifiedLog.read(UnifiedLog.scala:1239) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.raft.KafkaMetadataLog.read(KafkaMetadataLog.scala:77) ~[kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.raft.internals.KRaftControlRecordStateMachine.maybeLoadLog(KRaftControlRecordStateMachine.java:234) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.internals.KRaftControlRecordStateMachine.updateState(KRaftControlRecordStateMachine.java:116) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.KafkaRaftClient.appendAsLeader(KafkaRaftClient.java:1830) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.KafkaRaftClient.appendBatch(KafkaRaftClient.java:2922) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.KafkaRaftClient.maybeAppendBatches(KafkaRaftClient.java:2957) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.KafkaRaftClient.pollLeader(KafkaRaftClient.java:3049) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.KafkaRaftClient.pollCurrentState(KafkaRaftClient.java:3299) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.KafkaRaftClient.poll(KafkaRaftClient.java:3447) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.KafkaRaftClientDriver.doWork(KafkaRaftClientDriver.java:64) [kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-14 22:51:04,147] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 121 with 0 producer ids in 13 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-14 22:51:04,152] WARN [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Corruption found in segment 0, truncating to offset 121 (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-14 22:51:04,175] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Loading producer state till offset 121 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:51:04,175] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 121 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:51:04,178] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=121, file=/home/ammar/kafka_data/broker_4.0.0/__cluster_metadata-0/00000000000000000121.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-14 22:51:04,182] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker_4.0.0] Producer state recovery took 6ms for snapshot load and 0ms for segment recovery from offset 121 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-14 22:51:04,237] INFO Initialized snapshots with IDs SortedSet() from /home/ammar/kafka_data/broker_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-14 22:51:04,262] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-14 22:51:04,294] INFO [RaftManager id=10] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:51:04,354] INFO [RaftManager id=10] Starting voters are VoterSet(voters={10=VoterNode(voterKey=ReplicaKey(id=10, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9193}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:51:04,356] INFO [RaftManager id=10] Starting request manager with static voters: [localhost:9193 (id: 10 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:51:04,393] INFO [RaftManager id=10] Attempting durable transition to ResignedState(localId=10, epoch=2, voters=[10], electionTimeoutMs=1509, unackedVoters=[], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:51:04,436] INFO [RaftManager id=10] Completed transition to ResignedState(localId=10, epoch=2, voters=[10], electionTimeoutMs=1509, unackedVoters=[], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:51:04,450] INFO [RaftManager id=10] Completed transition to ProspectiveState(epoch=2, leaderId=OptionalInt[10], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1730, highWatermark=Optional.empty) from ResignedState(localId=10, epoch=2, voters=[10], electionTimeoutMs=1509, unackedVoters=[], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:51:04,456] INFO [RaftManager id=10] Attempting durable transition to CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=3, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1815) from ProspectiveState(epoch=2, leaderId=OptionalInt[10], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1730, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:51:04,471] INFO [RaftManager id=10] Completed transition to CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=3, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1815) from ProspectiveState(epoch=2, leaderId=OptionalInt[10], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1730, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:51:04,479] INFO [RaftManager id=10] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=10, directoryId=Cco6adTtSDDCzLYisIcG7w), epoch=3, epochStartOffset=121, highWatermark=Optional.empty, voterStates={10=ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=3, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1815) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:51:04,491] INFO [RaftManager id=10] Completed transition to Leader(localReplicaKey=ReplicaKey(id=10, directoryId=Cco6adTtSDDCzLYisIcG7w), epoch=3, epochStartOffset=121, highWatermark=Optional.empty, voterStates={10=ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=10, localDirectoryId=Cco6adTtSDDCzLYisIcG7w, epoch=3, retries=1, epochElection=EpochElection(voterStates={10=VoterState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional.empty, electionTimeoutMs=1815) (org.apache.kafka.raft.QuorumState)
[2025-05-14 22:51:04,517] INFO [kafka-10-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-14 22:51:04,518] INFO [kafka-10-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-14 22:51:04,549] INFO [MetadataLoader id=10] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,552] INFO [ControllerServer id=10] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-14 22:51:04,553] INFO [ControllerServer id=10] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-14 22:51:04,556] INFO [RaftManager id=10] High watermark set to LogOffsetMetadata(offset=122, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=8655)]) for the first time for epoch 3 based on indexOfHw 0 and voters [ReplicaState(replicaKey=ReplicaKey(id=10, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=122, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=8655)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-14 22:51:04,575] INFO [RaftManager id=10] Registered the listener org.apache.kafka.image.loader.MetadataLoader@1611791700 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:51:04,578] INFO [RaftManager id=10] Setting the next offset of org.apache.kafka.image.loader.MetadataLoader@1611791700 to 0 since there are no snapshots (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:51:04,586] INFO [MetadataLoader id=10] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have loaded up to offset 0, but the high water mark is 122 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,603] INFO [MetadataLoader id=10] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 122 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,606] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,606] INFO [RaftManager id=10] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@1135253267 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:51:04,607] INFO [RaftManager id=10] Setting the next offset of org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@1135253267 to 0 since there are no snapshots (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-14 22:51:04,614] INFO [controller-10-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,615] INFO [controller-10-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,617] INFO [controller-10-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,619] INFO [controller-10-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,639] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:04,658] INFO [ControllerServer id=10] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-14 22:51:04,659] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,659] INFO [ControllerServer id=10] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-14 22:51:04,659] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,668] INFO [SocketServer listenerType=CONTROLLER, nodeId=10] Enabling request processing. (kafka.network.SocketServer)
[2025-05-14 22:51:04,672] INFO [ControllerServer id=10] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=121). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-14 22:51:04,673] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,673] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,674] INFO Awaiting socket connections on 0.0.0.0:9193. (kafka.network.DataPlaneAcceptor)
[2025-05-14 22:51:04,674] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,675] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,677] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,679] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ScramPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,683] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,686] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,686] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing AclPublisher controller id=10 with a snapshot at offset 121 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:04,689] INFO [AclPublisher controller id=10] Loading authorizer snapshot at offset 121 (kafka.server.metadata.AclPublisher)
[2025-05-14 22:51:04,691] INFO [StandardAuthorizer 10] Initialized with 0 acl(s). (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:51:04,692] INFO [StandardAuthorizer 10] Completed initial ACL load process. (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:51:04,698] INFO [controller-10-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,699] INFO [ControllerRegistrationManager id=10 incarnation=pkXxmSGOR-O3WaBRNPkwDA] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:51:04,700] INFO [ControllerServer id=10] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-14 22:51:04,701] INFO [ControllerServer id=10] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-14 22:51:04,701] INFO [controller-10-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9193 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,701] INFO [ControllerServer id=10] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-14 22:51:04,701] INFO [ControllerServer id=10] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-14 22:51:04,703] INFO [BrokerServer id=10] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-14 22:51:04,704] INFO [BrokerServer id=10] Starting broker (kafka.server.BrokerServer)
[2025-05-14 22:51:04,714] INFO [broker-10-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,715] INFO [broker-10-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,716] INFO [broker-10-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,716] INFO [broker-10-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-14 22:51:04,717] INFO [ControllerRegistrationManager id=10 incarnation=pkXxmSGOR-O3WaBRNPkwDA] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=10, incarnationId=pkXxmSGOR-O3WaBRNPkwDA, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.', port=9193, securityProtocol=0)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:51:04,740] INFO [BrokerServer id=10] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-14 22:51:04,740] INFO [BrokerServer id=10] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-14 22:51:04,743] INFO [broker-10-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,744] INFO [broker-10-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9193 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,755] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:51:04,801] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-14 22:51:04,812] INFO [SocketServer listenerType=BROKER, nodeId=10] Created data-plane acceptor and processors for endpoint : ListenerName(PLAINTEXT) (kafka.network.SocketServer)
[2025-05-14 22:51:04,814] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-14 22:51:04,839] INFO [ControllerRegistrationManager id=10 incarnation=pkXxmSGOR-O3WaBRNPkwDA] Our registration has been persisted to the metadata log. (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:51:04,843] INFO [ControllerRegistrationManager id=10 incarnation=pkXxmSGOR-O3WaBRNPkwDA] RegistrationResponseHandler: controller acknowledged ControllerRegistrationRequest. (kafka.server.ControllerRegistrationManager)
[2025-05-14 22:51:04,886] INFO Successfully logged in. (org.apache.kafka.common.security.authenticator.AbstractLogin)
[2025-05-14 22:51:04,892] INFO [SocketServer listenerType=BROKER, nodeId=10] Created data-plane acceptor and processors for endpoint : ListenerName(SASL_PLAINTEXT) (kafka.network.SocketServer)
[2025-05-14 22:51:04,899] INFO [broker-10-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,899] INFO [broker-10-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9193 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,909] INFO [broker-10-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,909] INFO [broker-10-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9193 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:04,923] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:04,924] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:04,925] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:04,926] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:04,927] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:04,928] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:04,947] INFO [BrokerServer id=10] Using no op persister (kafka.server.BrokerServer)
[2025-05-14 22:51:04,950] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:51:04,980] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:51:04,980] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:51:04,981] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:51:04,982] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-14 22:51:05,048] INFO [broker-10-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:05,048] INFO [StandardAuthorizer 10] set super.users=User:ANONYMOUS,User:admin, default result=DENIED (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:51:05,049] INFO [broker-10-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9193 (id: 10 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-14 22:51:05,051] INFO [BrokerLifecycleManager id=10] Incarnation OBrv820yTC6fTrgENx176Q of broker 10 in cluster 53umScLzTeajz4ICoMMl1A is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:51:05,069] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-14 22:51:05,090] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-14 22:51:05,103] INFO [BrokerLifecycleManager id=10] Successfully registered broker 10 with broker epoch 123 (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:51:05,117] INFO [BrokerLifecycleManager id=10] The broker has caught up. Transitioning from STARTING to RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:51:05,130] INFO [BrokerServer id=10] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-14 22:51:05,130] INFO [BrokerServer id=10] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-14 22:51:05,131] INFO [BrokerServer id=10] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-14 22:51:05,131] INFO [BrokerServer id=10] Finished waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-14 22:51:05,131] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing MetadataVersionPublisher(id=10) with a snapshot at offset 123 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:05,131] INFO [BrokerServer id=10] Waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-14 22:51:05,131] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 123 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:05,133] INFO [BrokerMetadataPublisher id=10] Publishing initial metadata at offset OffsetAndEpoch(offset=123, epoch=3) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-14 22:51:05,136] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker_4.0.0) (kafka.log.LogManager)
[2025-05-14 22:51:05,143] INFO No logs found to be loaded in /home/ammar/kafka_data/broker_4.0.0 (kafka.log.LogManager)
[2025-05-14 22:51:05,159] INFO [BrokerLifecycleManager id=10] The broker is in RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:51:05,173] INFO Loaded 0 logs in 30ms (kafka.log.LogManager)
[2025-05-14 22:51:05,174] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-14 22:51:05,176] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-14 22:51:05,216] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-14 22:51:05,222] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-14 22:51:05,223] INFO [AddPartitionsToTxnSenderThread-10]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-14 22:51:05,223] INFO [GroupCoordinator id=10] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-14 22:51:05,226] INFO [GroupCoordinator id=10] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-14 22:51:05,227] INFO [TransactionCoordinator id=10] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-14 22:51:05,230] INFO [TxnMarkerSenderThread-10]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-14 22:51:05,230] INFO [TransactionCoordinator id=10] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-14 22:51:05,238] INFO [AclPublisher broker id=10] Loading authorizer snapshot at offset 123 (kafka.server.metadata.AclPublisher)
[2025-05-14 22:51:05,238] INFO [StandardAuthorizer 10] Initialized with 0 acl(s). (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:51:05,239] INFO [StandardAuthorizer 10] Completed initial ACL load process. (org.apache.kafka.metadata.authorizer.StandardAuthorizerData)
[2025-05-14 22:51:05,241] INFO [MetadataLoader id=10] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=10) with a snapshot at offset 123 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-14 22:51:05,241] INFO [BrokerServer id=10] Finished waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-14 22:51:05,243] INFO KafkaConfig values: 
	add.partitions.to.txn.retry.backoff.max.ms = 100
	add.partitions.to.txn.retry.backoff.ms = 20
	advertised.listeners = PLAINTEXT://172.23.38.230:9192,SASL_PLAINTEXT://172.23.38.230:9194
	alter.config.policy.class.name = null
	alter.log.dirs.replication.quota.window.num = 11
	alter.log.dirs.replication.quota.window.size.seconds = 1
	authorizer.class.name = org.apache.kafka.metadata.authorizer.StandardAuthorizer
	auto.create.topics.enable = true
	auto.leader.rebalance.enable = true
	background.threads = 10
	broker.heartbeat.interval.ms = 2000
	broker.id = 10
	broker.rack = null
	broker.session.timeout.ms = 9000
	client.quota.callback.class = null
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = producer
	compression.zstd.level = 3
	connection.failed.authentication.delay.ms = 100
	connections.max.idle.ms = 600000
	connections.max.reauth.ms = 0
	controlled.shutdown.enable = true
	controller.listener.names = CONTROLLER
	controller.performance.always.log.threshold.ms = 2000
	controller.performance.sample.period.ms = 60000
	controller.quorum.append.linger.ms = 25
	controller.quorum.bootstrap.servers = []
	controller.quorum.election.backoff.max.ms = 1000
	controller.quorum.election.timeout.ms = 1000
	controller.quorum.fetch.timeout.ms = 2000
	controller.quorum.request.timeout.ms = 2000
	controller.quorum.retry.backoff.ms = 20
	controller.quorum.voters = [10@localhost:9193]
	controller.quota.window.num = 11
	controller.quota.window.size.seconds = 1
	controller.socket.timeout.ms = 30000
	create.topic.policy.class.name = null
	default.replication.factor = 1
	delegation.token.expiry.check.interval.ms = 3600000
	delegation.token.expiry.time.ms = 86400000
	delegation.token.max.lifetime.ms = 604800000
	delegation.token.secret.key = null
	delete.records.purgatory.purge.interval.requests = 1
	delete.topic.enable = true
	early.start.listeners = null
	fetch.max.bytes = 57671680
	fetch.purgatory.purge.interval.requests = 1000
	group.consumer.assignors = [uniform, range]
	group.consumer.heartbeat.interval.ms = 5000
	group.consumer.max.heartbeat.interval.ms = 15000
	group.consumer.max.session.timeout.ms = 60000
	group.consumer.max.size = 2147483647
	group.consumer.migration.policy = bidirectional
	group.consumer.min.heartbeat.interval.ms = 5000
	group.consumer.min.session.timeout.ms = 45000
	group.consumer.session.timeout.ms = 45000
	group.coordinator.append.linger.ms = 5
	group.coordinator.new.enable = true
	group.coordinator.rebalance.protocols = [classic, consumer]
	group.coordinator.threads = 4
	group.initial.rebalance.delay.ms = 3000
	group.max.session.timeout.ms = 1800000
	group.max.size = 2147483647
	group.min.session.timeout.ms = 6000
	group.share.delivery.count.limit = 5
	group.share.enable = false
	group.share.heartbeat.interval.ms = 5000
	group.share.max.groups = 10
	group.share.max.heartbeat.interval.ms = 15000
	group.share.max.record.lock.duration.ms = 60000
	group.share.max.session.timeout.ms = 60000
	group.share.max.size = 200
	group.share.min.heartbeat.interval.ms = 5000
	group.share.min.record.lock.duration.ms = 15000
	group.share.min.session.timeout.ms = 45000
	group.share.partition.max.record.locks = 200
	group.share.persister.class.name = org.apache.kafka.server.share.persister.DefaultStatePersister
	group.share.record.lock.duration.ms = 30000
	group.share.session.timeout.ms = 45000
	initial.broker.registration.timeout.ms = 60000
	inter.broker.listener.name = PLAINTEXT
	kafka.metrics.polling.interval.secs = 10
	kafka.metrics.reporters = []
	leader.imbalance.check.interval.seconds = 300
	listener.security.protocol.map = PLAINTEXT:PLAINTEXT,CONTROLLER:PLAINTEXT,SASL_PLAINTEXT:SASL_PLAINTEXT
	listeners = PLAINTEXT://0.0.0.0:9192,CONTROLLER://:9193,SASL_PLAINTEXT://0.0.0.0:9194
	log.cleaner.backoff.ms = 15000
	log.cleaner.dedupe.buffer.size = 134217728
	log.cleaner.delete.retention.ms = 86400000
	log.cleaner.enable = true
	log.cleaner.io.buffer.load.factor = 0.9
	log.cleaner.io.buffer.size = 524288
	log.cleaner.io.max.bytes.per.second = 1.7976931348623157E308
	log.cleaner.max.compaction.lag.ms = 9223372036854775807
	log.cleaner.min.cleanable.ratio = 0.5
	log.cleaner.min.compaction.lag.ms = 0
	log.cleaner.threads = 1
	log.cleanup.policy = [delete]
	log.dir = /tmp/kafka-logs
	log.dir.failure.timeout.ms = 30000
	log.dirs = /home/ammar/kafka_data/broker_4.0.0
	log.flush.interval.messages = 9223372036854775807
	log.flush.interval.ms = null
	log.flush.offset.checkpoint.interval.ms = 60000
	log.flush.scheduler.interval.ms = 9223372036854775807
	log.flush.start.offset.checkpoint.interval.ms = 60000
	log.index.interval.bytes = 4096
	log.index.size.max.bytes = 10485760
	log.initial.task.delay.ms = 30000
	log.local.retention.bytes = -2
	log.local.retention.ms = -2
	log.message.timestamp.after.max.ms = 3600000
	log.message.timestamp.before.max.ms = 9223372036854775807
	log.message.timestamp.type = CreateTime
	log.preallocate = false
	log.retention.bytes = -1
	log.retention.check.interval.ms = 300000
	log.retention.hours = 168
	log.retention.minutes = null
	log.retention.ms = null
	log.roll.hours = 168
	log.roll.jitter.hours = 0
	log.roll.jitter.ms = null
	log.roll.ms = null
	log.segment.bytes = 1073741824
	log.segment.delete.delay.ms = 60000
	max.connection.creation.rate = 2147483647
	max.connections = 2147483647
	max.connections.per.ip = 2147483647
	max.connections.per.ip.overrides = 
	max.incremental.fetch.session.cache.slots = 1000
	max.request.partition.size.limit = 2000
	message.max.bytes = 1048588
	metadata.log.dir = null
	metadata.log.max.record.bytes.between.snapshots = 20971520
	metadata.log.max.snapshot.interval.ms = 3600000
	metadata.log.segment.bytes = 1073741824
	metadata.log.segment.min.bytes = 8388608
	metadata.log.segment.ms = 604800000
	metadata.max.idle.interval.ms = 500
	metadata.max.retention.bytes = 104857600
	metadata.max.retention.ms = 604800000
	metric.reporters = [org.apache.kafka.common.metrics.JmxReporter]
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	min.insync.replicas = 1
	node.id = 10
	num.io.threads = 8
	num.network.threads = 3
	num.partitions = 1
	num.recovery.threads.per.data.dir = 1
	num.replica.alter.log.dirs.threads = null
	num.replica.fetchers = 1
	offset.metadata.max.bytes = 4096
	offsets.commit.timeout.ms = 5000
	offsets.load.buffer.size = 5242880
	offsets.retention.check.interval.ms = 600000
	offsets.retention.minutes = 10080
	offsets.topic.compression.codec = 0
	offsets.topic.num.partitions = 50
	offsets.topic.replication.factor = 1
	offsets.topic.segment.bytes = 104857600
	principal.builder.class = class org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder
	process.roles = [broker, controller]
	producer.id.expiration.check.interval.ms = 600000
	producer.id.expiration.ms = 86400000
	producer.purgatory.purge.interval.requests = 1000
	queued.max.request.bytes = -1
	queued.max.requests = 500
	quota.window.num = 11
	quota.window.size.seconds = 1
	remote.fetch.max.wait.ms = 500
	remote.list.offsets.request.timeout.ms = 30000
	remote.log.index.file.cache.total.size.bytes = 1073741824
	remote.log.manager.copier.thread.pool.size = 10
	remote.log.manager.copy.max.bytes.per.second = 9223372036854775807
	remote.log.manager.copy.quota.window.num = 11
	remote.log.manager.copy.quota.window.size.seconds = 1
	remote.log.manager.expiration.thread.pool.size = 10
	remote.log.manager.fetch.max.bytes.per.second = 9223372036854775807
	remote.log.manager.fetch.quota.window.num = 11
	remote.log.manager.fetch.quota.window.size.seconds = 1
	remote.log.manager.task.interval.ms = 30000
	remote.log.manager.task.retry.backoff.max.ms = 30000
	remote.log.manager.task.retry.backoff.ms = 500
	remote.log.manager.task.retry.jitter = 0.2
	remote.log.manager.thread.pool.size = 2
	remote.log.metadata.custom.metadata.max.bytes = 128
	remote.log.metadata.manager.class.name = org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager
	remote.log.metadata.manager.class.path = null
	remote.log.metadata.manager.impl.prefix = rlmm.config.
	remote.log.metadata.manager.listener.name = null
	remote.log.reader.max.pending.tasks = 100
	remote.log.reader.threads = 10
	remote.log.storage.manager.class.name = null
	remote.log.storage.manager.class.path = null
	remote.log.storage.manager.impl.prefix = rsm.config.
	remote.log.storage.system.enable = false
	replica.fetch.backoff.ms = 1000
	replica.fetch.max.bytes = 1048576
	replica.fetch.min.bytes = 1
	replica.fetch.response.max.bytes = 10485760
	replica.fetch.wait.max.ms = 500
	replica.high.watermark.checkpoint.interval.ms = 5000
	replica.lag.time.max.ms = 30000
	replica.selector.class = null
	replica.socket.receive.buffer.bytes = 65536
	replica.socket.timeout.ms = 30000
	replication.quota.window.num = 11
	replication.quota.window.size.seconds = 1
	request.timeout.ms = 30000
	sasl.client.callback.handler.class = null
	sasl.enabled.mechanisms = [PLAIN]
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.principal.to.local.rules = [DEFAULT]
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism.controller.protocol = GSSAPI
	sasl.mechanism.inter.broker.protocol = PLAIN
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	sasl.server.callback.handler.class = null
	sasl.server.max.receive.size = 524288
	security.inter.broker.protocol = PLAINTEXT
	security.providers = null
	server.max.startup.time.ms = 9223372036854775807
	share.coordinator.append.linger.ms = 10
	share.coordinator.load.buffer.size = 5242880
	share.coordinator.snapshot.update.records.per.snapshot = 500
	share.coordinator.state.topic.compression.codec = 0
	share.coordinator.state.topic.min.isr = 2
	share.coordinator.state.topic.num.partitions = 50
	share.coordinator.state.topic.prune.interval.ms = 300000
	share.coordinator.state.topic.replication.factor = 3
	share.coordinator.state.topic.segment.bytes = 104857600
	share.coordinator.threads = 1
	share.coordinator.write.timeout.ms = 5000
	share.fetch.max.fetch.records = 2147483647
	share.fetch.purgatory.purge.interval.requests = 1000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	socket.listen.backlog.size = 50
	socket.receive.buffer.bytes = 102400
	socket.request.max.bytes = 104857600
	socket.send.buffer.bytes = 102400
	ssl.allow.dn.changes = false
	ssl.allow.san.changes = false
	ssl.cipher.suites = []
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.principal.mapping.rules = DEFAULT
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	telemetry.max.bytes = 1048576
	transaction.abort.timed.out.transaction.cleanup.interval.ms = 10000
	transaction.max.timeout.ms = 900000
	transaction.partition.verification.enable = true
	transaction.remove.expired.transaction.cleanup.interval.ms = 3600000
	transaction.state.log.load.buffer.size = 5242880
	transaction.state.log.min.isr = 1
	transaction.state.log.num.partitions = 50
	transaction.state.log.replication.factor = 1
	transaction.state.log.segment.bytes = 104857600
	transactional.id.expiration.ms = 604800000
	unclean.leader.election.enable = false
	unclean.leader.election.interval.ms = 300000
	unstable.api.versions.enable = false
	unstable.feature.versions.enable = false
 (org.apache.kafka.common.config.AbstractConfig)
[2025-05-14 22:51:05,254] INFO [BrokerServer id=10] Waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-14 22:51:05,291] INFO [BrokerLifecycleManager id=10] The broker has been unfenced. Transitioning from RECOVERY to RUNNING. (kafka.server.BrokerLifecycleManager)
[2025-05-14 22:51:05,292] INFO [BrokerServer id=10] Finished waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-14 22:51:05,293] INFO authorizerStart completed for endpoint PLAINTEXT. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-14 22:51:05,293] INFO authorizerStart completed for endpoint SASL_PLAINTEXT. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-14 22:51:05,293] INFO [SocketServer listenerType=BROKER, nodeId=10] Enabling request processing. (kafka.network.SocketServer)
[2025-05-14 22:51:05,294] INFO Awaiting socket connections on 0.0.0.0:9192. (kafka.network.DataPlaneAcceptor)
[2025-05-14 22:51:05,295] INFO Awaiting socket connections on 0.0.0.0:9194. (kafka.network.DataPlaneAcceptor)
[2025-05-14 22:51:05,298] INFO [BrokerServer id=10] Waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-14 22:51:05,298] INFO [BrokerServer id=10] Finished waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-14 22:51:05,298] INFO [BrokerServer id=10] Waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-14 22:51:05,298] INFO [BrokerServer id=10] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-14 22:51:05,299] INFO [BrokerServer id=10] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-14 22:51:05,301] INFO Kafka version: 4.0.0 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-14 22:51:05,301] INFO Kafka commitId: 985bc99521dd22bb (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-14 22:51:05,302] INFO Kafka startTimeMs: 1747252265299 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-14 22:51:05,304] INFO [KafkaRaftServer nodeId=10] Kafka Server started (kafka.server.KafkaRaftServer)
[2025-05-14 22:55:36,172] ERROR [KafkaApi-10] Unexpected error handling request RequestHeader(apiKey=DESCRIBE_ACLS, apiVersion=2, clientId=adminclient-1, correlationId=3, headerVersion=2) -- DescribeAclsRequestData(resourceTypeFilter=2, resourceNameFilter='test-topic', patternTypeFilter=3, principalFilter=null, hostFilter=null, operation=1, permissionType=1) with context RequestContext(header=RequestHeader(apiKey=DESCRIBE_ACLS, apiVersion=2, clientId=adminclient-1, correlationId=3, headerVersion=2), connectionId='172.23.38.230:9194-172.23.38.230:59080-4-2', clientAddress=/172.23.38.230, principal=User:ammar-client, listenerName=ListenerName(SASL_PLAINTEXT), securityProtocol=SASL_PLAINTEXT, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=3.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@79993988]) (kafka.server.KafkaApis)
org.apache.kafka.common.errors.ClusterAuthorizationException: Request Request(processor=4, connectionId=172.23.38.230:9194-172.23.38.230:59080-4-2, session=org.apache.kafka.network.Session@33035443, listenerName=ListenerName(SASL_PLAINTEXT), securityProtocol=SASL_PLAINTEXT, buffer=null, envelope=None) is not authorized.
