[2025-05-29 17:00:38,528] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:00:38,548] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=481, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1494, highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=481, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:00:38,564] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:38,564] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:38,567] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=482, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)], electionTimeoutMs=1661) from ProspectiveState(epoch=481, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1494, highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:00:38,585] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=482, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)], electionTimeoutMs=1661) from ProspectiveState(epoch=481, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1494, highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:00:38,632] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=482, epochStartOffset=78142, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=482, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)], electionTimeoutMs=1661) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:00:38,645] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=482, epochStartOffset=78142, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=482, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78141, metadata=Optional.empty)], electionTimeoutMs=1661) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:00:38,813] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=78143, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2592350)]) for the first time for epoch 482 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78143, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2592350)])], lastFetchTimestamp=1748527238812, lastCaughtUpTimestamp=1748527238812, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78143, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2592350)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:00:39,161] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:39,163] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:00:39,672] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:39,672] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:40,673] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:40,673] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:41,673] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:41,674] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:42,674] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:42,674] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:43,674] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:43,674] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:44,674] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:44,674] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:45,676] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:45,677] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:46,675] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:46,675] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:47,676] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:47,676] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:48,677] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:48,679] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:49,676] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:49,677] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:50,676] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:50,677] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:51,677] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:51,677] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:52,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:52,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:53,677] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:53,677] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:54,677] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:54,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:55,676] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:55,677] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:56,676] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:56,676] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:57,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:57,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:58,677] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:58,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:59,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:00:59,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:00,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:00,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:01,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:01,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:02,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:02,679] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:03,679] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:03,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:04,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:04,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:05,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:05,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:06,679] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:06,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:07,679] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:07,679] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:08,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:08,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:09,679] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:09,679] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:10,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:10,679] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:11,678] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:11,678] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:12,679] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:12,679] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:13,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:13,681] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:14,681] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:14,681] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:15,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:15,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:16,679] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:16,679] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:17,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:17,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:18,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:18,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:19,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:19,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:20,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:20,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:21,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:21,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:22,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:22,680] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:23,681] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:23,681] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:24,681] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:24,681] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:25,680] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:25,681] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:29,490] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:01:29,492] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 78323 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:01:29,495] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=482, voters=[1, 2, 3], electionTimeoutMs=1278, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=482, epochStartOffset=78142, highWatermark=Optional[LogOffsetMetadata(offset=78323, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2605264)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78323, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2605264)])], lastFetchTimestamp=1748527286347, lastCaughtUpTimestamp=1748527285863, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78323, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2605264)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:01:29,497] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:29,498] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:29,498] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=482, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=482, lastOffset=78323, preVote=true)])]) with epoch 482 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:01:29,518] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1252, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=482, voters=[1, 2, 3], electionTimeoutMs=1278, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:01:29,533] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1252, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=482, voters=[1, 2, 3], electionTimeoutMs=1278, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:01:29,534] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1112, highWatermark=Optional.empty) from UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1252, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:01:29,548] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1112, highWatermark=Optional.empty) from UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1252, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:01:29,548] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=483, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=482, lastOffset=78323, preVote=false)])]) with epoch 483 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:01:29,602] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=483, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1112, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:01:29,626] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=483, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=483, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1112, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:01:30,016] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=94, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78322, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=94, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:37562-0-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@59ffee59]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:01:30,017] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:01:30,019] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:01:30,149] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=78324, metadata=Optional.empty)] for the first time for epoch 483 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:01:31,359] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=156, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78326, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=156, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:37566-1-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@79543a27]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:02:02,076] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:02,076] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=483, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1783, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=483, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:02,078] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:02,079] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:02,597] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:02,597] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:02,824] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:02,826] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:02,877] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,011] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,012] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,063] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,131] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,131] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,164] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,165] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,218] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,357] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,358] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,409] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,536] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,541] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,591] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,631] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=484, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=228, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from ProspectiveState(epoch=483, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1783, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:03,644] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,662] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,714] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:03,760] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=484, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=228, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from ProspectiveState(epoch=483, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1783, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:03,760] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=484, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=483, lastOffset=78384, preVote=true)])]) with epoch 484 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:03,847] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,860] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=484, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1042, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from UnattachedState(epoch=484, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=228, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:03,862] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,862] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:03,908] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=995, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from ProspectiveState(epoch=484, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1042, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:04,103] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=995, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from ProspectiveState(epoch=484, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1042, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:04,109] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1687, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=995, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:04,214] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1687, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) from UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=995, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:04,214] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=485, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=483, lastOffset=78384, preVote=false)])]) with epoch 485 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:04,423] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=485, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1687, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:04,469] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=485, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=485, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1687, highWatermark=Optional[LogOffsetMetadata(offset=78383, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:04,475] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:04,557] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:04,569] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:04,630] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:34,439] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-29 17:02:35,389] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:02:35,401] INFO [ControllerServer id=1] Starting controller (kafka.server.ControllerServer)
[2025-05-29 17:02:36,422] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:02:37,226] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-29 17:02:37,239] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU.localdomain (org.apache.kafka.metadata.ListenerInfo)
[2025-05-29 17:02:37,250] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:02:37,253] INFO [SharedServer id=1] Starting SharedServer (kafka.server.SharedServer)
[2025-05-29 17:02:37,349] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 41651. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:02:37,353] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:37,355] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:37,356] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000077543.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:02:37,356] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000077789.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:02:37,372] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 41651 with 0 producer ids in 15 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:02:37,379] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 2ms for snapshot load and 16ms for segment recovery from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:37,861] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 77789 with 0 producer ids in 11 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:02:37,872] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 77789 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:37,873] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 77789 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:37,873] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000041651.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:02:37,878] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=77789, file=/home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000077789.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:02:37,882] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 8ms for snapshot load and 0ms for segment recovery from offset 77789 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:37,955] INFO Initialized snapshots with IDs SortedSet(OffsetAndEpoch(offset=51468, epoch=142), OffsetAndEpoch(offset=58580, epoch=234), OffsetAndEpoch(offset=65880, epoch=286)) from /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-29 17:02:38,084] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:02:38,123] INFO [RaftManager id=1] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:38,128] INFO [RaftManager id=1] Loading snapshot (OffsetAndEpoch(offset=65880, epoch=286)) since log start offset (41651) is greater than the internal listener's next offset (-1) (org.apache.kafka.raft.internals.KRaftControlRecordStateMachine)
[2025-05-29 17:02:38,310] INFO [RaftManager id=1] Starting voters are VoterSet(voters={1=VoterNode(voterKey=ReplicaKey(id=1, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 2=VoterNode(voterKey=ReplicaKey(id=2, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 3=VoterNode(voterKey=ReplicaKey(id=3, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:38,323] INFO [RaftManager id=1] Starting request manager with static voters: [localhost:9093 (id: 1 rack: null isFenced: false), localhost:9096 (id: 2 rack: null isFenced: false), localhost:9099 (id: 3 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:38,374] INFO [RaftManager id=1] Attempting durable transition to ResignedState(localId=1, epoch=476, voters=[1, 2, 3], electionTimeoutMs=1301, unackedVoters=[2, 3], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:38,525] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=476, voters=[1, 2, 3], electionTimeoutMs=1301, unackedVoters=[2, 3], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:38,538] INFO [kafka-1-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:02:38,545] INFO [kafka-1-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:02:38,580] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:38,582] INFO [RaftManager id=1] Registered the listener org.apache.kafka.image.loader.MetadataLoader@1711956623 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:38,584] INFO [ControllerServer id=1] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:02:38,584] INFO [ControllerServer id=1] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:02:38,673] INFO [RaftManager id=1] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@375091600 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:38,683] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:38,690] INFO [controller-1-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:38,694] INFO [controller-1-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:38,698] INFO [controller-1-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:38,708] INFO [controller-1-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:38,741] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:38,795] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:38,825] INFO [ControllerServer id=1] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:02:38,825] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:38,825] INFO [ControllerServer id=1] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:02:38,826] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:02:38,834] INFO Awaiting socket connections on 0.0.0.0:9093. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:02:38,926] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,026] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,127] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,195] INFO [ControllerRegistrationManager id=1 incarnation=1rbNDVl3RiWZXr2z9cszsw] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:02:39,196] INFO [controller-1-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:39,196] INFO [ControllerRegistrationManager id=1 incarnation=1rbNDVl3RiWZXr2z9cszsw] maybeSendControllerRegistration: cannot register yet because the metadata.version is not known yet. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:02:39,198] INFO [controller-1-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:39,197] INFO [ControllerServer id=1] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:02:39,199] INFO [ControllerServer id=1] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:02:39,199] INFO [ControllerServer id=1] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:02:39,199] INFO [ControllerServer id=1] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:02:39,201] INFO [BrokerServer id=1] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-29 17:02:39,203] INFO [BrokerServer id=1] Starting broker (kafka.server.BrokerServer)
[2025-05-29 17:02:39,219] INFO [broker-1-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:39,220] INFO [broker-1-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:39,221] INFO [broker-1-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:39,222] INFO [broker-1-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:02:39,229] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,264] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=485, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ResignedState(localId=1, epoch=476, voters=[1, 2, 3], electionTimeoutMs=1301, unackedVoters=[2, 3], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:39,271] INFO [BrokerServer id=1] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:02:39,271] INFO [BrokerServer id=1] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:02:39,280] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=485, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ResignedState(localId=1, epoch=476, voters=[1, 2, 3], electionTimeoutMs=1301, unackedVoters=[2, 3], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:02:39,296] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to offset 77788 (kafka.log.UnifiedLog)
[2025-05-29 17:02:39,299] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 77788 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:39,300] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 77788 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:39,300] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000077789.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:02:39,330] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,347] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 77788 with 0 producer ids in 46 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:02:39,350] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 50ms for segment recovery from offset 77788 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:39,350] INFO [RaftManager id=1] Truncated to offset 77788 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:02:39,370] INFO [broker-1-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:39,371] INFO [broker-1-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:39,396] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:02:39,439] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,499] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:02:39,539] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,656] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,727] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=78452, metadata=Optional.empty)] for the first time for epoch 485 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:02:39,733] INFO [MetadataLoader id=1] handleLoadSnapshot(00000000000000065880-0000000286): incrementing HandleLoadSnapshotCount to 1. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,766] INFO [MetadataLoader id=1] handleLoadSnapshot(00000000000000065880-0000000286): generated a metadata delta between offset -1 and this snapshot in 29670 us. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,771] INFO [MetadataLoader id=1] maybePublishMetadata(SNAPSHOT): The loader is still catching up because we have loaded up to offset 65879, but the high water mark is 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:39,771] INFO [MetadataLoader id=1] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 65879, but the high water mark is 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,029] INFO [SocketServer listenerType=BROKER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(SSL) (kafka.network.SocketServer)
[2025-05-29 17:02:40,065] INFO [MetadataLoader id=1] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have loaded up to offset 78451, but the high water mark is 78453 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,070] INFO [MetadataLoader id=1] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 78451, but the high water mark is 78453 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,077] INFO [MetadataLoader id=1] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 78453 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,083] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,086] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,087] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,097] INFO [ControllerServer id=1] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=78452). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-29 17:02:40,097] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,098] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,099] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=1 with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,104] INFO [ControllerRegistrationManager id=1 incarnation=1rbNDVl3RiWZXr2z9cszsw] Found registration for XhqZD4qvRwqIUJIdePTqkg instead of our incarnation. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:02:40,108] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=1 with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,116] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=1 with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,117] INFO [ControllerRegistrationManager id=1 incarnation=1rbNDVl3RiWZXr2z9cszsw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=1, incarnationId=1rbNDVl3RiWZXr2z9cszsw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.localdomain', port=9093, securityProtocol=1)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:02:40,117] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ScramPublisher controller id=1 with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,120] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=1 with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,123] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,135] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing AclPublisher controller id=1 with a snapshot at offset 78452 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:40,181] INFO [broker-1-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:40,182] INFO [broker-1-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:40,397] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=1, correlationId=0, headerVersion=2) -- ControllerRegistrationRequestData(controllerId=1, incarnationId=1rbNDVl3RiWZXr2z9cszsw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.localdomain', port=9093, securityProtocol=1)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) with context RequestContext(header=RequestHeader(apiKey=CONTROLLER_REGISTRATION, apiVersion=0, clientId=1, correlationId=0, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:46326-1-0', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5436f45e]) (kafka.server.ControllerApis)
java.util.concurrent.CompletionException: org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) [?:?]
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) [?:?]
	at org.apache.kafka.controller.QuorumController$ControllerWriteEvent.complete(QuorumController.java:871) [kafka-metadata-4.0.0.jar:?]
	at org.apache.kafka.controller.QuorumController$ControllerWriteEvent.handleException(QuorumController.java:862) [kafka-metadata-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventContext.completeWithException(KafkaEventQueue.java:153) [kafka-server-common-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventContext.run(KafkaEventQueue.java:142) [kafka-server-common-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventHandler.handleEvents(KafkaEventQueue.java:215) [kafka-server-common-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventHandler.run(KafkaEventQueue.java:186) [kafka-server-common-4.0.0.jar:?]
	at java.base/java.lang.Thread.run(Thread.java:840) [?:?]
Caused by: org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:02:40,441] INFO [NodeToControllerChannelManager id=1 name=registration] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:02:40,444] INFO [controller-1-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:40,450] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:40,451] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:40,649] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:40,653] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:40,666] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:40,669] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:40,672] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:40,670] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:40,757] INFO [BrokerServer id=1] Using no op persister (kafka.server.BrokerServer)
[2025-05-29 17:02:40,762] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:02:40,788] INFO [ControllerRegistrationManager id=1 incarnation=1rbNDVl3RiWZXr2z9cszsw] RegistrationResponseHandler: controller acknowledged ControllerRegistrationRequest. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:02:40,877] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:02:40,878] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:02:40,881] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:02:40,882] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:02:40,903] INFO [ControllerRegistrationManager id=1 incarnation=1rbNDVl3RiWZXr2z9cszsw] Our registration has been persisted to the metadata log. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:02:41,145] INFO [broker-1-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:41,146] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:02:41,151] INFO [BrokerLifecycleManager id=1] Incarnation 4oMHGaDpSqCaJjl9cFGkPQ of broker 1 in cluster vN8K3C85SQS4roeM5v3xFg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:02:41,180] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:02:41,223] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:02:41,278] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing MetadataVersionPublisher(id=1) with a snapshot at offset 78455 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:41,286] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 78455 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:41,275] INFO [BrokerServer id=1] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:02:41,287] INFO [BrokerServer id=1] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:02:41,287] INFO [BrokerServer id=1] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:02:41,288] INFO [BrokerMetadataPublisher id=1] Publishing initial metadata at offset OffsetAndEpoch(offset=78455, epoch=485) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-29 17:02:41,292] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,304] INFO Skipping recovery of 57 logs from /home/ammar/kafka_data/broker1_4.0.0 since clean shutdown file was found (kafka.log.LogManager)
[2025-05-29 17:02:41,326] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,362] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-20, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=20, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 26ms (1/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,378] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,383] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-0, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 20ms (2/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,402] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,404] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-8, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=8, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 19ms (3/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,422] INFO [BrokerLifecycleManager id=1] Successfully registered broker 1 with broker epoch 78457 (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:02:41,429] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,434] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-30, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=30, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 29ms (4/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,456] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,459] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-19, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=19, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 25ms (5/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,475] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,478] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-47, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=47, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 17ms (6/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,494] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,498] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-27, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=27, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 19ms (7/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,506] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,508] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-28, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=28, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (8/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,515] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,521] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-1, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (9/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,561] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,563] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-2, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 39ms (10/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,571] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,572] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-9, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=9, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (11/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,576] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,587] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-2, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 13ms (12/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,632] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,635] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-33, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=33, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 48ms (13/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,645] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,647] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-6, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=6, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 10ms (14/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,653] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,656] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-0, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (15/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,661] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,664] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-18, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=18, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (16/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,674] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,675] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-16, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=16, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 10ms (17/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,679] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,681] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-49, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=49, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (18/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,689] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,691] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-29, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=29, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (19/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,696] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,698] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-23, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=23, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (20/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,713] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,713] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,714] INFO [ProducerStateManager partition=__consumer_offsets-42] Loading producer state from snapshot file 'SnapshotFile(offset=7, file=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42/00000000000000000007.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:02:41,714] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,716] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=42, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=7) with 2 segments, local-log-start-offset 0 and log-end-offset 7 in 18ms (21/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,745] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,752] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-36, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=36, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 35ms (22/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,778] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,779] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-17, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=17, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 27ms (23/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,783] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,786] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-5, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=5, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (24/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,797] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,799] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-45, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=45, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (25/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,856] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,859] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-12, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=12, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 34ms (26/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,867] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,874] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-37, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=37, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 14ms (27/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,879] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,888] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-26, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=26, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 14ms (28/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,896] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,898] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-44, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=44, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (29/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,906] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,910] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-32, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=32, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 11ms (30/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,915] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,923] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-21, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=21, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (31/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,927] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,929] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-24, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=24, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (32/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,972] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:41,974] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-38, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=38, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 45ms (33/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:41,999] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,005] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-14, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=14, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 30ms (34/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,010] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,013] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-41, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=41, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (35/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,021] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,026] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-1, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 13ms (36/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,030] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,033] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-34, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=34, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (37/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,037] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,039] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-11, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=11, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (38/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,043] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,046] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-48, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=48, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (39/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,056] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,061] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-25, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=25, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 13ms (40/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,070] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,072] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-43, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=43, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 10ms (41/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,077] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,080] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-10, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=10, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (42/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,090] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,092] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-31, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=31, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (43/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,097] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,126] INFO [ProducerStateManager partition=test-topic-0] Wrote producer snapshot at offset 1 with 0 producer ids in 28 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:02:42,129] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/test-topic-0, topicId=5IOimlizQSmAmZHYHObOxA, topic=test-topic, partition=0, highWatermark=1, lastStableOffset=1, logStartOffset=1, logEndOffset=1) with 1 segments, local-log-start-offset 1 and log-end-offset 1 in 36ms (44/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,134] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,139] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-15, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=15, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (45/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,145] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,147] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-13, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=13, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (46/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,158] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,174] INFO [ProducerStateManager partition=ssl-test-topic-2] Wrote producer snapshot at offset 2 with 0 producer ids in 15 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:02:42,176] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-2, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=2, highWatermark=2, lastStableOffset=2, logStartOffset=2, logEndOffset=2) with 1 segments, local-log-start-offset 2 and log-end-offset 2 in 29ms (47/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,180] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,182] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-22, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=22, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (48/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,188] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,190] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-0, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (49/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,194] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,195] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-4, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=4, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (50/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,199] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,201] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-46, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=46, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (51/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,210] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,214] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-40, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=40, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 10ms (52/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,219] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,222] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-3, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=3, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (53/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,229] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,231] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-35, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=35, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (54/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,236] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,239] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-39, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=39, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (55/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,244] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,247] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-1, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (56/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,253] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:02:42,255] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-7, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=7, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (57/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:02:42,265] INFO Loaded 57 logs in 966ms (kafka.log.LogManager)
[2025-05-29 17:02:42,267] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-29 17:02:42,270] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-29 17:02:42,631] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:02:42,638] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:02:42,639] INFO [AddPartitionsToTxnSenderThread-1]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:02:42,639] INFO [GroupCoordinator id=1] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:02:42,644] INFO [GroupCoordinator id=1] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:02:42,653] INFO [TransactionCoordinator id=1] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:02:42,656] INFO [TransactionCoordinator id=1] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:02:42,659] INFO [TxnMarkerSenderThread-1]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:02:42,722] INFO [Partition __consumer_offsets-13 broker=1] Log loaded for partition __consumer_offsets-13 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,737] INFO [Partition __consumer_offsets-46 broker=1] Log loaded for partition __consumer_offsets-46 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,739] INFO [Partition __consumer_offsets-9 broker=1] Log loaded for partition __consumer_offsets-9 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,742] INFO [Partition __consumer_offsets-42 broker=1] Log loaded for partition __consumer_offsets-42 with initial high watermark 7 (kafka.cluster.Partition)
[2025-05-29 17:02:42,744] INFO [Partition __consumer_offsets-21 broker=1] Log loaded for partition __consumer_offsets-21 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,746] INFO [Partition __consumer_offsets-17 broker=1] Log loaded for partition __consumer_offsets-17 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,748] INFO [Partition ssl-test-topic-0 broker=1] Log loaded for partition ssl-test-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,754] INFO [Partition __consumer_offsets-30 broker=1] Log loaded for partition __consumer_offsets-30 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,756] INFO [Partition __consumer_offsets-26 broker=1] Log loaded for partition __consumer_offsets-26 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,759] INFO [Partition __consumer_offsets-5 broker=1] Log loaded for partition __consumer_offsets-5 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,761] INFO [Partition __consumer_offsets-38 broker=1] Log loaded for partition __consumer_offsets-38 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,763] INFO [Partition my-topic-0 broker=1] Log loaded for partition my-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,766] INFO [Partition __consumer_offsets-1 broker=1] Log loaded for partition __consumer_offsets-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,772] INFO [Partition __consumer_offsets-34 broker=1] Log loaded for partition __consumer_offsets-34 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,775] INFO [Partition __consumer_offsets-16 broker=1] Log loaded for partition __consumer_offsets-16 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,783] INFO [Partition __consumer_offsets-45 broker=1] Log loaded for partition __consumer_offsets-45 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,788] INFO [Partition __consumer_offsets-12 broker=1] Log loaded for partition __consumer_offsets-12 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,790] INFO [Partition __consumer_offsets-41 broker=1] Log loaded for partition __consumer_offsets-41 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,792] INFO [Partition __consumer_offsets-24 broker=1] Log loaded for partition __consumer_offsets-24 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,794] INFO [Partition __consumer_offsets-20 broker=1] Log loaded for partition __consumer_offsets-20 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,796] INFO [Partition __consumer_offsets-49 broker=1] Log loaded for partition __consumer_offsets-49 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,803] INFO [Partition __consumer_offsets-0 broker=1] Log loaded for partition __consumer_offsets-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,805] INFO [Partition ssl-test-topic-1 broker=1] Log loaded for partition ssl-test-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,807] INFO [Partition __consumer_offsets-29 broker=1] Log loaded for partition __consumer_offsets-29 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,809] INFO [Partition __consumer_offsets-25 broker=1] Log loaded for partition __consumer_offsets-25 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,811] INFO [Partition __consumer_offsets-8 broker=1] Log loaded for partition __consumer_offsets-8 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,814] INFO [Partition __consumer_offsets-37 broker=1] Log loaded for partition __consumer_offsets-37 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,816] INFO [Partition my-topic-1 broker=1] Log loaded for partition my-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,818] INFO [Partition __consumer_offsets-4 broker=1] Log loaded for partition __consumer_offsets-4 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,820] INFO [Partition __consumer_offsets-33 broker=1] Log loaded for partition __consumer_offsets-33 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,822] INFO [Partition __consumer_offsets-15 broker=1] Log loaded for partition __consumer_offsets-15 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,824] INFO [Partition __consumer_offsets-48 broker=1] Log loaded for partition __consumer_offsets-48 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,826] INFO [Partition __consumer_offsets-11 broker=1] Log loaded for partition __consumer_offsets-11 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,828] INFO [Partition __consumer_offsets-44 broker=1] Log loaded for partition __consumer_offsets-44 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,830] INFO [Partition __consumer_offsets-23 broker=1] Log loaded for partition __consumer_offsets-23 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,832] INFO [Partition __consumer_offsets-19 broker=1] Log loaded for partition __consumer_offsets-19 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,833] INFO [Partition ssl-test-topic-2 broker=1] Log loaded for partition ssl-test-topic-2 with initial high watermark 2 (kafka.cluster.Partition)
[2025-05-29 17:02:42,839] INFO [Partition __consumer_offsets-32 broker=1] Log loaded for partition __consumer_offsets-32 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,840] INFO [Partition test-topic-0 broker=1] Log loaded for partition test-topic-0 with initial high watermark 1 (kafka.cluster.Partition)
[2025-05-29 17:02:42,842] INFO [Partition __consumer_offsets-28 broker=1] Log loaded for partition __consumer_offsets-28 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,844] INFO [Partition __consumer_offsets-7 broker=1] Log loaded for partition __consumer_offsets-7 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,845] INFO [Partition __consumer_offsets-40 broker=1] Log loaded for partition __consumer_offsets-40 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,847] INFO [Partition __consumer_offsets-3 broker=1] Log loaded for partition __consumer_offsets-3 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,848] INFO [Partition __consumer_offsets-36 broker=1] Log loaded for partition __consumer_offsets-36 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,852] INFO [Partition my-topic-2 broker=1] Log loaded for partition my-topic-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,859] INFO [Partition __consumer_offsets-47 broker=1] Log loaded for partition __consumer_offsets-47 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,862] INFO [Partition __consumer_offsets-14 broker=1] Log loaded for partition __consumer_offsets-14 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,865] INFO [Partition __consumer_offsets-43 broker=1] Log loaded for partition __consumer_offsets-43 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,867] INFO [Partition __consumer_offsets-10 broker=1] Log loaded for partition __consumer_offsets-10 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,877] INFO [Partition __consumer_offsets-22 broker=1] Log loaded for partition __consumer_offsets-22 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,880] INFO [Partition __consumer_offsets-18 broker=1] Log loaded for partition __consumer_offsets-18 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,882] INFO [Partition __consumer_offsets-31 broker=1] Log loaded for partition __consumer_offsets-31 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,886] INFO [Partition __consumer_offsets-27 broker=1] Log loaded for partition __consumer_offsets-27 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,887] INFO [Partition __consumer_offsets-39 broker=1] Log loaded for partition __consumer_offsets-39 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,889] INFO [Partition __consumer_offsets-6 broker=1] Log loaded for partition __consumer_offsets-6 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,891] INFO [Partition __consumer_offsets-35 broker=1] Log loaded for partition __consumer_offsets-35 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,894] INFO [Partition __consumer_offsets-2 broker=1] Log loaded for partition __consumer_offsets-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:02:42,897] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(__consumer_offsets-13, __consumer_offsets-46, __consumer_offsets-9, __consumer_offsets-42, __consumer_offsets-21, __consumer_offsets-17, ssl-test-topic-0, __consumer_offsets-30, __consumer_offsets-26, __consumer_offsets-5, __consumer_offsets-38, my-topic-0, __consumer_offsets-1, __consumer_offsets-34, __consumer_offsets-16, __consumer_offsets-45, __consumer_offsets-12, __consumer_offsets-41, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-49, __consumer_offsets-0, ssl-test-topic-1, __consumer_offsets-29, __consumer_offsets-25, __consumer_offsets-8, __consumer_offsets-37, my-topic-1, __consumer_offsets-4, __consumer_offsets-33, __consumer_offsets-15, __consumer_offsets-48, __consumer_offsets-11, __consumer_offsets-44, __consumer_offsets-23, __consumer_offsets-19, ssl-test-topic-2, __consumer_offsets-32, test-topic-0, __consumer_offsets-28, __consumer_offsets-7, __consumer_offsets-40, __consumer_offsets-3, __consumer_offsets-36, my-topic-2, __consumer_offsets-47, __consumer_offsets-14, __consumer_offsets-43, __consumer_offsets-10, __consumer_offsets-22, __consumer_offsets-18, __consumer_offsets-31, __consumer_offsets-27, __consumer_offsets-39, __consumer_offsets-6, __consumer_offsets-35, __consumer_offsets-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:02:43,061] INFO [ReplicaFetcherManager on broker 1] Added fetcher to broker 2 for partitions HashMap(my-topic-0 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),19,0), my-topic-1 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),17,0), my-topic-2 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),18,0)) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:02:43,069] INFO [ReplicaFetcherThread-0-2]: Starting (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:02:43,076] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Truncating partition my-topic-0 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:02:43,136] INFO [UnifiedLog partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:02:43,138] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Truncating partition my-topic-1 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:02:43,138] INFO [UnifiedLog partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:02:43,139] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Truncating partition my-topic-2 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:02:43,139] INFO [UnifiedLog partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:02:43,193] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-13 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,195] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-46 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,195] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-9 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,195] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-42 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,195] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-13 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,195] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-21 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,195] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-17 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-9 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-30 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-26 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-21 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-5 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-26 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-5 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-17 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-30 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-42 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,195] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-46 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,196] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-38 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,198] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-1 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,198] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-38 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,198] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-34 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,198] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-1 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,198] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-16 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,198] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-34 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-45 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-16 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-12 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-45 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-41 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-24 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-12 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-20 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-49 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-41 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-0 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-24 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-29 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-20 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,199] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-25 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-29 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-8 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-37 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-25 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-4 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-37 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-33 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-0 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-15 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-33 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-48 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-49 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-11 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-48 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,200] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-44 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-15 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-23 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-11 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-19 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-44 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-32 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-23 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-28 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-7 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-28 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-19 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-7 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-32 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-8 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-4 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,201] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-40 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,202] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-3 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,202] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-40 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,202] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-3 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,202] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-36 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-47 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-36 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-14 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-47 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-43 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-14 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-43 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-10 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,203] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-22 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,204] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-18 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,204] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-31 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,204] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-27 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,204] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-39 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,204] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-6 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,204] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-35 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,204] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-2 with epoch OptionalInt[21] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,211] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-18 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,212] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-31 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,212] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-6 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,212] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-10 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,213] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-2 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,213] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-35 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,213] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-22 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,213] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-39 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,213] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-27 in epoch OptionalInt[21] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:43,223] INFO [DynamicConfigPublisher broker id=1] Updating topic __consumer_offsets with new configuration : compression.type -> producer,cleanup.policy -> compact,segment.bytes -> 104857600 (kafka.server.metadata.DynamicConfigPublisher)
[2025-05-29 17:02:43,251] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=1) with a snapshot at offset 78455 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:02:43,273] INFO [BrokerLifecycleManager id=1] The broker has caught up. Transitioning from STARTING to RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:02:43,274] INFO [BrokerServer id=1] Finished waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:02:43,274] INFO [BrokerServer id=1] Waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:02:43,274] INFO [BrokerServer id=1] Finished waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:02:43,292] INFO [BrokerLifecycleManager id=1] The broker is in RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:02:43,288] INFO KafkaConfig values: 
	add.partitions.to.txn.retry.backoff.max.ms = 100
	add.partitions.to.txn.retry.backoff.ms = 20
	advertised.listeners = SSL://172.23.38.230:9092
	alter.config.policy.class.name = null
	alter.log.dirs.replication.quota.window.num = 11
	alter.log.dirs.replication.quota.window.size.seconds = 1
	authorizer.class.name = 
	auto.create.topics.enable = true
	auto.leader.rebalance.enable = true
	background.threads = 10
	broker.heartbeat.interval.ms = 2000
	broker.id = 1
	broker.rack = null
	broker.session.timeout.ms = 9000
	client.quota.callback.class = null
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = producer
	compression.zstd.level = 3
	connection.failed.authentication.delay.ms = 100
	connections.max.idle.ms = 600000
	connections.max.reauth.ms = 0
	controlled.shutdown.enable = true
	controller.listener.names = CONTROLLER
	controller.performance.always.log.threshold.ms = 2000
	controller.performance.sample.period.ms = 60000
	controller.quorum.append.linger.ms = 25
	controller.quorum.bootstrap.servers = []
	controller.quorum.election.backoff.max.ms = 1000
	controller.quorum.election.timeout.ms = 1000
	controller.quorum.fetch.timeout.ms = 2000
	controller.quorum.request.timeout.ms = 2000
	controller.quorum.retry.backoff.ms = 20
	controller.quorum.voters = [1@localhost:9093, 2@localhost:9096, 3@localhost:9099]
	controller.quota.window.num = 11
	controller.quota.window.size.seconds = 1
	controller.socket.timeout.ms = 30000
	create.topic.policy.class.name = null
	default.replication.factor = 3
	delegation.token.expiry.check.interval.ms = 3600000
	delegation.token.expiry.time.ms = 86400000
	delegation.token.max.lifetime.ms = 604800000
	delegation.token.secret.key = null
	delete.records.purgatory.purge.interval.requests = 1
	delete.topic.enable = true
	early.start.listeners = null
	fetch.max.bytes = 57671680
	fetch.purgatory.purge.interval.requests = 1000
	group.consumer.assignors = [uniform, range]
	group.consumer.heartbeat.interval.ms = 5000
	group.consumer.max.heartbeat.interval.ms = 15000
	group.consumer.max.session.timeout.ms = 60000
	group.consumer.max.size = 2147483647
	group.consumer.migration.policy = bidirectional
	group.consumer.min.heartbeat.interval.ms = 5000
	group.consumer.min.session.timeout.ms = 45000
	group.consumer.session.timeout.ms = 45000
	group.coordinator.append.linger.ms = 5
	group.coordinator.new.enable = true
	group.coordinator.rebalance.protocols = [classic, consumer]
	group.coordinator.threads = 4
	group.initial.rebalance.delay.ms = 3000
	group.max.session.timeout.ms = 1800000
	group.max.size = 2147483647
	group.min.session.timeout.ms = 6000
	group.share.delivery.count.limit = 5
	group.share.enable = false
	group.share.heartbeat.interval.ms = 5000
	group.share.max.groups = 10
	group.share.max.heartbeat.interval.ms = 15000
	group.share.max.record.lock.duration.ms = 60000
	group.share.max.session.timeout.ms = 60000
	group.share.max.size = 200
	group.share.min.heartbeat.interval.ms = 5000
	group.share.min.record.lock.duration.ms = 15000
	group.share.min.session.timeout.ms = 45000
	group.share.partition.max.record.locks = 200
	group.share.persister.class.name = org.apache.kafka.server.share.persister.DefaultStatePersister
	group.share.record.lock.duration.ms = 30000
	group.share.session.timeout.ms = 45000
	initial.broker.registration.timeout.ms = 60000
	inter.broker.listener.name = SSL
	kafka.metrics.polling.interval.secs = 10
	kafka.metrics.reporters = []
	leader.imbalance.check.interval.seconds = 300
	listener.security.protocol.map = SSL:SSL,CONTROLLER:SSL
	listeners = SSL://0.0.0.0:9092,CONTROLLER://:9093
	log.cleaner.backoff.ms = 15000
	log.cleaner.dedupe.buffer.size = 134217728
	log.cleaner.delete.retention.ms = 86400000
	log.cleaner.enable = true
	log.cleaner.io.buffer.load.factor = 0.9
	log.cleaner.io.buffer.size = 524288
	log.cleaner.io.max.bytes.per.second = 1.7976931348623157E308
	log.cleaner.max.compaction.lag.ms = 9223372036854775807
	log.cleaner.min.cleanable.ratio = 0.5
	log.cleaner.min.compaction.lag.ms = 0
	log.cleaner.threads = 1
	log.cleanup.policy = [delete]
	log.dir = /tmp/kafka-logs
	log.dir.failure.timeout.ms = 30000
	log.dirs = /home/ammar/kafka_data/broker1_4.0.0
	log.flush.interval.messages = 9223372036854775807
	log.flush.interval.ms = null
	log.flush.offset.checkpoint.interval.ms = 60000
	log.flush.scheduler.interval.ms = 9223372036854775807
	log.flush.start.offset.checkpoint.interval.ms = 60000
	log.index.interval.bytes = 4096
	log.index.size.max.bytes = 10485760
	log.initial.task.delay.ms = 30000
	log.local.retention.bytes = -2
	log.local.retention.ms = -2
	log.message.timestamp.after.max.ms = 3600000
	log.message.timestamp.before.max.ms = 9223372036854775807
	log.message.timestamp.type = CreateTime
	log.preallocate = false
	log.retention.bytes = -1
	log.retention.check.interval.ms = 300000
	log.retention.hours = 168
	log.retention.minutes = null
	log.retention.ms = null
	log.roll.hours = 168
	log.roll.jitter.hours = 0
	log.roll.jitter.ms = null
	log.roll.ms = null
	log.segment.bytes = 1073741824
	log.segment.delete.delay.ms = 60000
	max.connection.creation.rate = 2147483647
	max.connections = 2147483647
	max.connections.per.ip = 2147483647
	max.connections.per.ip.overrides = 
	max.incremental.fetch.session.cache.slots = 1000
	max.request.partition.size.limit = 2000
	message.max.bytes = 1048588
	metadata.log.dir = null
	metadata.log.max.record.bytes.between.snapshots = 20971520
	metadata.log.max.snapshot.interval.ms = 3600000
	metadata.log.segment.bytes = 1073741824
	metadata.log.segment.min.bytes = 8388608
	metadata.log.segment.ms = 604800000
	metadata.max.idle.interval.ms = 500
	metadata.max.retention.bytes = 104857600
	metadata.max.retention.ms = 604800000
	metric.reporters = [org.apache.kafka.common.metrics.JmxReporter]
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	min.insync.replicas = 2
	node.id = 1
	num.io.threads = 8
	num.network.threads = 3
	num.partitions = 1
	num.recovery.threads.per.data.dir = 1
	num.replica.alter.log.dirs.threads = null
	num.replica.fetchers = 1
	offset.metadata.max.bytes = 4096
	offsets.commit.timeout.ms = 5000
	offsets.load.buffer.size = 5242880
	offsets.retention.check.interval.ms = 600000
	offsets.retention.minutes = 10080
	offsets.topic.compression.codec = 0
	offsets.topic.num.partitions = 50
	offsets.topic.replication.factor = 3
	offsets.topic.segment.bytes = 104857600
	principal.builder.class = class org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder
	process.roles = [broker, controller]
	producer.id.expiration.check.interval.ms = 600000
	producer.id.expiration.ms = 86400000
	producer.purgatory.purge.interval.requests = 1000
	queued.max.request.bytes = -1
	queued.max.requests = 500
	quota.window.num = 11
	quota.window.size.seconds = 1
	remote.fetch.max.wait.ms = 500
	remote.list.offsets.request.timeout.ms = 30000
	remote.log.index.file.cache.total.size.bytes = 1073741824
	remote.log.manager.copier.thread.pool.size = 10
	remote.log.manager.copy.max.bytes.per.second = 9223372036854775807
	remote.log.manager.copy.quota.window.num = 11
	remote.log.manager.copy.quota.window.size.seconds = 1
	remote.log.manager.expiration.thread.pool.size = 10
	remote.log.manager.fetch.max.bytes.per.second = 9223372036854775807
	remote.log.manager.fetch.quota.window.num = 11
	remote.log.manager.fetch.quota.window.size.seconds = 1
	remote.log.manager.task.interval.ms = 30000
	remote.log.manager.task.retry.backoff.max.ms = 30000
	remote.log.manager.task.retry.backoff.ms = 500
	remote.log.manager.task.retry.jitter = 0.2
	remote.log.manager.thread.pool.size = 2
	remote.log.metadata.custom.metadata.max.bytes = 128
	remote.log.metadata.manager.class.name = org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager
	remote.log.metadata.manager.class.path = null
	remote.log.metadata.manager.impl.prefix = rlmm.config.
	remote.log.metadata.manager.listener.name = null
	remote.log.reader.max.pending.tasks = 100
	remote.log.reader.threads = 10
	remote.log.storage.manager.class.name = null
	remote.log.storage.manager.class.path = null
	remote.log.storage.manager.impl.prefix = rsm.config.
	remote.log.storage.system.enable = false
	replica.fetch.backoff.ms = 1000
	replica.fetch.max.bytes = 1048576
	replica.fetch.min.bytes = 1
	replica.fetch.response.max.bytes = 10485760
	replica.fetch.wait.max.ms = 500
	replica.high.watermark.checkpoint.interval.ms = 5000
	replica.lag.time.max.ms = 30000
	replica.selector.class = null
	replica.socket.receive.buffer.bytes = 65536
	replica.socket.timeout.ms = 30000
	replication.quota.window.num = 11
	replication.quota.window.size.seconds = 1
	request.timeout.ms = 30000
	sasl.client.callback.handler.class = null
	sasl.enabled.mechanisms = [GSSAPI]
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.principal.to.local.rules = [DEFAULT]
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism.controller.protocol = GSSAPI
	sasl.mechanism.inter.broker.protocol = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	sasl.server.callback.handler.class = null
	sasl.server.max.receive.size = 524288
	security.inter.broker.protocol = PLAINTEXT
	security.providers = null
	server.max.startup.time.ms = 9223372036854775807
	share.coordinator.append.linger.ms = 10
	share.coordinator.load.buffer.size = 5242880
	share.coordinator.snapshot.update.records.per.snapshot = 500
	share.coordinator.state.topic.compression.codec = 0
	share.coordinator.state.topic.min.isr = 2
	share.coordinator.state.topic.num.partitions = 50
	share.coordinator.state.topic.prune.interval.ms = 300000
	share.coordinator.state.topic.replication.factor = 3
	share.coordinator.state.topic.segment.bytes = 104857600
	share.coordinator.threads = 1
	share.coordinator.write.timeout.ms = 5000
	share.fetch.max.fetch.records = 2147483647
	share.fetch.purgatory.purge.interval.requests = 1000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	socket.listen.backlog.size = 50
	socket.receive.buffer.bytes = 102400
	socket.request.max.bytes = 104857600
	socket.send.buffer.bytes = 102400
	ssl.allow.dn.changes = false
	ssl.allow.san.changes = false
	ssl.cipher.suites = []
	ssl.client.auth = required
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = 
	ssl.engine.factory.class = null
	ssl.key.password = [hidden]
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.keystore.jks
	ssl.keystore.password = [hidden]
	ssl.keystore.type = JKS
	ssl.principal.mapping.rules = DEFAULT
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.truststore.jks
	ssl.truststore.password = [hidden]
	ssl.truststore.type = JKS
	telemetry.max.bytes = 1048576
	transaction.abort.timed.out.transaction.cleanup.interval.ms = 10000
	transaction.max.timeout.ms = 900000
	transaction.partition.verification.enable = true
	transaction.remove.expired.transaction.cleanup.interval.ms = 3600000
	transaction.state.log.load.buffer.size = 5242880
	transaction.state.log.min.isr = 2
	transaction.state.log.num.partitions = 50
	transaction.state.log.replication.factor = 3
	transaction.state.log.segment.bytes = 104857600
	transactional.id.expiration.ms = 604800000
	unclean.leader.election.enable = false
	unclean.leader.election.interval.ms = 300000
	unstable.api.versions.enable = false
	unstable.feature.versions.enable = false
 (org.apache.kafka.common.config.AbstractConfig)
[2025-05-29 17:02:43,302] INFO [BrokerServer id=1] Waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:02:43,374] INFO [BrokerLifecycleManager id=1] The broker has been unfenced. Transitioning from RECOVERY to RUNNING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:02:43,374] INFO [BrokerServer id=1] Finished waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:02:43,375] INFO authorizerStart completed for endpoint SSL. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:02:43,375] INFO [SocketServer listenerType=BROKER, nodeId=1] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:02:43,375] INFO Awaiting socket connections on 0.0.0.0:9092. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:02:43,377] INFO [BrokerServer id=1] Waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:02:43,377] INFO [BrokerServer id=1] Finished waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:02:43,377] INFO [BrokerServer id=1] Waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:02:43,377] INFO [BrokerServer id=1] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:02:43,378] INFO [BrokerServer id=1] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-29 17:02:43,379] INFO Kafka version: 4.0.0 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:02:43,379] INFO Kafka commitId: 985bc99521dd22bb (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:02:43,380] INFO Kafka startTimeMs: 1748527363378 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:02:43,382] INFO [KafkaRaftServer nodeId=1] Kafka Server started (kafka.server.KafkaRaftServer)
[2025-05-29 17:02:43,825] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(__consumer_offsets-13, __consumer_offsets-46, __consumer_offsets-9, __consumer_offsets-42, __consumer_offsets-21, __consumer_offsets-17, ssl-test-topic-0, __consumer_offsets-30, __consumer_offsets-26, __consumer_offsets-5, __consumer_offsets-38, __consumer_offsets-1, __consumer_offsets-34, __consumer_offsets-16, __consumer_offsets-45, __consumer_offsets-12, __consumer_offsets-41, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-49, __consumer_offsets-0, ssl-test-topic-1, __consumer_offsets-29, __consumer_offsets-25, __consumer_offsets-8, __consumer_offsets-37, __consumer_offsets-4, __consumer_offsets-33, __consumer_offsets-15, __consumer_offsets-48, __consumer_offsets-11, __consumer_offsets-44, __consumer_offsets-23, __consumer_offsets-19, ssl-test-topic-2, __consumer_offsets-32, test-topic-0, __consumer_offsets-28, __consumer_offsets-7, __consumer_offsets-40, __consumer_offsets-3, __consumer_offsets-36, __consumer_offsets-47, __consumer_offsets-14, __consumer_offsets-43, __consumer_offsets-10, __consumer_offsets-22, __consumer_offsets-18, __consumer_offsets-31, __consumer_offsets-27, __consumer_offsets-39, __consumer_offsets-6, __consumer_offsets-35, __consumer_offsets-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:02:44,688] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-13 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,694] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-46 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,695] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-9 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,695] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-42 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,696] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-21 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,696] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-17 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,697] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-30 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,697] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-26 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,698] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-5 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,698] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-38 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,698] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-1 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,699] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-34 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,699] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-16 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,699] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-45 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,700] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-12 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,700] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-41 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,700] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-24 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,701] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-20 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,701] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-49 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,701] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-0 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,702] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-29 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,702] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-25 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,702] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-8 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,703] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-37 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,703] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-4 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,703] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-33 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,704] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-15 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,704] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-48 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,704] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-11 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,705] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-44 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,705] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-23 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,705] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-19 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,706] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-32 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,706] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-28 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,707] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-7 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,708] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-40 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,708] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-3 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,708] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-36 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,709] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-47 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,709] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-14 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,709] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-43 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,709] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-10 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,709] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-22 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,710] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-18 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,710] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-31 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,711] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-27 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,711] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-39 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,712] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-6 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,712] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-35 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,712] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-2 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,794] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-13 with epoch 22 in 5ms where 4ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-42 with epoch 22 in 119ms where 8ms was spent in the scheduler. Loaded 3 records which total to 592 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-9 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-37 with epoch 22 in 111ms where 111ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-5 with epoch 22 in 111ms where 111ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-41 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-22 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-29 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-24 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,848] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-8 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,849] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-14 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,849] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-7 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,849] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-26 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,849] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-47 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,849] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-32 with epoch 22 in 110ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,860] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-31 with epoch 22 in 120ms where 110ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,861] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-19 with epoch 22 in 119ms where 119ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,861] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-15 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,860] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-4 with epoch 22 in 119ms where 119ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,861] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-6 with epoch 22 in 121ms where 121ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,861] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-38 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-25 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-20 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-33 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-21 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-45 with epoch 22 in 119ms where 119ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-28 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-46 with epoch 22 in 134ms where 134ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-40 with epoch 22 in 119ms where 119ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-39 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-10 with epoch 22 in 119ms where 119ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-49 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-17 with epoch 22 in 120ms where 120ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-48 with epoch 22 in 117ms where 117ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,862] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-34 with epoch 22 in 117ms where 117ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,863] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-36 with epoch 22 in 119ms where 119ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,863] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-27 with epoch 22 in 118ms where 118ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,864] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-44 with epoch 22 in 116ms where 116ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,864] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-11 with epoch 22 in 114ms where 114ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,864] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-23 with epoch 22 in 112ms where 112ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,864] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-43 with epoch 22 in 109ms where 109ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,864] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-30 with epoch 22 in 107ms where 107ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,864] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-1 with epoch 22 in 106ms where 106ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,865] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-3 with epoch 22 in 106ms where 106ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,865] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-16 with epoch 22 in 107ms where 107ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,865] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-0 with epoch 22 in 106ms where 106ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,865] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-35 with epoch 22 in 105ms where 105ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,865] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-18 with epoch 22 in 106ms where 106ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,865] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-2 with epoch 22 in 106ms where 106ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:02:44,871] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-12 with epoch 22 in 101ms where 95ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:03:37,047] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:37,048] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:37,048] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=485, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1650, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=485, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,064] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=485, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1562, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=485, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,078] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=486, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1138) from ProspectiveState(epoch=485, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1650, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,137] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=486, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1416) from ProspectiveState(epoch=485, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1562, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,293] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=486, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1138) from ProspectiveState(epoch=485, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1650, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,373] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=486, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1416) from ProspectiveState(epoch=485, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1562, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,387] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=486, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=485, lastOffset=78620, preVote=false)])]) with epoch 486 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:37,410] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=486, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=485, lastOffset=78620, preVote=false)])]) with epoch 486 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:37,550] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:37,706] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:37,706] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=486, epochStartOffset=78620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=486, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1138) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,766] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:37,793] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=486, epochStartOffset=78620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=486, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1138) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,806] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:37,807] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=486, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1574, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=486, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1416) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,812] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=487, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1978) from ProspectiveState(epoch=486, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1574, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,866] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=486, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=485, lastOffset=78620, preVote=true)])]) with epoch 486 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:37,868] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:37,894] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=487, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1978) from ProspectiveState(epoch=486, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1574, highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,903] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=487, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=486, epochStartOffset=78620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78620, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625064)])], lastFetchTimestamp=1748527417865, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78621, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625170)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:37,933] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=179, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=179, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:50830-1-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@35cee731]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:03:37,934] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:37,935] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:37,986] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,050] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=182, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=182, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:50846-2-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3824442f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:03:38,060] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:38,052] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=487, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=486, epochStartOffset=78620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78620, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625064)])], lastFetchTimestamp=1748527417865, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78621, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625170)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:38,062] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=487, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=485, lastOffset=78620, preVote=false)])]) with epoch 487 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:38,097] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=255, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78619, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=255, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:50860-0-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4a48b1e8]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:03:38,317] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=487, epochStartOffset=78620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=487, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1978) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:38,371] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=487, epochStartOffset=78620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=487, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78619, metadata=Optional.empty)], electionTimeoutMs=1978) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:38,463] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,558] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=487, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=487, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:38,567] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=131, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=131, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59852-0-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@55be3468]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:38,569] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:38,570] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,628] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=487, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=487, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:03:38,628] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,649] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 78620 (kafka.log.UnifiedLog)
[2025-05-29 17:03:38,664] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 78620 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:03:38,675] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 78620 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:03:38,676] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=78069, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000078069.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:03:38,691] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,737] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=134, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=134, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59862-1-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@41cb061f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:38,748] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:38,748] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,791] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=184, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=184, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59884-0-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7f21832c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:38,798] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,800] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:38,801] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,810] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=258, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78619, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=258, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59868-2-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@475ac97]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:38,828] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 78620 with 0 producer ids in 151 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:03:38,829] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 1ms for snapshot load and 153ms for segment recovery from offset 78620 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:03:38,829] INFO [RaftManager id=3] Truncated to offset 78620 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:03:38,850] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,893] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=137, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=137, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59896-1-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4c99042]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:38,897] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:38,898] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:38,961] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:39,001] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=261, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78619, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=261, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59912-0-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@c4c7d21]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:39,004] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=187, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=187, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59904-2-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@383872cd]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:39,030] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:39,031] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:39,066] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=140, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=140, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59914-1-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@147bde8a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:39,084] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:39,129] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:39,130] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:39,183] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:39,252] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=190, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78618, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=190, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59926-2-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@73cc638f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:39,224] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=78621, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625170)]) for the first time for epoch 487 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78621, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625170)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78621, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625170)])], lastFetchTimestamp=1748527419219, lastCaughtUpTimestamp=1748527419219, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78620, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2625064)])], lastFetchTimestamp=1748527418841, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:03:39,256] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:03:39,234] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=264, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78619, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=264, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59928-0-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2b05b618]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:03:39,281] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:39,331] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:03:39,980] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=78621, metadata=Optional.empty)] for the first time for epoch 487 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:04:09,634] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:04:09,635] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 78675 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,636] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 78675 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,637] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,638] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=487, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1302, highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=487, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,639] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=487, voters=[1, 2, 3], electionTimeoutMs=1295, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=487, epochStartOffset=78620, highWatermark=Optional[LogOffsetMetadata(offset=78675, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629058)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78675, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629058)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78675, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629058)])], lastFetchTimestamp=1748527446407, lastCaughtUpTimestamp=1748527446407, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78675, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629058)])], lastFetchTimestamp=1748527446408, lastCaughtUpTimestamp=1748527446408, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,640] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=487, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=true)])]) with epoch 487 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,640] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=487, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=true)])]) with epoch 487 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,641] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=487, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=true)])]) with epoch 487 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,642] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=488, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], electionTimeoutMs=1116) from ProspectiveState(epoch=487, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1302, highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,658] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=488, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], electionTimeoutMs=1116) from ProspectiveState(epoch=487, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1302, highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,660] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=488, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=false)])]) with epoch 488 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,661] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1271, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=487, voters=[1, 2, 3], electionTimeoutMs=1295, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,674] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1271, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=487, voters=[1, 2, 3], electionTimeoutMs=1295, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,675] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1512052488). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:04:09,677] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1575, highWatermark=Optional.empty) from UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1271, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,712] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1575, highWatermark=Optional.empty) from UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1271, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,712] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=488, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=false)])]) with epoch 488 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,713] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=488, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=false)])]) with epoch 488 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,715] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,715] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,716] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=488, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1916, highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=488, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], electionTimeoutMs=1116) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,719] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=488, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=true)])]) with epoch 488 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,720] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=489, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], electionTimeoutMs=1321) from ProspectiveState(epoch=488, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1916, highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,767] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=489, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], electionTimeoutMs=1321) from ProspectiveState(epoch=488, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1916, highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,769] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1483, highWatermark=Optional.empty) from UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1575, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,786] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1483, highWatermark=Optional.empty) from UnattachedState(epoch=488, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1575, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,787] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) from UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1483, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,816] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) from UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1483, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,817] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=489, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=487, lastOffset=78675, preVote=false)])]) with epoch 489 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:09,821] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=489, epochStartOffset=78675, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=489, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], electionTimeoutMs=1321) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,843] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=489, epochStartOffset=78675, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=489, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78674, metadata=Optional.empty)], electionTimeoutMs=1321) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,867] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=489, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,879] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=489, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=489, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:09,929] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=78676, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629164)]) for the first time for epoch 489 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78676, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629164)])], lastFetchTimestamp=1748527449929, lastCaughtUpTimestamp=1748527449929, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78676, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629164)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78675, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2629058)])], lastFetchTimestamp=1748527449901, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:04:10,251] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=158, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78674, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=158, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59938-1-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@387cb542]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:04:10,252] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:04:10,253] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:04:10,262] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=208, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78675, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=208, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59956-0-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5a746875]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:04:10,263] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:04:10,264] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:04:10,325] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=282, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78673, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=282, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59952-2-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2c65b143]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:04:10,432] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=78676, metadata=Optional.empty)] for the first time for epoch 489 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:04:41,033] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:41,033] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=489, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1365, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=489, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,035] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:04:41,036] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=489, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=489, lastOffset=78735, preVote=true)])]) with epoch 489 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:41,036] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 254 due to node 3 being disconnected (elapsed time since creation: 44514ms, elapsed time since send: 44514ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:04:41,055] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1344, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) from ProspectiveState(epoch=489, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1365, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,066] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1344, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) from ProspectiveState(epoch=489, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1365, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,067] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1737, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) from UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1344, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,079] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1737, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) from UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1344, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,079] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=490, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=489, lastOffset=78735, preVote=false)])]) with epoch 490 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:41,121] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=490, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1737, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,139] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=490, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], fetchingSnapshot=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=489, epochStartOffset=78675, highWatermark=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], lastFetchTimestamp=1748527481056, lastCaughtUpTimestamp=1748527479023, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], lastFetchTimestamp=1748527481056, lastCaughtUpTimestamp=1748527479014, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78736, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633484)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,152] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=490, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=490, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1737, highWatermark=Optional[LogOffsetMetadata(offset=78734, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,166] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=490, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], fetchingSnapshot=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=489, epochStartOffset=78675, highWatermark=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], lastFetchTimestamp=1748527481056, lastCaughtUpTimestamp=1748527479023, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78735, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633412)])], lastFetchTimestamp=1748527481056, lastCaughtUpTimestamp=1748527479014, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78736, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2633484)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:04:41,166] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(894293773). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:04:41,168] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 78735 (kafka.log.UnifiedLog)
[2025-05-29 17:04:41,169] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 78735 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:04:41,169] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 78735 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:04:41,169] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=78620, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000078620.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:04:41,181] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 78735 with 0 producer ids in 12 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:04:41,181] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 12ms for segment recovery from offset 78735 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:04:41,181] INFO [RaftManager id=3] Truncated to offset 78735 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:04:41,408] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=175, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78733, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=175, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:46186-1-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@67e3876d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:04:41,408] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=225, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78734, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=225, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:46190-2-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7dba33d8]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:04:41,409] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:04:41,409] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:04:41,410] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:04:41,410] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:04:41,465] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=299, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78735, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=299, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:46200-0-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3021d929]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:05:13,444] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:13,444] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:13,445] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=490, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1585, highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=490, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,445] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=490, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1858, highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=490, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,446] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=490, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=490, lastOffset=78794, preVote=true)])]) with epoch 490 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:13,448] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1768) from ProspectiveState(epoch=490, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1585, highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,453] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1874) from ProspectiveState(epoch=490, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1858, highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,477] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1768) from ProspectiveState(epoch=490, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1585, highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,481] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1874) from ProspectiveState(epoch=490, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1858, highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,482] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=491, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=490, lastOffset=78794, preVote=false)])]) with epoch 491 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:13,483] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=491, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=490, lastOffset=78794, preVote=false)])]) with epoch 491 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:13,511] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:13,512] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=491, epochStartOffset=78794, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1768) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,523] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=491, epochStartOffset=78794, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1768) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,540] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=491, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1874) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,551] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=491, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=491, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78793, metadata=Optional.empty)], electionTimeoutMs=1874) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:13,584] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=78795, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2637800)]) for the first time for epoch 491 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78795, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2637800)])], lastFetchTimestamp=1748527513583, lastCaughtUpTimestamp=1748527513583, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78795, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2637800)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78794, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2637694)])], lastFetchTimestamp=1748527513553, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:05:14,250] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:05:14,251] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:05:14,266] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:05:14,267] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:05:46,294] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:05:46,294] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 78854 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,295] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 78854 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,296] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,296] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=491, voters=[1, 2, 3], electionTimeoutMs=1894, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=491, epochStartOffset=78794, highWatermark=Optional[LogOffsetMetadata(offset=78854, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2642048)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78854, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2642048)])], lastFetchTimestamp=1748527543132, lastCaughtUpTimestamp=1748527543132, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78854, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2642048)])], lastFetchTimestamp=1748527543131, lastCaughtUpTimestamp=1748527543131, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78854, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2642048)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,296] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=491, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1221, highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=491, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,297] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=491, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=491, lastOffset=78854, preVote=true)])]) with epoch 491 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,298] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=491, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=491, lastOffset=78854, preVote=true)])]) with epoch 491 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,299] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=491, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=491, lastOffset=78854, preVote=true)])]) with epoch 491 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,300] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=492, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)], electionTimeoutMs=1268) from ProspectiveState(epoch=491, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1221, highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,316] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=492, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)], electionTimeoutMs=1268) from ProspectiveState(epoch=491, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1221, highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,318] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=492, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=491, lastOffset=78854, preVote=false)])]) with epoch 492 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,318] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1871, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=491, voters=[1, 2, 3], electionTimeoutMs=1894, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,345] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1871, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=491, voters=[1, 2, 3], electionTimeoutMs=1894, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,346] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1184, highWatermark=Optional.empty) from UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1871, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,378] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1184, highWatermark=Optional.empty) from UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1871, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,378] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=492, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=491, lastOffset=78854, preVote=false)])]) with epoch 492 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,379] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=492, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=491, lastOffset=78854, preVote=false)])]) with epoch 492 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,380] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:05:46,417] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=492, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)], electionTimeoutMs=1268) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,417] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1184, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,429] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=492, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1184, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,430] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=492, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78853, metadata=Optional.empty)], electionTimeoutMs=1268) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:05:46,951] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=78855, metadata=Optional.empty)] for the first time for epoch 492 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:05:47,055] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=259, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=78102, currentMetadataOffset=78854, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=259, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38694-0-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@68ec4f5d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:05:47,055] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:05:47,056] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:05:47,074] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=333, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78855, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=333, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38702-1-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@72389c49]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:05:47,084] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=209, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78854, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=209, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38706-2-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@285a5773]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:05:47,085] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:05:47,086] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:10,242] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-29 17:06:11,002] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:06:11,007] INFO [ControllerServer id=3] Starting controller (kafka.server.ControllerServer)
[2025-05-29 17:06:11,883] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:06:12,831] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-29 17:06:12,844] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU.localdomain (org.apache.kafka.metadata.ListenerInfo)
[2025-05-29 17:06:12,855] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:06:12,857] INFO [SharedServer id=3] Starting SharedServer (kafka.server.SharedServer)
[2025-05-29 17:06:12,961] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 41651. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:12,966] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:12,967] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:12,968] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000078069.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:12,970] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000078620.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:12,971] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000078735.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:13,023] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 41651 with 0 producer ids in 50 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:13,030] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 4ms for snapshot load and 52ms for segment recovery from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:13,654] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 78907 with 0 producer ids in 6 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:13,668] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 78907 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:13,669] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 78907 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:13,670] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000041651.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:13,676] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=78907, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000078907.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:13,680] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 10ms for snapshot load and 0ms for segment recovery from offset 78907 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:13,776] INFO Initialized snapshots with IDs SortedSet(OffsetAndEpoch(offset=51509, epoch=142), OffsetAndEpoch(offset=58622, epoch=235), OffsetAndEpoch(offset=65922, epoch=287)) from /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-29 17:06:14,198] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:06:14,267] INFO [RaftManager id=3] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:14,278] ERROR Encountered fatal fault: Unexpected error in raft IO thread (org.apache.kafka.server.fault.ProcessTerminatingFaultHandler)
org.apache.kafka.common.errors.CorruptRecordException: Found record size 0 smaller than minimum record overhead (14) in file /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000041651.log.
[2025-05-29 17:06:14,293] INFO [RaftManager id=3] Loading snapshot (OffsetAndEpoch(offset=65922, epoch=287)) since log start offset (41651) is greater than the internal listener's next offset (-1) (org.apache.kafka.raft.internals.KRaftControlRecordStateMachine)
[2025-05-29 17:06:14,659] INFO [RaftManager id=3] Starting voters are VoterSet(voters={1=VoterNode(voterKey=ReplicaKey(id=1, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 2=VoterNode(voterKey=ReplicaKey(id=2, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 3=VoterNode(voterKey=ReplicaKey(id=3, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:14,661] INFO [RaftManager id=3] Starting request manager with static voters: [localhost:9093 (id: 1 rack: null isFenced: false), localhost:9096 (id: 2 rack: null isFenced: false), localhost:9099 (id: 3 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:14,683] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=<undefined>)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:14,771] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=<undefined>)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:14,785] INFO [kafka-3-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:06:14,787] INFO [kafka-3-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:06:14,835] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:14,838] INFO [RaftManager id=3] Registered the listener org.apache.kafka.image.loader.MetadataLoader@706818638 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:14,839] INFO [ControllerServer id=3] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:06:14,849] INFO [ControllerServer id=3] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:06:14,919] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:14,942] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:14,942] INFO [RaftManager id=3] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@177006311 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:14,957] INFO [controller-3-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:14,974] INFO [controller-3-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:14,977] INFO [controller-3-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:14,982] INFO [controller-3-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:15,046] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,048] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:15,132] INFO [ControllerServer id=3] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:06:15,133] INFO [ControllerServer id=3] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:06:15,133] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,134] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:06:15,141] INFO Awaiting socket connections on 0.0.0.0:9099. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:06:15,233] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,334] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,435] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,543] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=78912, metadata=Optional.empty)] for the first time for epoch 492 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:06:15,545] INFO [MetadataLoader id=3] initializeNewPublishers: The loader is still catching up because we have loaded up to offset -1, but the high water mark is 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,550] INFO [ControllerServer id=3] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:06:15,550] INFO [ControllerServer id=3] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:06:15,550] INFO [ControllerServer id=3] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:06:15,550] INFO [ControllerServer id=3] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:06:15,551] INFO [controller-3-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:15,552] INFO [BrokerServer id=3] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-29 17:06:15,553] INFO [BrokerServer id=3] Starting broker (kafka.server.BrokerServer)
[2025-05-29 17:06:15,560] INFO [ControllerRegistrationManager id=3 incarnation=xLa4plLuSG2qZmJE_94suQ] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:15,561] INFO [ControllerRegistrationManager id=3 incarnation=xLa4plLuSG2qZmJE_94suQ] maybeSendControllerRegistration: cannot register yet because the metadata.version is not known yet. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:15,562] INFO [controller-3-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:15,583] INFO [MetadataLoader id=3] handleLoadSnapshot(00000000000000065922-0000000287): incrementing HandleLoadSnapshotCount to 1. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,588] INFO [broker-3-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:15,603] INFO [broker-3-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:15,617] INFO [broker-3-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:15,606] INFO [broker-3-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:15,644] INFO [MetadataLoader id=3] handleLoadSnapshot(00000000000000065922-0000000287): generated a metadata delta between offset -1 and this snapshot in 60895 us. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,657] INFO [MetadataLoader id=3] maybePublishMetadata(SNAPSHOT): The loader is still catching up because we have loaded up to offset 65921, but the high water mark is 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,658] INFO [MetadataLoader id=3] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 65921, but the high water mark is 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:15,714] INFO [BrokerServer id=3] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:06:15,714] INFO [BrokerServer id=3] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:06:15,914] INFO [broker-3-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:15,915] INFO [broker-3-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:15,962] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:05:34,759] INFO [MetadataLoader id=3] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have loaded up to offset 78911, but the high water mark is 78913 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,761] INFO [MetadataLoader id=3] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 78911, but the high water mark is 78913 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,761] INFO [MetadataLoader id=3] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 78913 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,779] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,780] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,781] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,792] INFO [ControllerServer id=3] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=78912). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-29 17:05:34,793] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,793] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,794] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=3 with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,795] INFO [ControllerRegistrationManager id=3 incarnation=xLa4plLuSG2qZmJE_94suQ] Found registration for cYyHV0aqR_yCWowgJde4Aw instead of our incarnation. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:05:34,796] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:05:34,798] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=3 with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,801] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=3 with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,802] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ScramPublisher controller id=3 with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,809] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=3 with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,813] INFO [ControllerRegistrationManager id=3 incarnation=xLa4plLuSG2qZmJE_94suQ] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=3, incarnationId=xLa4plLuSG2qZmJE_94suQ, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.localdomain', port=9099, securityProtocol=1)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:05:34,816] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:05:34,816] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing AclPublisher controller id=3 with a snapshot at offset 78912 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:18,916] INFO [NodeToControllerChannelManager id=3 name=registration] Disconnecting from node 2 due to socket connection setup timeout. The timeout value is 10140 ms. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:18,929] INFO [controller-3-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:18,931] ERROR [ControllerRegistrationManager id=3 incarnation=xLa4plLuSG2qZmJE_94suQ] RegistrationResponseHandler: channel manager timed out before sending the request. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:19,023] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,036] INFO [ControllerRegistrationManager id=3 incarnation=xLa4plLuSG2qZmJE_94suQ] maybeSendControllerRegistration: waiting for the previous RPC to complete. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:19,042] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=492, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=<undefined>)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1219, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=<undefined>)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,063] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:19,065] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 4 due to node 2 being disconnected (elapsed time since creation: 44319ms, elapsed time since send: 44316ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:19,255] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=492, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=492, lastOffset=78914, preVote=true)])]) with epoch 492 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,255] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,256] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=492, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1070, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=492, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,290] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=493, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1566) from ProspectiveState(epoch=492, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1070, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,298] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=493, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1973) from ProspectiveState(epoch=492, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=<undefined>)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1219, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,389] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=493, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1566) from ProspectiveState(epoch=492, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1070, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,402] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=493, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1973) from ProspectiveState(epoch=492, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=<undefined>)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1219, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,416] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=493, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=492, lastOffset=78914, preVote=false)])]) with epoch 493 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,442] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=493, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=492, lastOffset=78914, preVote=false)])]) with epoch 493 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,489] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=493, epochStartOffset=78914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=493, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1566) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,492] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,498] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,500] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=493, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1141, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=493, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1973) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,521] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=494, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1481) from ProspectiveState(epoch=493, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1141, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,528] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=493, epochStartOffset=78914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=493, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1566) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,552] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=494, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1481) from ProspectiveState(epoch=493, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1141, highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,604] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=493, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=492, lastOffset=78914, preVote=true)])]) with epoch 493 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,608] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=494, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=493, epochStartOffset=78914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646508)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646402)])], lastFetchTimestamp=1748527579603, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,690] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=494, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=493, epochStartOffset=78914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646508)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646402)])], lastFetchTimestamp=1748527579603, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,691] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=494, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=492, lastOffset=78914, preVote=false)])]) with epoch 494 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:19,736] INFO [SocketServer listenerType=BROKER, nodeId=3] Created data-plane acceptor and processors for endpoint : ListenerName(SSL) (kafka.network.SocketServer)
[2025-05-29 17:06:19,737] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=494, epochStartOffset=78914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=494, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1481) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,779] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=494, epochStartOffset=78914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=494, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=78913, metadata=Optional.empty)], electionTimeoutMs=1481) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:19,854] INFO [broker-3-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:19,855] INFO [broker-3-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:19,907] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:19,919] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=494, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:20,032] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=494, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:20,049] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to offset 78914 (kafka.log.UnifiedLog)
[2025-05-29 17:06:20,050] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 78914 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:20,050] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 78914 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:20,051] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=77788, file=/home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000077788.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:20,113] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:20,142] INFO [broker-3-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:20,154] INFO [broker-3-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:20,158] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 78914 with 0 producer ids in 92 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:20,179] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 15ms for snapshot load and 113ms for segment recovery from offset 78914 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:20,180] INFO [RaftManager id=1] Truncated to offset 78914 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:20,230] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:20,276] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:20,287] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:20,287] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:20,291] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=78915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646508)]) for the first time for epoch 494 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646508)])], lastFetchTimestamp=1748527580278, lastCaughtUpTimestamp=1748527580278, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646508)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=78914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2646402)])], lastFetchTimestamp=1748527580187, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:06:20,291] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:20,303] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:20,352] INFO [BrokerServer id=3] Using no op persister (kafka.server.BrokerServer)
[2025-05-29 17:06:20,326] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=227, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=78457, currentMetadataOffset=78912, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=227, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:50508-0-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@77f255d3]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:06:20,377] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:06:20,378] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:20,379] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:20,337] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=351, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=77973, currentMetadataOffset=78913, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=351, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:50500-2-0', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@26012859]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:06:20,429] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:20,506] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:20,516] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:20,516] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:20,531] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:20,920] INFO Unable to read the broker epoch in /home/ammar/kafka_data/broker3_4.0.0. (kafka.log.LogManager)
[2025-05-29 17:06:20,923] INFO [broker-3-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:20,924] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:20,934] INFO [BrokerLifecycleManager id=3] Incarnation 3Ok6qXm_SAG_O_UlmMY_vg of broker 3 in cluster vN8K3C85SQS4roeM5v3xFg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:20,975] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:06:21,049] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:21,057] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=78915, metadata=Optional.empty)] for the first time for epoch 494 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:06:21,076] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:21,148] INFO [BrokerServer id=3] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:06:21,149] INFO [BrokerServer id=3] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:06:21,149] INFO [BrokerServer id=3] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:06:21,151] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing MetadataVersionPublisher(id=3) with a snapshot at offset 78915 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:21,151] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 78915 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:21,153] INFO [BrokerMetadataPublisher id=3] Publishing initial metadata at offset OffsetAndEpoch(offset=78915, epoch=494) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-29 17:06:21,161] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:21,176] INFO Recovering 3 logs from /home/ammar/kafka_data/broker3_4.0.0 since no clean shutdown file was found (kafka.log.LogManager)
[2025-05-29 17:06:21,197] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:21,216] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-2. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:21,217] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,217] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,218] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,232] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,233] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,233] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,314] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker3_4.0.0/my-topic-2, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 24ms (1/3 completed in /home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:21,320] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:21,321] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,322] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,322] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,402] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:21,532] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,532] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,533] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,536] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker3_4.0.0/my-topic-0, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 221ms (2/3 completed in /home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:21,541] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-1. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:21,556] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,559] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,559] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,563] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,564] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,564] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:21,568] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker3_4.0.0/my-topic-1, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 30ms (3/3 completed in /home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:21,602] INFO Loaded 3 logs in 411ms (unclean log dirs = ArrayBuffer(/home/ammar/kafka_data/broker3_4.0.0)) (kafka.log.LogManager)
[2025-05-29 17:06:21,605] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-29 17:06:21,607] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-29 17:06:21,802] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:22,457] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:06:22,463] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:06:22,464] INFO [AddPartitionsToTxnSenderThread-3]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:06:22,465] INFO [GroupCoordinator id=3] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:06:22,466] INFO [GroupCoordinator id=3] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:06:22,468] INFO [TransactionCoordinator id=3] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:06:22,473] INFO [TransactionCoordinator id=3] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:06:22,473] INFO [TxnMarkerSenderThread-3]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:06:22,570] INFO [Partition my-topic-0 broker=3] Log loaded for partition my-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:06:22,597] INFO [Partition my-topic-1 broker=3] Log loaded for partition my-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:06:22,609] INFO [Partition my-topic-2 broker=3] Log loaded for partition my-topic-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:06:22,613] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:06:22,614] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:22,827] INFO [ReplicaFetcherThread-0-2]: Starting (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:06:22,835] INFO [ReplicaFetcherManager on broker 3] Added fetcher to broker 2 for partitions HashMap(my-topic-0 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),19,0), my-topic-1 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),17,0), my-topic-2 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),18,0)) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:06:22,838] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Truncating partition my-topic-0 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:06:22,844] INFO [UnifiedLog partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:06:22,846] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Truncating partition my-topic-1 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:06:22,847] INFO [UnifiedLog partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:06:22,848] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Truncating partition my-topic-2 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:06:22,848] INFO [UnifiedLog partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:06:22,894] INFO [DynamicConfigPublisher broker id=3] Updating topic __consumer_offsets with new configuration : compression.type -> producer,cleanup.policy -> compact,segment.bytes -> 104857600 (kafka.server.metadata.DynamicConfigPublisher)
[2025-05-29 17:06:22,917] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=3) with a snapshot at offset 78915 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:24,249] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:27,405] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:31,954] INFO [BrokerLifecycleManager id=3] Successfully registered broker 3 with broker epoch 78941 (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:32,001] INFO [BrokerLifecycleManager id=3] The broker has caught up. Transitioning from STARTING to RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:32,001] INFO [BrokerServer id=3] Finished waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:06:32,002] INFO [BrokerServer id=3] Waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:06:32,002] INFO [BrokerServer id=3] Finished waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:06:32,005] INFO KafkaConfig values: 
	add.partitions.to.txn.retry.backoff.max.ms = 100
	add.partitions.to.txn.retry.backoff.ms = 20
	advertised.listeners = SSL://172.23.38.230:9097
	alter.config.policy.class.name = null
	alter.log.dirs.replication.quota.window.num = 11
	alter.log.dirs.replication.quota.window.size.seconds = 1
	authorizer.class.name = 
	auto.create.topics.enable = true
	auto.leader.rebalance.enable = true
	background.threads = 10
	broker.heartbeat.interval.ms = 2000
	broker.id = 3
	broker.rack = null
	broker.session.timeout.ms = 9000
	client.quota.callback.class = null
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = producer
	compression.zstd.level = 3
	connection.failed.authentication.delay.ms = 100
	connections.max.idle.ms = 600000
	connections.max.reauth.ms = 0
	controlled.shutdown.enable = true
	controller.listener.names = CONTROLLER
	controller.performance.always.log.threshold.ms = 2000
	controller.performance.sample.period.ms = 60000
	controller.quorum.append.linger.ms = 25
	controller.quorum.bootstrap.servers = []
	controller.quorum.election.backoff.max.ms = 1000
	controller.quorum.election.timeout.ms = 1000
	controller.quorum.fetch.timeout.ms = 2000
	controller.quorum.request.timeout.ms = 2000
	controller.quorum.retry.backoff.ms = 20
	controller.quorum.voters = [1@localhost:9093, 2@localhost:9096, 3@localhost:9099]
	controller.quota.window.num = 11
	controller.quota.window.size.seconds = 1
	controller.socket.timeout.ms = 30000
	create.topic.policy.class.name = null
	default.replication.factor = 3
	delegation.token.expiry.check.interval.ms = 3600000
	delegation.token.expiry.time.ms = 86400000
	delegation.token.max.lifetime.ms = 604800000
	delegation.token.secret.key = null
	delete.records.purgatory.purge.interval.requests = 1
	delete.topic.enable = true
	early.start.listeners = null
	fetch.max.bytes = 57671680
	fetch.purgatory.purge.interval.requests = 1000
	group.consumer.assignors = [uniform, range]
	group.consumer.heartbeat.interval.ms = 5000
	group.consumer.max.heartbeat.interval.ms = 15000
	group.consumer.max.session.timeout.ms = 60000
	group.consumer.max.size = 2147483647
	group.consumer.migration.policy = bidirectional
	group.consumer.min.heartbeat.interval.ms = 5000
	group.consumer.min.session.timeout.ms = 45000
	group.consumer.session.timeout.ms = 45000
	group.coordinator.append.linger.ms = 5
	group.coordinator.new.enable = true
	group.coordinator.rebalance.protocols = [classic, consumer]
	group.coordinator.threads = 4
	group.initial.rebalance.delay.ms = 3000
	group.max.session.timeout.ms = 1800000
	group.max.size = 2147483647
	group.min.session.timeout.ms = 6000
	group.share.delivery.count.limit = 5
	group.share.enable = false
	group.share.heartbeat.interval.ms = 5000
	group.share.max.groups = 10
	group.share.max.heartbeat.interval.ms = 15000
	group.share.max.record.lock.duration.ms = 60000
	group.share.max.session.timeout.ms = 60000
	group.share.max.size = 200
	group.share.min.heartbeat.interval.ms = 5000
	group.share.min.record.lock.duration.ms = 15000
	group.share.min.session.timeout.ms = 45000
	group.share.partition.max.record.locks = 200
	group.share.persister.class.name = org.apache.kafka.server.share.persister.DefaultStatePersister
	group.share.record.lock.duration.ms = 30000
	group.share.session.timeout.ms = 45000
	initial.broker.registration.timeout.ms = 60000
	inter.broker.listener.name = SSL
	kafka.metrics.polling.interval.secs = 10
	kafka.metrics.reporters = []
	leader.imbalance.check.interval.seconds = 300
	listener.security.protocol.map = SSL:SSL,CONTROLLER:SSL
	listeners = SSL://0.0.0.0:9097,CONTROLLER://:9099
	log.cleaner.backoff.ms = 15000
	log.cleaner.dedupe.buffer.size = 134217728
	log.cleaner.delete.retention.ms = 86400000
	log.cleaner.enable = true
	log.cleaner.io.buffer.load.factor = 0.9
	log.cleaner.io.buffer.size = 524288
	log.cleaner.io.max.bytes.per.second = 1.7976931348623157E308
	log.cleaner.max.compaction.lag.ms = 9223372036854775807
	log.cleaner.min.cleanable.ratio = 0.5
	log.cleaner.min.compaction.lag.ms = 0
	log.cleaner.threads = 1
	log.cleanup.policy = [delete]
	log.dir = /tmp/kafka-logs
	log.dir.failure.timeout.ms = 30000
	log.dirs = /home/ammar/kafka_data/broker3_4.0.0
	log.flush.interval.messages = 9223372036854775807
	log.flush.interval.ms = null
	log.flush.offset.checkpoint.interval.ms = 60000
	log.flush.scheduler.interval.ms = 9223372036854775807
	log.flush.start.offset.checkpoint.interval.ms = 60000
	log.index.interval.bytes = 4096
	log.index.size.max.bytes = 10485760
	log.initial.task.delay.ms = 30000
	log.local.retention.bytes = -2
	log.local.retention.ms = -2
	log.message.timestamp.after.max.ms = 3600000
	log.message.timestamp.before.max.ms = 9223372036854775807
	log.message.timestamp.type = CreateTime
	log.preallocate = false
	log.retention.bytes = -1
	log.retention.check.interval.ms = 300000
	log.retention.hours = 168
	log.retention.minutes = null
	log.retention.ms = null
	log.roll.hours = 168
	log.roll.jitter.hours = 0
	log.roll.jitter.ms = null
	log.roll.ms = null
	log.segment.bytes = 1073741824
	log.segment.delete.delay.ms = 60000
	max.connection.creation.rate = 2147483647
	max.connections = 2147483647
	max.connections.per.ip = 2147483647
	max.connections.per.ip.overrides = 
	max.incremental.fetch.session.cache.slots = 1000
	max.request.partition.size.limit = 2000
	message.max.bytes = 1048588
	metadata.log.dir = null
	metadata.log.max.record.bytes.between.snapshots = 20971520
	metadata.log.max.snapshot.interval.ms = 3600000
	metadata.log.segment.bytes = 1073741824
	metadata.log.segment.min.bytes = 8388608
	metadata.log.segment.ms = 604800000
	metadata.max.idle.interval.ms = 500
	metadata.max.retention.bytes = 104857600
	metadata.max.retention.ms = 604800000
	metric.reporters = [org.apache.kafka.common.metrics.JmxReporter]
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	min.insync.replicas = 2
	node.id = 3
	num.io.threads = 8
	num.network.threads = 3
	num.partitions = 1
	num.recovery.threads.per.data.dir = 1
	num.replica.alter.log.dirs.threads = null
	num.replica.fetchers = 1
	offset.metadata.max.bytes = 4096
	offsets.commit.timeout.ms = 5000
	offsets.load.buffer.size = 5242880
	offsets.retention.check.interval.ms = 600000
	offsets.retention.minutes = 10080
	offsets.topic.compression.codec = 0
	offsets.topic.num.partitions = 50
	offsets.topic.replication.factor = 3
	offsets.topic.segment.bytes = 104857600
	principal.builder.class = class org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder
	process.roles = [broker, controller]
	producer.id.expiration.check.interval.ms = 600000
	producer.id.expiration.ms = 86400000
	producer.purgatory.purge.interval.requests = 1000
	queued.max.request.bytes = -1
	queued.max.requests = 500
	quota.window.num = 11
	quota.window.size.seconds = 1
	remote.fetch.max.wait.ms = 500
	remote.list.offsets.request.timeout.ms = 30000
	remote.log.index.file.cache.total.size.bytes = 1073741824
	remote.log.manager.copier.thread.pool.size = 10
	remote.log.manager.copy.max.bytes.per.second = 9223372036854775807
	remote.log.manager.copy.quota.window.num = 11
	remote.log.manager.copy.quota.window.size.seconds = 1
	remote.log.manager.expiration.thread.pool.size = 10
	remote.log.manager.fetch.max.bytes.per.second = 9223372036854775807
	remote.log.manager.fetch.quota.window.num = 11
	remote.log.manager.fetch.quota.window.size.seconds = 1
	remote.log.manager.task.interval.ms = 30000
	remote.log.manager.task.retry.backoff.max.ms = 30000
	remote.log.manager.task.retry.backoff.ms = 500
	remote.log.manager.task.retry.jitter = 0.2
	remote.log.manager.thread.pool.size = 2
	remote.log.metadata.custom.metadata.max.bytes = 128
	remote.log.metadata.manager.class.name = org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager
	remote.log.metadata.manager.class.path = null
	remote.log.metadata.manager.impl.prefix = rlmm.config.
	remote.log.metadata.manager.listener.name = null
	remote.log.reader.max.pending.tasks = 100
	remote.log.reader.threads = 10
	remote.log.storage.manager.class.name = null
	remote.log.storage.manager.class.path = null
	remote.log.storage.manager.impl.prefix = rsm.config.
	remote.log.storage.system.enable = false
	replica.fetch.backoff.ms = 1000
	replica.fetch.max.bytes = 1048576
	replica.fetch.min.bytes = 1
	replica.fetch.response.max.bytes = 10485760
	replica.fetch.wait.max.ms = 500
	replica.high.watermark.checkpoint.interval.ms = 5000
	replica.lag.time.max.ms = 30000
	replica.selector.class = null
	replica.socket.receive.buffer.bytes = 65536
	replica.socket.timeout.ms = 30000
	replication.quota.window.num = 11
	replication.quota.window.size.seconds = 1
	request.timeout.ms = 30000
	sasl.client.callback.handler.class = null
	sasl.enabled.mechanisms = [GSSAPI]
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.principal.to.local.rules = [DEFAULT]
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism.controller.protocol = GSSAPI
	sasl.mechanism.inter.broker.protocol = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	sasl.server.callback.handler.class = null
	sasl.server.max.receive.size = 524288
	security.inter.broker.protocol = PLAINTEXT
	security.providers = null
	server.max.startup.time.ms = 9223372036854775807
	share.coordinator.append.linger.ms = 10
	share.coordinator.load.buffer.size = 5242880
	share.coordinator.snapshot.update.records.per.snapshot = 500
	share.coordinator.state.topic.compression.codec = 0
	share.coordinator.state.topic.min.isr = 2
	share.coordinator.state.topic.num.partitions = 50
	share.coordinator.state.topic.prune.interval.ms = 300000
	share.coordinator.state.topic.replication.factor = 3
	share.coordinator.state.topic.segment.bytes = 104857600
	share.coordinator.threads = 1
	share.coordinator.write.timeout.ms = 5000
	share.fetch.max.fetch.records = 2147483647
	share.fetch.purgatory.purge.interval.requests = 1000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	socket.listen.backlog.size = 50
	socket.receive.buffer.bytes = 102400
	socket.request.max.bytes = 104857600
	socket.send.buffer.bytes = 102400
	ssl.allow.dn.changes = false
	ssl.allow.san.changes = false
	ssl.cipher.suites = []
	ssl.client.auth = required
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = 
	ssl.engine.factory.class = null
	ssl.key.password = [hidden]
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.keystore.jks
	ssl.keystore.password = [hidden]
	ssl.keystore.type = JKS
	ssl.principal.mapping.rules = DEFAULT
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.truststore.jks
	ssl.truststore.password = [hidden]
	ssl.truststore.type = JKS
	telemetry.max.bytes = 1048576
	transaction.abort.timed.out.transaction.cleanup.interval.ms = 10000
	transaction.max.timeout.ms = 900000
	transaction.partition.verification.enable = true
	transaction.remove.expired.transaction.cleanup.interval.ms = 3600000
	transaction.state.log.load.buffer.size = 5242880
	transaction.state.log.min.isr = 2
	transaction.state.log.num.partitions = 50
	transaction.state.log.replication.factor = 3
	transaction.state.log.segment.bytes = 104857600
	transactional.id.expiration.ms = 604800000
	unclean.leader.election.enable = false
	unclean.leader.election.interval.ms = 300000
	unstable.api.versions.enable = false
	unstable.feature.versions.enable = false
 (org.apache.kafka.common.config.AbstractConfig)
[2025-05-29 17:06:32,011] INFO [BrokerServer id=3] Waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:06:32,015] INFO [BrokerLifecycleManager id=3] The broker is in RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:32,067] INFO [BrokerLifecycleManager id=3] The broker has been unfenced. Transitioning from RECOVERY to RUNNING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:32,067] INFO [BrokerServer id=3] Finished waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:06:32,068] INFO authorizerStart completed for endpoint SSL. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:06:32,069] INFO [SocketServer listenerType=BROKER, nodeId=3] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:06:32,069] INFO Awaiting socket connections on 0.0.0.0:9097. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:06:32,071] INFO [BrokerServer id=3] Waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:06:32,071] INFO [BrokerServer id=3] Finished waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:06:32,071] INFO [BrokerServer id=3] Waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:06:32,071] INFO [BrokerServer id=3] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:06:32,071] INFO [BrokerServer id=3] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-29 17:06:32,072] INFO Kafka version: 4.0.0 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:06:32,072] INFO Kafka commitId: 985bc99521dd22bb (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:06:32,073] INFO Kafka startTimeMs: 1748527592071 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:06:32,074] INFO [KafkaRaftServer nodeId=3] Kafka Server started (kafka.server.KafkaRaftServer)
[2025-05-29 17:06:41,185] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-29 17:06:41,841] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:06:41,845] INFO [ControllerServer id=1] Starting controller (kafka.server.ControllerServer)
[2025-05-29 17:06:42,697] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:06:44,197] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-29 17:06:44,228] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU.localdomain (org.apache.kafka.metadata.ListenerInfo)
[2025-05-29 17:06:44,251] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:06:44,256] INFO [SharedServer id=1] Starting SharedServer (kafka.server.SharedServer)
[2025-05-29 17:06:44,484] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 41651. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:44,500] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:44,502] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:44,503] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000077788.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:44,512] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000078914.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:44,657] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 41651 with 0 producer ids in 141 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:44,703] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 12ms for snapshot load and 145ms for segment recovery from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:46,127] ERROR Encountered quorum controller fault: handleCommit[baseOffset=78973]: event failed with NullPointerException (treated as UnknownServerException) at epoch 494 in 267 microseconds. The controller is already in standby mode. (org.apache.kafka.server.fault.LoggingFaultHandler)
java.lang.NullPointerException: Cannot invoke "java.lang.Integer.intValue()" because the return value of "org.apache.kafka.common.record.MemoryRecords.firstBatchSize()" is null
	at org.apache.kafka.raft.internals.RecordsIterator.createMemoryRecords(RecordsIterator.java:146) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.internals.RecordsIterator.nextBatches(RecordsIterator.java:168) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.internals.RecordsIterator.nextBatch(RecordsIterator.java:181) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.internals.RecordsIterator.hasNext(RecordsIterator.java:90) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.internals.RecordsBatchReader.nextBatch(RecordsBatchReader.java:121) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.raft.internals.RecordsBatchReader.hasNext(RecordsBatchReader.java:55) ~[kafka-raft-4.0.0.jar:?]
	at org.apache.kafka.controller.QuorumController$QuorumMetaLogListener.lambda$handleCommit$0(QuorumController.java:977) ~[kafka-metadata-4.0.0.jar:?]
	at org.apache.kafka.controller.QuorumController$QuorumMetaLogListener.lambda$appendRaftEvent$3(QuorumController.java:1115) ~[kafka-metadata-4.0.0.jar:?]
	at org.apache.kafka.controller.QuorumController$ControllerEvent.run(QuorumController.java:614) ~[kafka-metadata-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventContext.run(KafkaEventQueue.java:132) [kafka-server-common-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventHandler.handleEvents(KafkaEventQueue.java:215) [kafka-server-common-4.0.0.jar:?]
	at org.apache.kafka.queue.KafkaEventQueue$EventHandler.run(KafkaEventQueue.java:186) [kafka-server-common-4.0.0.jar:?]
	at java.base/java.lang.Thread.run(Thread.java:840) [?:?]
[2025-05-29 17:06:46,170] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 78971 with 0 producer ids in 41 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:46,183] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 78971 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:46,184] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 78971 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:46,185] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000041651.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:46,197] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=78971, file=/home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000078971.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:46,202] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 17ms for snapshot load and 0ms for segment recovery from offset 78971 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:46,315] INFO Initialized snapshots with IDs SortedSet(OffsetAndEpoch(offset=51468, epoch=142), OffsetAndEpoch(offset=58580, epoch=234), OffsetAndEpoch(offset=65880, epoch=286)) from /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-29 17:06:46,618] ERROR Encountered fatal fault: Unexpected error in raft IO thread (org.apache.kafka.server.fault.ProcessTerminatingFaultHandler)
org.apache.kafka.common.errors.CorruptRecordException: Found record size 0 smaller than minimum record overhead (14) in file /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000041651.log.
[2025-05-29 17:06:46,633] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:06:46,693] INFO [RaftManager id=1] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:46,708] INFO [RaftManager id=1] Loading snapshot (OffsetAndEpoch(offset=65880, epoch=286)) since log start offset (41651) is greater than the internal listener's next offset (-1) (org.apache.kafka.raft.internals.KRaftControlRecordStateMachine)
[2025-05-29 17:06:46,806] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-29 17:06:47,151] INFO [RaftManager id=1] Starting voters are VoterSet(voters={1=VoterNode(voterKey=ReplicaKey(id=1, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 2=VoterNode(voterKey=ReplicaKey(id=2, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 3=VoterNode(voterKey=ReplicaKey(id=3, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:47,154] INFO [RaftManager id=1] Starting request manager with static voters: [localhost:9093 (id: 1 rack: null isFenced: false), localhost:9096 (id: 2 rack: null isFenced: false), localhost:9099 (id: 3 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:47,204] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:47,205] INFO [RaftManager id=3] Cancelled in-flight BEGIN_QUORUM_EPOCH request with correlation id 70 due to node 1 being disconnected (elapsed time since creation: 271ms, elapsed time since send: 271ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:47,231] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:47,466] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:47,490] INFO [kafka-1-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:06:47,497] INFO [kafka-1-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:06:47,805] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:47,810] INFO [ControllerServer id=1] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:06:47,824] INFO [RaftManager id=1] Registered the listener org.apache.kafka.image.loader.MetadataLoader@336430407 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:47,836] INFO [ControllerServer id=1] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:06:47,915] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:47,939] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:47,945] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:48,021] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:48,123] INFO [RaftManager id=1] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@420898499 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:48,140] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:48,182] INFO [controller-1-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:48,183] INFO [controller-1-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:48,213] INFO [controller-1-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:48,216] INFO [controller-1-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:48,241] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:48,311] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:48,350] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:48,452] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:48,501] INFO [ControllerServer id=1] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:06:48,523] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:48,524] INFO [ControllerServer id=1] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:06:48,534] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:06:48,575] INFO Awaiting socket connections on 0.0.0.0:9093. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:06:48,625] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:48,725] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:05,778] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:49,956] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:49,976] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:49,991] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=494, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1111, highWatermark=Optional.empty) from FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:50,066] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,171] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,235] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=494, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=494, lastOffset=78971, preVote=true)])]) with epoch 494 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:50,275] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,372] INFO [RaftManager id=1] Insufficient remaining votes to become candidate. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}).  (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:50,373] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=494, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), electionTimeoutMs=1111, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:50,378] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,480] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,543] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=494, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), electionTimeoutMs=1111, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:50,581] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,627] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:06:50,652] INFO [ControllerServer id=3] Starting controller (kafka.server.ControllerServer)
[2025-05-29 17:06:50,689] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,690] INFO [controller-1-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:50,691] INFO [controller-1-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:50,694] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:50,696] WARN [RaftManager id=3] Detected non-monotonic update of fetch offset from nodeId ReplicaKey(id=1, directoryId=<undefined>): 78975 -> 78971 (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:06:50,708] INFO [ControllerServer id=1] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:06:50,709] INFO [ControllerServer id=1] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:06:50,709] INFO [ControllerServer id=1] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:06:50,716] INFO [ControllerServer id=1] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:06:50,717] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] maybeSendControllerRegistration: cannot register yet because the metadata.version is not known yet. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:50,731] INFO [BrokerServer id=1] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-29 17:06:50,739] INFO [BrokerServer id=1] Starting broker (kafka.server.BrokerServer)
[2025-05-29 17:06:50,795] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,800] INFO [broker-1-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:50,811] INFO [broker-1-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:50,813] INFO [broker-1-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:50,816] INFO [broker-1-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:06:50,864] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=78981, metadata=Optional.empty)] for the first time for epoch 494 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:06:50,896] INFO [MetadataLoader id=1] initializeNewPublishers: The loader is still catching up because we have loaded up to offset -1, but the high water mark is 78981 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,911] INFO [MetadataLoader id=1] handleLoadSnapshot(00000000000000065880-0000000286): incrementing HandleLoadSnapshotCount to 1. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,926] INFO [BrokerServer id=1] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:06:50,926] INFO [BrokerServer id=1] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:06:50,975] INFO [MetadataLoader id=1] handleLoadSnapshot(00000000000000065880-0000000286): generated a metadata delta between offset -1 and this snapshot in 64165 us. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:50,988] INFO [MetadataLoader id=1] maybePublishMetadata(SNAPSHOT): The loader is still catching up because we have loaded up to offset 65879, but the high water mark is 78981 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,152] INFO [broker-1-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:51,182] INFO [broker-1-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:51,244] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:06:51,410] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:06:51,719] INFO [MetadataLoader id=1] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have loaded up to offset 78980, but the high water mark is 78983 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,720] INFO [MetadataLoader id=1] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 78980, but the high water mark is 78983 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,725] INFO [MetadataLoader id=1] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 78983 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,751] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,752] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,752] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,757] INFO [ControllerServer id=1] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=78982). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-29 17:06:51,757] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,758] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,765] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=1 with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,770] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=1 with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,773] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] Found registration for 1rbNDVl3RiWZXr2z9cszsw instead of our incarnation. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:51,773] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=1 with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,786] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ScramPublisher controller id=1 with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,788] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=1 with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,791] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,793] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing AclPublisher controller id=1 with a snapshot at offset 78982 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:51,811] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=1, incarnationId=EKJnkiZ_TemMu71mUpLubw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.localdomain', port=9093, securityProtocol=1)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:52,386] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] RegistrationResponseHandler: controller acknowledged ControllerRegistrationRequest. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:53,006] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] Our registration has been persisted to the metadata log. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:06:53,393] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:06:53,629] INFO [SocketServer listenerType=BROKER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(SSL) (kafka.network.SocketServer)
[2025-05-29 17:06:53,966] INFO [broker-1-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:53,967] INFO [broker-1-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:54,298] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:54,299] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:54,376] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:54,393] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:54,394] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:54,397] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:54,411] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:54,419] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:54,499] INFO [BrokerServer id=1] Using no op persister (kafka.server.BrokerServer)
[2025-05-29 17:06:54,521] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:06:54,649] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:54,649] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:54,649] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:54,664] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:06:55,212] INFO Unable to read the broker epoch in /home/ammar/kafka_data/broker1_4.0.0. (kafka.log.LogManager)
[2025-05-29 17:06:55,248] INFO [broker-1-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:55,249] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:55,326] INFO [BrokerLifecycleManager id=1] Incarnation UUnjv1Z2TeWl8-xprPakew of broker 1 in cluster vN8K3C85SQS4roeM5v3xFg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:55,354] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-29 17:06:55,379] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:06:55,447] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:06:55,550] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-29 17:06:55,601] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU.localdomain (org.apache.kafka.metadata.ListenerInfo)
[2025-05-29 17:06:55,648] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:06:55,664] INFO [SharedServer id=3] Starting SharedServer (kafka.server.SharedServer)
[2025-05-29 17:06:55,672] INFO [BrokerServer id=1] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:06:55,681] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing MetadataVersionPublisher(id=1) with a snapshot at offset 78990 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:55,681] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 78990 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:06:55,684] INFO [BrokerServer id=1] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:06:55,684] INFO [BrokerServer id=1] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:06:55,697] INFO [BrokerMetadataPublisher id=1] Publishing initial metadata at offset OffsetAndEpoch(offset=78990, epoch=494) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-29 17:06:55,713] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:55,756] INFO Recovering 57 logs from /home/ammar/kafka_data/broker1_4.0.0 since no clean shutdown file was found (kafka.log.LogManager)
[2025-05-29 17:06:55,832] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-20. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:55,833] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,834] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,834] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,839] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,839] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,839] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,886] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-20, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=20, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 36ms (1/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:55,908] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:55,910] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,923] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,924] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,941] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,942] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,942] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:55,962] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-0, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 58ms (2/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:55,993] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-8. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,015] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,023] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,024] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,087] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 41651. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,107] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,131] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,133] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000078907.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:56,183] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,201] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,201] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,204] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-8, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=8, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 241ms (3/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:56,208] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-30. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,209] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,225] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,226] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,248] INFO [BrokerLifecycleManager id=1] Successfully registered broker 1 with broker epoch 79051 (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:56,270] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 41651 with 0 producer ids in 136 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:56,300] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 1ms for snapshot load and 146ms for segment recovery from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,393] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,393] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,394] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,425] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-30, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=30, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 220ms (4/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:56,455] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-19. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,456] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,457] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,457] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,479] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,479] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,480] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,495] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-19, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=19, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 58ms (5/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:56,524] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-47. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,525] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,525] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,526] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,532] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,539] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,540] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,559] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-47, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=47, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 63ms (6/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:56,579] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-27. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,580] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,581] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,581] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,584] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,585] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,593] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,595] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-27, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=27, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 36ms (7/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:56,600] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-28. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,613] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,613] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,613] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,615] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,616] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,616] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,638] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-28, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=28, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 42ms (8/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:56,667] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for ssl-test-topic-1. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,670] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,673] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,674] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,974] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,975] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,975] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,981] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-1, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 315ms (9/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:56,989] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-2. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:56,992] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,992] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,992] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,995] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,998] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:56,998] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,001] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-2, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 18ms (10/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,014] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-9. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,015] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,016] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,016] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,023] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,023] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,023] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,030] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-9, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=9, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 19ms (11/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,033] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-2. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,034] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,039] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,040] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,049] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,049] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,049] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,058] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-2, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 27ms (12/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,062] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-33. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,063] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,063] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,063] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,065] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,065] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,068] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,073] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-33, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=33, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 14ms (13/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,079] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-6. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,080] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,080] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,080] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,083] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,089] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,090] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,093] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-6, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=6, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 18ms (14/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,097] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for ssl-test-topic-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,098] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,099] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,099] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,145] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,145] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,146] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,148] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-0, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 55ms (15/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,162] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-18. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,163] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,163] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,163] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,166] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,166] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,167] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,181] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-18, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=18, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 33ms (16/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,239] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-16. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,249] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,249] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,250] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,643] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,643] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,643] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,645] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-16, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=16, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 418ms (17/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,659] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-49. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,660] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,661] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,661] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,676] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,676] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,677] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,679] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-49, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=49, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 33ms (18/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:57,710] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-29. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:57,712] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,727] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,727] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:57,852] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:06:57,869] INFO [ControllerServer id=2] Starting controller (kafka.server.ControllerServer)
[2025-05-29 17:06:57,967] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 79052 with 0 producer ids in 147 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:58,033] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 79052 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,034] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 79052 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,035] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000041651.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:58,064] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=79052, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000079052.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:58,082] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 48ms for snapshot load and 0ms for segment recovery from offset 79052 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,110] ERROR Encountered fatal fault: Unexpected error in raft IO thread (org.apache.kafka.server.fault.ProcessTerminatingFaultHandler)
org.apache.kafka.common.errors.CorruptRecordException: Found record size 0 smaller than minimum record overhead (14) in file /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000041651.log.
[2025-05-29 17:06:58,232] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,233] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,233] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,235] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-29, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=29, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 527ms (19/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,266] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-23. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,267] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,268] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,268] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,280] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,280] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,280] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,281] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-23, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=23, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 46ms (20/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,320] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 5. 0 recovered for __consumer_offsets-42. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,321] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 5 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,321] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 5 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,322] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42/00000000000000000007.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:58,323] INFO [ProducerStateManager partition=__consumer_offsets-42] Loading producer state from snapshot file 'SnapshotFile(offset=5, file=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42/00000000000000000005.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:58,323] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 1ms for snapshot load and 0ms for segment recovery from offset 5 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,473] INFO Initialized snapshots with IDs SortedSet(OffsetAndEpoch(offset=51509, epoch=142), OffsetAndEpoch(offset=58622, epoch=235), OffsetAndEpoch(offset=65922, epoch=287)) from /home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-29 17:06:58,530] INFO [ProducerStateManager partition=__consumer_offsets-42] Wrote producer snapshot at offset 7 with 0 producer ids in 196 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:58,546] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,546] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,547] INFO [ProducerStateManager partition=__consumer_offsets-42] Loading producer state from snapshot file 'SnapshotFile(offset=7, file=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42/00000000000000000007.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:58,548] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,550] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=42, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=7) with 2 segments, local-log-start-offset 0 and log-end-offset 7 in 268ms (21/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,565] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-36. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,566] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,567] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,579] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,581] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,581] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,582] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,584] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-36, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=36, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 32ms (22/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,598] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-17. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,599] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,610] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,611] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,613] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,615] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,616] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,618] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-17, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=17, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 33ms (23/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,634] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-5. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,636] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,637] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,637] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,639] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,640] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,640] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,653] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-5, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=5, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 35ms (24/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,657] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-45. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,668] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,668] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,668] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,688] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,688] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,688] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,701] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-45, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=45, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 47ms (25/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,716] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-12. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,717] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,717] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,717] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,735] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,735] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,736] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,738] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-12, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=12, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 36ms (26/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,751] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-37. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,752] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,753] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,754] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,768] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,768] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,769] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,771] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-37, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=37, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 33ms (27/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,783] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-26. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,784] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,784] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,785] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,788] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,799] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,799] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,802] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-26, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=26, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 30ms (28/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,817] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-44. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,819] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,831] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,832] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,834] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,835] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,835] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,826] INFO [NodeToControllerChannelManager id=1 name=registration] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,850] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-44, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=44, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 48ms (29/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,824] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,823] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,858] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 21 due to node 3 being disconnected (elapsed time since creation: 1124ms, elapsed time since send: 1122ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,858] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:06:58,859] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 49 due to node 3 being disconnected (elapsed time since creation: 746ms, elapsed time since send: 746ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,878] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:58,882] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-32. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,883] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,883] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,883] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,890] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,891] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,891] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:58,915] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,915] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,915] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,917] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-32, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=32, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 66ms (30/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,931] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-21. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,932] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,932] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,932] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,935] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,935] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,935] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,937] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-21, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=21, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 19ms (31/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,950] INFO [RaftManager id=3] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:58,954] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-24. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,955] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,955] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,955] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,957] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,957] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,957] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,959] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-24, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=24, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 21ms (32/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,969] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:58,971] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,972] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:58,972] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-38. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,972] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:58,972] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,972] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,973] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,974] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,974] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,975] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,980] INFO [RaftManager id=3] Loading snapshot (OffsetAndEpoch(offset=65922, epoch=287)) since log start offset (41651) is greater than the internal listener's next offset (-1) (org.apache.kafka.raft.internals.KRaftControlRecordStateMachine)
[2025-05-29 17:06:58,981] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-38, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=38, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 17ms (33/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:58,989] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-14. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:58,989] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,990] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,990] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,991] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,992] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,992] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:58,993] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-14, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=14, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (34/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,026] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,046] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-41. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,060] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,061] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,061] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,062] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,062] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,063] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,064] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,064] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,075] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,077] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-41, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=41, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 83ms (35/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,080] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-1. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,081] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,090] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,124] WARN [RaftManager id=1] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,120] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,092] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,132] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,134] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,134] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,134] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,156] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,156] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,157] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,187] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-1, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 109ms (36/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,209] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,211] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,211] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,212] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,216] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-34. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,217] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,217] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,217] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,249] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,249] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,249] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,260] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,260] WARN [RaftManager id=1] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,264] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,267] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-34, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=34, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 74ms (37/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,268] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,268] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,280] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,283] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-11. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,298] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,298] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,299] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,301] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,301] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,301] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,315] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-11, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=11, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 46ms (38/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,325] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,327] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,327] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,328] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,328] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-48. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,330] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,330] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,330] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,332] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,332] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,333] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,334] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-48, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=48, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 19ms (39/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,342] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-25. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,343] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,343] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,343] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,345] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,345] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,345] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,348] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-25, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=25, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 13ms (40/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,365] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-43. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,366] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,366] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,366] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,369] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,370] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,370] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,387] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-43, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=43, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 24ms (41/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,393] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,394] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,395] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,395] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,403] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-10. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,404] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,404] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,404] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,406] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,407] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,417] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 10ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,420] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-10, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=10, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 33ms (42/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,437] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-31. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,437] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,437] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,438] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,445] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,447] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,447] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,447] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,451] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,452] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,452] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,455] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-31, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=31, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 33ms (43/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,469] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 1. 0 recovered for test-topic-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,471] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,481] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,482] INFO [ProducerStateManager partition=test-topic-0] Loading producer state from snapshot file 'SnapshotFile(offset=1, file=/home/ammar/kafka_data/broker1_4.0.0/test-topic-0/00000000000000000001.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:59,482] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,484] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,485] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,497] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/test-topic-0/00000000000000000001.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:59,505] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,509] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 24ms for snapshot load and 0ms for segment recovery from offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,513] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,513] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,514] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,524] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/test-topic-0, topicId=5IOimlizQSmAmZHYHObOxA, topic=test-topic, partition=0, highWatermark=1, lastStableOffset=1, logStartOffset=1, logEndOffset=1) with 1 segments, local-log-start-offset 1 and log-end-offset 1 in 69ms (44/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,532] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,533] WARN [RaftManager id=1] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,542] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-15. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,544] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,545] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,545] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,561] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,562] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,562] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,564] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,637] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,637] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,638] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,621] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:59,639] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=494, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1205, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=494, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:59,565] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-15, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=15, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 40ms (45/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,656] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-13. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,656] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,657] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,657] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,659] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,659] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,659] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,671] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-13, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=13, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 25ms (46/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,674] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 2. 0 recovered for ssl-test-topic-2. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,675] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,675] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,675] INFO [ProducerStateManager partition=ssl-test-topic-2] Loading producer state from snapshot file 'SnapshotFile(offset=2, file=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-2/00000000000000000002.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:06:59,676] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 1ms for snapshot load and 0ms for segment recovery from offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,679] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,679] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,680] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-2/00000000000000000002.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:06:59,680] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 1ms for snapshot load and 0ms for segment recovery from offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,684] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-2, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=2, highWatermark=2, lastStableOffset=2, logStartOffset=2, logEndOffset=2) with 1 segments, local-log-start-offset 2 and log-end-offset 2 in 12ms (47/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,693] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-22. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,694] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,694] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,694] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,698] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,698] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,698] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,701] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-22, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=22, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 16ms (48/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,703] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,704] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,704] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,704] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,705] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,705] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,705] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,710] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,714] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-0, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (49/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:06:59,721] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=494, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=494, lastOffset=79056, preVote=true)])]) with epoch 494 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:06:59,729] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-4. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:06:59,737] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,738] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,738] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:06:59,740] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=495, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)], electionTimeoutMs=1568) from ProspectiveState(epoch=494, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1205, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:06:59,726] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,741] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,741] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,784] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,786] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,786] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,786] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,836] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,844] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,844] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,844] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,900] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,903] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,903] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,903] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,958] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:06:59,970] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,970] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:06:59,971] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:00,021] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:00,022] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,022] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,023] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:00,028] INFO [RaftManager id=3] Starting voters are VoterSet(voters={1=VoterNode(voterKey=ReplicaKey(id=1, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 2=VoterNode(voterKey=ReplicaKey(id=2, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 3=VoterNode(voterKey=ReplicaKey(id=3, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:00,057] INFO [RaftManager id=3] Starting request manager with static voters: [localhost:9093 (id: 1 rack: null isFenced: false), localhost:9096 (id: 2 rack: null isFenced: false), localhost:9099 (id: 3 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:00,082] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:00,099] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,099] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,099] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:00,120] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=495, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)], electionTimeoutMs=1568) from ProspectiveState(epoch=494, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1205, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:00,124] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,124] WARN [RaftManager id=1] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,129] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,129] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,129] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,135] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-4, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=4, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 421ms (50/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,138] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-46. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:00,139] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,139] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,140] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,145] INFO [RaftManager id=3] Attempting durable transition to ResignedState(localId=3, epoch=494, voters=[1, 2, 3], electionTimeoutMs=1468, unackedVoters=[1, 2], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:00,156] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=495, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=494, lastOffset=79056, preVote=false)])]) with epoch 495 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:00,486] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,486] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,486] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,492] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-46, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=46, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 356ms (51/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,515] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-40. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:00,530] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,531] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,531] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,535] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,535] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,535] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,537] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-40, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=40, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 43ms (52/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,560] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-3. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:00,562] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,562] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,572] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 10ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,591] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,591] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,591] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,593] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-3, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=3, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 55ms (53/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,602] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-35. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:00,603] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,603] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,604] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,617] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,621] WARN [RaftManager id=1] Connection to node 3 (localhost/127.0.0.1:9099) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:00,626] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,626] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,626] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,630] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-35, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=35, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 35ms (54/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,651] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=494, voters=[1, 2, 3], electionTimeoutMs=1468, unackedVoters=[1, 2], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:00,681] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-39. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:00,681] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,682] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,682] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,695] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,696] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,696] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,698] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-39, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=39, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 66ms (55/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,709] INFO [kafka-3-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:07:00,712] INFO [kafka-3-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:07:00,730] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-1. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:00,745] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,745] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,745] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,759] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,760] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,760] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,762] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-1, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 64ms (56/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,777] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 0. 0 recovered for __consumer_offsets-7. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:00,778] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,778] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,778] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,795] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,806] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,806] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:00,808] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-7, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=7, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 46ms (57/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:00,832] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=495, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=494, lastOffset=79056, preVote=true)])]) with epoch 495 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:00,875] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:00,878] INFO [ControllerServer id=3] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:07:00,879] INFO [ControllerServer id=3] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:07:00,881] INFO [RaftManager id=3] Registered the listener org.apache.kafka.image.loader.MetadataLoader@2031316625 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:00,894] INFO Loaded 57 logs in 5114ms (unclean log dirs = ArrayBuffer(/home/ammar/kafka_data/broker1_4.0.0)) (kafka.log.LogManager)
[2025-05-29 17:07:00,924] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-29 17:07:00,925] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-29 17:07:00,997] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,048] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=262, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=495, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)], electionTimeoutMs=1568) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:01,055] INFO [RaftManager id=3] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@2090163670 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:01,092] INFO [controller-3-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:01,099] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,126] INFO [controller-3-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:01,141] INFO [controller-3-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:01,151] INFO [controller-3-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:01,200] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,206] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=262, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=495, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)], electionTimeoutMs=1568) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:01,208] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1180, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) from UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=262, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:01,302] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,310] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:01,331] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1180, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) from UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=262, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:01,331] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=496, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=494, lastOffset=79056, preVote=false)])]) with epoch 496 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:01,393] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:07:01,403] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,459] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:07:01,463] INFO [AddPartitionsToTxnSenderThread-1]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:07:01,465] INFO [GroupCoordinator id=1] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:07:01,496] INFO [GroupCoordinator id=1] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:07:01,511] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,540] INFO [TransactionCoordinator id=1] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:07:01,591] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=495, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=494, voters=[1, 2, 3], electionTimeoutMs=1468, unackedVoters=[1, 2], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:01,608] INFO [TxnMarkerSenderThread-1]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:07:01,621] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,638] INFO [TransactionCoordinator id=1] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:07:01,683] INFO [ControllerServer id=3] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:07:01,683] INFO [ControllerServer id=3] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:07:01,698] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:07:01,707] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(__consumer_offsets-13, __consumer_offsets-46, __consumer_offsets-9, __consumer_offsets-42, __consumer_offsets-21, __consumer_offsets-17, ssl-test-topic-0, __consumer_offsets-30, __consumer_offsets-26, __consumer_offsets-5, __consumer_offsets-38, __consumer_offsets-1, __consumer_offsets-34, __consumer_offsets-16, __consumer_offsets-45, __consumer_offsets-12, __consumer_offsets-41, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-49, __consumer_offsets-0, ssl-test-topic-1, __consumer_offsets-29, __consumer_offsets-25, __consumer_offsets-8, __consumer_offsets-37, __consumer_offsets-4, __consumer_offsets-33, __consumer_offsets-15, __consumer_offsets-48, __consumer_offsets-11, __consumer_offsets-44, __consumer_offsets-23, __consumer_offsets-19, ssl-test-topic-2, __consumer_offsets-32, test-topic-0, __consumer_offsets-28, __consumer_offsets-7, __consumer_offsets-40, __consumer_offsets-3, __consumer_offsets-36, __consumer_offsets-47, __consumer_offsets-14, __consumer_offsets-43, __consumer_offsets-10, __consumer_offsets-22, __consumer_offsets-18, __consumer_offsets-31, __consumer_offsets-27, __consumer_offsets-39, __consumer_offsets-6, __consumer_offsets-35, __consumer_offsets-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:01,683] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,748] INFO Awaiting socket connections on 0.0.0.0:9099. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:07:01,813] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:01,830] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=496, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1180, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:01,862] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=495, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=494, voters=[1, 2, 3], electionTimeoutMs=1468, unackedVoters=[1, 2], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:01,873] INFO [Partition __consumer_offsets-13 broker=1] Log loaded for partition __consumer_offsets-13 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:01,916] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,021] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=495, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1322, highWatermark=Optional.empty) from UnattachedState(epoch=495, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:02,037] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,138] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,177] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=496, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=496, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1180, highWatermark=Optional[LogOffsetMetadata(offset=79055, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:02,257] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,241] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:02,294] INFO [Partition __consumer_offsets-46 broker=1] Log loaded for partition __consumer_offsets-46 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:02,362] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,463] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,547] INFO [Partition __consumer_offsets-9 broker=1] Log loaded for partition __consumer_offsets-9 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:02,549] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:02,579] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:02,580] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:02,630] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,731] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,806] INFO [Partition __consumer_offsets-42 broker=1] Log loaded for partition __consumer_offsets-42 with initial high watermark 7 (kafka.cluster.Partition)
[2025-05-29 17:07:02,835] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:02,918] INFO [Partition __consumer_offsets-21 broker=1] Log loaded for partition __consumer_offsets-21 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:02,936] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,021] INFO [controller-3-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:03,036] INFO [ControllerRegistrationManager id=3 incarnation=J103IVSSQemwcm6-ue8DJw] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:03,037] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,037] INFO [ControllerRegistrationManager id=3 incarnation=J103IVSSQemwcm6-ue8DJw] maybeSendControllerRegistration: cannot register yet because the metadata.version is not known yet. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:03,042] INFO [ControllerServer id=3] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:07:03,043] INFO [ControllerServer id=3] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:07:03,043] INFO [ControllerServer id=3] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:07:03,043] INFO [ControllerServer id=3] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:07:03,045] INFO [BrokerServer id=3] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-29 17:07:03,046] INFO [BrokerServer id=3] Starting broker (kafka.server.BrokerServer)
[2025-05-29 17:07:03,087] INFO [broker-3-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:03,089] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:07:03,101] INFO [broker-3-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:03,102] INFO [broker-3-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:03,113] INFO [broker-3-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:03,147] INFO [Partition __consumer_offsets-17 broker=1] Log loaded for partition __consumer_offsets-17 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:03,152] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,254] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,256] INFO [RaftManager id=3] Election timed out before receiving sufficient vote responses to become candidate. Current epoch election state: EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:03,257] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=495, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) from ProspectiveState(epoch=495, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1322, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:03,268] INFO [Partition ssl-test-topic-0 broker=1] Log loaded for partition ssl-test-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:03,322] INFO [BrokerServer id=3] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:07:03,322] INFO [BrokerServer id=3] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:07:03,357] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,451] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=495, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) from ProspectiveState(epoch=495, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1322, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:03,452] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=495, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1711, highWatermark=Optional.empty) from UnattachedState(epoch=495, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:03,458] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=496, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=495, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1711, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:03,458] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,506] INFO [Partition __consumer_offsets-30 broker=1] Log loaded for partition __consumer_offsets-30 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:03,559] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,628] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=496, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=495, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1711, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:03,653] INFO [controller-3-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:03,655] INFO [Partition __consumer_offsets-26 broker=1] Log loaded for partition __consumer_offsets-26 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:03,672] INFO [broker-3-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:03,673] INFO [broker-3-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:03,678] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,762] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:07:03,797] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,840] INFO [Partition __consumer_offsets-5 broker=1] Log loaded for partition __consumer_offsets-5 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:03,898] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:03,923] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:07:04,022] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,036] INFO [Partition __consumer_offsets-38 broker=1] Log loaded for partition __consumer_offsets-38 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:04,125] INFO [MetadataLoader id=3] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,207] INFO [Partition __consumer_offsets-1 broker=1] Log loaded for partition __consumer_offsets-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:04,211] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=79058, metadata=Optional.empty)] for the first time for epoch 496 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:07:04,227] INFO [MetadataLoader id=3] initializeNewPublishers: The loader is still catching up because we have loaded up to offset -1, but the high water mark is 79058 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,230] INFO [MetadataLoader id=3] handleLoadSnapshot(00000000000000065922-0000000287): incrementing HandleLoadSnapshotCount to 1. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,296] INFO [MetadataLoader id=3] handleLoadSnapshot(00000000000000065922-0000000287): generated a metadata delta between offset -1 and this snapshot in 65058 us. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,297] INFO [MetadataLoader id=3] maybePublishMetadata(SNAPSHOT): The loader is still catching up because we have loaded up to offset 65921, but the high water mark is 79058 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,444] INFO [Partition __consumer_offsets-34 broker=1] Log loaded for partition __consumer_offsets-34 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:04,573] INFO [Partition __consumer_offsets-16 broker=1] Log loaded for partition __consumer_offsets-16 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:04,729] INFO [Partition __consumer_offsets-45 broker=1] Log loaded for partition __consumer_offsets-45 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:04,914] INFO [MetadataLoader id=3] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have loaded up to offset 79057, but the high water mark is 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,914] INFO [MetadataLoader id=3] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 79057, but the high water mark is 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,931] INFO [Partition __consumer_offsets-12 broker=1] Log loaded for partition __consumer_offsets-12 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:04,956] INFO [MetadataLoader id=3] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 79060 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,990] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,991] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:04,991] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,009] INFO [ControllerServer id=3] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=79059). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-29 17:07:05,009] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,036] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,039] INFO [ControllerRegistrationManager id=3 incarnation=J103IVSSQemwcm6-ue8DJw] Found registration for cYyHV0aqR_yCWowgJde4Aw instead of our incarnation. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:05,052] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=3 with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,085] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=3 with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,132] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=3 with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,133] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ScramPublisher controller id=3 with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,164] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=3 with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,168] INFO [Partition __consumer_offsets-41 broker=1] Log loaded for partition __consumer_offsets-41 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:05,179] INFO [ControllerRegistrationManager id=3 incarnation=J103IVSSQemwcm6-ue8DJw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=3, incarnationId=J103IVSSQemwcm6-ue8DJw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.localdomain', port=9099, securityProtocol=1)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:05,195] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,197] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing AclPublisher controller id=3 with a snapshot at offset 79059 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:05,326] INFO [SocketServer listenerType=BROKER, nodeId=3] Created data-plane acceptor and processors for endpoint : ListenerName(SSL) (kafka.network.SocketServer)
[2025-05-29 17:07:05,389] INFO [Partition __consumer_offsets-24 broker=1] Log loaded for partition __consumer_offsets-24 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:05,453] INFO [broker-3-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:05,455] INFO [broker-3-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:05,603] INFO [Partition __consumer_offsets-20 broker=1] Log loaded for partition __consumer_offsets-20 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:05,715] INFO [ControllerRegistrationManager id=3 incarnation=J103IVSSQemwcm6-ue8DJw] RegistrationResponseHandler: controller acknowledged ControllerRegistrationRequest. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:05,730] INFO [Partition __consumer_offsets-49 broker=1] Log loaded for partition __consumer_offsets-49 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:05,823] INFO [broker-3-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:05,824] INFO [broker-3-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:05,887] INFO [ControllerRegistrationManager id=3 incarnation=J103IVSSQemwcm6-ue8DJw] Our registration has been persisted to the metadata log. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:05,888] INFO [Partition __consumer_offsets-0 broker=1] Log loaded for partition __consumer_offsets-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:05,922] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:05,924] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:05,926] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:05,928] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:05,943] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:05,946] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:05,972] INFO [Partition ssl-test-topic-1 broker=1] Log loaded for partition ssl-test-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,028] INFO [BrokerServer id=3] Using no op persister (kafka.server.BrokerServer)
[2025-05-29 17:07:06,032] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:07:06,075] INFO [Partition __consumer_offsets-29 broker=1] Log loaded for partition __consumer_offsets-29 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,144] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:06,144] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:06,144] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:06,146] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:06,199] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-29 17:07:06,229] INFO [Partition __consumer_offsets-25 broker=1] Log loaded for partition __consumer_offsets-25 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,250] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU.localdomain (org.apache.kafka.metadata.ListenerInfo)
[2025-05-29 17:07:06,299] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:07:06,314] INFO [SharedServer id=2] Starting SharedServer (kafka.server.SharedServer)
[2025-05-29 17:07:06,376] INFO [Partition __consumer_offsets-8 broker=1] Log loaded for partition __consumer_offsets-8 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,489] INFO [Partition __consumer_offsets-37 broker=1] Log loaded for partition __consumer_offsets-37 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,511] INFO Unable to read the broker epoch in /home/ammar/kafka_data/broker3_4.0.0. (kafka.log.LogManager)
[2025-05-29 17:07:06,531] INFO [broker-3-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:06,534] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:06,569] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:07:06,569] INFO [Partition __consumer_offsets-4 broker=1] Log loaded for partition __consumer_offsets-4 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,579] INFO [BrokerLifecycleManager id=3] Incarnation aFQwZgANSLeTilliwmmGsw of broker 3 in cluster vN8K3C85SQS4roeM5v3xFg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:06,599] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:06,724] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:06,751] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing MetadataVersionPublisher(id=3) with a snapshot at offset 79063 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:06,752] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 79063 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:06,754] INFO [BrokerMetadataPublisher id=3] Publishing initial metadata at offset OffsetAndEpoch(offset=79063, epoch=496) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-29 17:07:06,762] INFO [BrokerServer id=3] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:07:06,763] INFO [BrokerServer id=3] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:07:06,763] INFO [BrokerServer id=3] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:07:06,769] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:06,780] INFO Recovering 3 logs from /home/ammar/kafka_data/broker3_4.0.0 since no clean shutdown file was found (kafka.log.LogManager)
[2025-05-29 17:07:06,794] INFO [Partition __consumer_offsets-33 broker=1] Log loaded for partition __consumer_offsets-33 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,841] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-2. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:06,844] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,844] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,845] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,847] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Recovering unflushed segment 41651. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:06,859] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,860] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,860] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,865] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,878] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:06,874] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,900] INFO [Partition __consumer_offsets-15 broker=1] Log loaded for partition __consumer_offsets-15 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:06,895] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000077921.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:07:06,901] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000078675.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:07:06,945] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker3_4.0.0/my-topic-2, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 66ms (1/3 completed in /home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:06,962] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:06,977] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,978] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,978] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,991] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,991] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,991] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:06,995] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker3_4.0.0/my-topic-0, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 37ms (2/3 completed in /home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:07,008] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-1. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:07,009] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:07,009] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:07,010] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:07,038] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:07,038] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:07,038] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:07,046] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker3_4.0.0/my-topic-1, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 51ms (3/3 completed in /home/ammar/kafka_data/broker3_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:07,047] INFO [Partition __consumer_offsets-48 broker=1] Log loaded for partition __consumer_offsets-48 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:07,084] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 41651 with 0 producer ids in 156 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:07:07,106] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:07,128] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 35ms for snapshot load and 162ms for segment recovery from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:07,130] INFO Loaded 3 logs in 294ms (unclean log dirs = ArrayBuffer(/home/ammar/kafka_data/broker3_4.0.0)) (kafka.log.LogManager)
[2025-05-29 17:07:07,148] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-29 17:07:07,155] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-29 17:07:07,236] INFO [Partition __consumer_offsets-11 broker=1] Log loaded for partition __consumer_offsets-11 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:07,508] INFO [Partition __consumer_offsets-44 broker=1] Log loaded for partition __consumer_offsets-44 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:07,517] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:07,671] INFO [Partition __consumer_offsets-23 broker=1] Log loaded for partition __consumer_offsets-23 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:07,738] INFO [Partition __consumer_offsets-19 broker=1] Log loaded for partition __consumer_offsets-19 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:07,836] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:07:07,863] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:07:07,867] INFO [AddPartitionsToTxnSenderThread-3]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:07:07,877] INFO [GroupCoordinator id=3] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:07:07,879] INFO [GroupCoordinator id=3] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:07:07,881] INFO [TransactionCoordinator id=3] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:07:07,884] INFO [TxnMarkerSenderThread-3]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:07:07,895] INFO [TransactionCoordinator id=3] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:07:07,911] INFO [Partition ssl-test-topic-2 broker=1] Log loaded for partition ssl-test-topic-2 with initial high watermark 2 (kafka.cluster.Partition)
[2025-05-29 17:07:08,031] INFO [Partition my-topic-0 broker=3] Log loaded for partition my-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:08,062] INFO [Partition __consumer_offsets-32 broker=1] Log loaded for partition __consumer_offsets-32 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:08,095] INFO [Partition my-topic-1 broker=3] Log loaded for partition my-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:08,106] INFO [Partition my-topic-2 broker=3] Log loaded for partition my-topic-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:08,117] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:08,235] INFO [Partition test-topic-0 broker=1] Log loaded for partition test-topic-0 with initial high watermark 1 (kafka.cluster.Partition)
[2025-05-29 17:07:08,332] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:08,464] INFO [ReplicaFetcherThread-0-2]: Starting (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:08,479] INFO [ReplicaFetcherManager on broker 3] Added fetcher to broker 2 for partitions HashMap(my-topic-0 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),19,0), my-topic-1 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),17,0), my-topic-2 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),18,0)) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:08,496] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Truncating partition my-topic-0 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:08,531] INFO [UnifiedLog partition=my-topic-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:07:08,545] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Truncating partition my-topic-1 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:08,573] INFO [UnifiedLog partition=my-topic-1, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:07:08,573] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Truncating partition my-topic-2 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:08,574] INFO [UnifiedLog partition=my-topic-2, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:07:08,663] INFO [DynamicConfigPublisher broker id=3] Updating topic __consumer_offsets with new configuration : compression.type -> producer,cleanup.policy -> compact,segment.bytes -> 104857600 (kafka.server.metadata.DynamicConfigPublisher)
[2025-05-29 17:07:08,713] INFO [MetadataLoader id=3] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=3) with a snapshot at offset 79063 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:08,727] INFO [Partition __consumer_offsets-28 broker=1] Log loaded for partition __consumer_offsets-28 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:08,804] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 79065 with 0 producer ids in 78 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:07:08,825] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 79065 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:08,826] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 79065 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:08,827] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000041651.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:07:08,837] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=79065, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000079065.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:07:08,842] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 15ms for snapshot load and 0ms for segment recovery from offset 79065 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:08,867] INFO [Partition __consumer_offsets-7 broker=1] Log loaded for partition __consumer_offsets-7 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:09,016] INFO [Partition __consumer_offsets-40 broker=1] Log loaded for partition __consumer_offsets-40 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:09,029] INFO Initialized snapshots with IDs SortedSet(OffsetAndEpoch(offset=51489, epoch=142), OffsetAndEpoch(offset=58601, epoch=234), OffsetAndEpoch(offset=65900, epoch=286)) from /home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-29 17:07:09,079] INFO [Partition __consumer_offsets-3 broker=1] Log loaded for partition __consumer_offsets-3 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:09,235] INFO [Partition __consumer_offsets-36 broker=1] Log loaded for partition __consumer_offsets-36 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:09,328] INFO [Partition __consumer_offsets-47 broker=1] Log loaded for partition __consumer_offsets-47 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:09,361] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:07:09,407] INFO [Partition __consumer_offsets-14 broker=1] Log loaded for partition __consumer_offsets-14 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:09,446] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,446] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,459] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Cancelled in-flight FETCH request with correlation id 0 due to node 2 being disconnected (elapsed time since creation: 757ms, elapsed time since send: 757ms, throttle time: 0ms, request timeout: 30000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,460] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,447] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,461] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 230 due to node 2 being disconnected (elapsed time since creation: 689ms, elapsed time since send: 689ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,461] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,458] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,462] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 61 due to node 2 being disconnected (elapsed time since creation: 807ms, elapsed time since send: 802ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,449] INFO [NodeToControllerChannelManager id=3 name=registration] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,455] INFO [RaftManager id=2] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:09,450] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,470] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 20 due to node 2 being disconnected (elapsed time since creation: 783ms, elapsed time since send: 782ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,485] INFO [RaftManager id=2] Loading snapshot (OffsetAndEpoch(offset=65900, epoch=286)) since log start offset (41651) is greater than the internal listener's next offset (-1) (org.apache.kafka.raft.internals.KRaftControlRecordStateMachine)
[2025-05-29 17:07:09,460] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:111) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:112) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:09,497] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,505] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,505] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,505] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,556] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,554] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:111) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:112) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:09,557] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,571] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,572] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,614] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,617] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,618] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,628] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,669] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,670] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,670] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,671] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,692] INFO [RaftManager id=3] Hostname for node 2 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:07:09,696] INFO [RaftManager id=1] Hostname for node 2 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:07:09,722] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,723] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,724] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,724] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,754] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,755] WARN [RaftManager id=1] Connection to node 2 (DESKTOP-T3O0CHU.localdomain/127.0.1.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,779] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,779] WARN [RaftManager id=3] Connection to node 2 (DESKTOP-T3O0CHU.localdomain/127.0.1.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,774] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,790] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,790] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,790] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,845] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,850] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,851] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,851] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,861] INFO [Partition __consumer_offsets-43 broker=1] Log loaded for partition __consumer_offsets-43 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:09,869] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,871] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,871] WARN [RaftManager id=1] Connection to node 2 (DESKTOP-T3O0CHU.localdomain/127.0.1.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,880] WARN [RaftManager id=3] Connection to node 2 (DESKTOP-T3O0CHU.localdomain/127.0.1.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,901] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,909] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,930] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,930] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,931] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,931] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,931] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,965] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,978] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,978] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,979] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,982] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:09,984] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,984] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:09,984] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,016] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,017] WARN [RaftManager id=1] Connection to node 2 (DESKTOP-T3O0CHU.localdomain/127.0.1.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,030] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,032] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,032] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,033] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,035] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,047] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,047] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,048] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,077] INFO [Partition __consumer_offsets-10 broker=1] Log loaded for partition __consumer_offsets-10 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:10,083] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,085] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,094] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,094] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,094] WARN [RaftManager id=3] Connection to node 2 (DESKTOP-T3O0CHU.localdomain/127.0.1.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,094] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,098] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,106] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,106] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,110] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,143] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,152] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,153] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,154] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,157] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,159] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,159] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,160] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,190] INFO [RaftManager id=2] Starting voters are VoterSet(voters={1=VoterNode(voterKey=ReplicaKey(id=1, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 2=VoterNode(voterKey=ReplicaKey(id=2, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 3=VoterNode(voterKey=ReplicaKey(id=3, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:10,208] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,208] INFO [RaftManager id=2] Starting request manager with static voters: [localhost:9093 (id: 1 rack: null isFenced: false), localhost:9096 (id: 2 rack: null isFenced: false), localhost:9099 (id: 3 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:10,209] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,211] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,211] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,212] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,224] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,224] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,225] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,262] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,263] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,264] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,264] WARN [RaftManager id=1] Connection to node 2 (DESKTOP-T3O0CHU.localdomain/127.0.1.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,264] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,265] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,276] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,279] INFO [Partition __consumer_offsets-22 broker=1] Log loaded for partition __consumer_offsets-22 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:10,282] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:10,283] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=496, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=496, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,299] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,299] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,299] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,304] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:10,322] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=496, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1095, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=496, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,327] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,330] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,330] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,331] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,357] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,383] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,383] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,383] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,367] INFO [RaftManager id=2] Attempting durable transition to ResignedState(localId=2, epoch=496, voters=[1, 2, 3], electionTimeoutMs=1417, unackedVoters=[1, 3], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,395] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,397] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,411] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=496, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=496, lastOffset=79069, preVote=true)])]) with epoch 496 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:10,424] INFO [Partition __consumer_offsets-18 broker=1] Log loaded for partition __consumer_offsets-18 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:10,434] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,397] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,437] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,438] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,438] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,438] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,454] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,455] INFO [RaftManager id=3] Hostname for node 2 changed from DESKTOP-T3O0CHU.localdomain to localhost. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:07:10,466] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,467] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,467] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,471] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=497, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], electionTimeoutMs=1427) from ProspectiveState(epoch=496, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,489] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,489] WARN [RaftManager id=3] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,490] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,491] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,491] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,492] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,526] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,528] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,529] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,529] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,542] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,544] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,544] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,544] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,575] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,597] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,601] WARN [RaftManager id=3] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,602] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,588] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,582] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,603] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,603] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,609] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,609] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,604] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:10,636] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:10,610] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,637] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,638] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,652] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,655] INFO [Partition __consumer_offsets-31 broker=1] Log loaded for partition __consumer_offsets-31 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:10,655] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,655] WARN [NodeToControllerChannelManager id=1 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,655] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,661] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,664] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,664] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,664] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,668] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=497, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], electionTimeoutMs=1427) from ProspectiveState(epoch=496, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,668] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=496, voters=[1, 2, 3], electionTimeoutMs=1417, unackedVoters=[1, 3], preferredSuccessors=[]) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,689] INFO [RaftManager id=1] Hostname for node 2 changed from DESKTOP-T3O0CHU.localdomain to localhost. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:07:10,692] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,692] WARN [RaftManager id=1] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,692] INFO [kafka-2-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:07:10,693] INFO [kafka-2-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:07:10,694] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,694] WARN [RaftManager id=3] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,695] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=710, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) from ProspectiveState(epoch=496, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1095, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,721] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,725] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,726] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,728] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,776] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,778] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,778] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,778] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,779] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,779] WARN [RaftManager id=1] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,818] INFO [Partition __consumer_offsets-27 broker=1] Log loaded for partition __consumer_offsets-27 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:10,830] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,844] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,844] WARN [NodeToControllerChannelManager id=3 name=heartbeat] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,844] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:10,848] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:10,859] INFO [RaftManager id=2] Registered the listener org.apache.kafka.image.loader.MetadataLoader@2145883630 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:10,862] INFO [ControllerServer id=2] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:07:10,879] INFO [ControllerServer id=2] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:07:10,863] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=710, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) from ProspectiveState(epoch=496, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1095, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,882] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1902, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) from UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=710, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,927] INFO [Partition __consumer_offsets-39 broker=1] Log loaded for partition __consumer_offsets-39 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:10,931] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,931] WARN [RaftManager id=1] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:10,953] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:10,993] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1902, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) from UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=710, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:10,994] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=497, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=496, lastOffset=79069, preVote=false)])]) with epoch 497 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:11,014] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,015] WARN [RaftManager id=3] Connection to node 2 (localhost/127.0.0.1:9096) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,030] INFO [RaftManager id=2] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@1477392133 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:11,041] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=497, epochStartOffset=79069, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=497, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], electionTimeoutMs=1427) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:11,047] INFO [controller-2-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:11,050] INFO [controller-2-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:11,058] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,073] INFO [controller-2-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:11,077] INFO [Partition __consumer_offsets-6 broker=1] Log loaded for partition __consumer_offsets-6 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:11,083] INFO [controller-2-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:11,141] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=497, epochStartOffset=79069, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=497, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], electionTimeoutMs=1427) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:11,166] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,170] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:11,188] INFO [Partition __consumer_offsets-35 broker=1] Log loaded for partition __consumer_offsets-35 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:11,234] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,271] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,278] INFO [ControllerServer id=2] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:07:11,279] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,280] INFO [ControllerServer id=2] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:07:11,281] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:07:11,294] INFO Awaiting socket connections on 0.0.0.0:9096. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:07:11,380] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,413] INFO [Partition __consumer_offsets-2 broker=1] Log loaded for partition __consumer_offsets-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:11,481] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,482] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=497, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1902, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:11,481] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=272, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=78990, wantFence=true, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=272, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:35412-2-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@254c2121]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:07:11,512] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,515] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,519] INFO [Partition my-topic-0 broker=1] Log loaded for partition my-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:11,567] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=497, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1902, highWatermark=Optional[LogOffsetMetadata(offset=79068, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:11,585] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,617] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,643] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,644] INFO [Partition my-topic-1 broker=1] Log loaded for partition my-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:11,655] INFO [Partition my-topic-2 broker=1] Log loaded for partition my-topic-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:11,657] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:11,676] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,689] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,689] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,690] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:11,690] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:11,691] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,742] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=496, voters=[1, 2, 3], electionTimeoutMs=1417, unackedVoters=[1, 3], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:11,809] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:11,900] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=275, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=78990, wantFence=true, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=275, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:35424-0-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2033836c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:07:11,909] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,924] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,926] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=496, voters=[1, 2, 3], electionTimeoutMs=1417, unackedVoters=[1, 3], preferredSuccessors=[]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:11,931] INFO [ControllerServer id=2] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:07:11,931] INFO [ControllerServer id=2] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:07:11,946] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:11,947] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,975] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,931] INFO [ControllerServer id=2] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:07:11,987] INFO [ControllerServer id=2] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:07:11,989] INFO [BrokerServer id=2] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-29 17:07:11,959] INFO [ControllerRegistrationManager id=2 incarnation=7l6nTrM3Q0SV1pN5feY6fQ] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:11,942] INFO [controller-2-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:11,941] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,005] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:12,005] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=497, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1752, highWatermark=Optional.empty) from UnattachedState(epoch=497, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=0, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:12,017] INFO [BrokerServer id=2] Starting broker (kafka.server.BrokerServer)
[2025-05-29 17:07:12,031] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=79070, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2656480)]) for the first time for epoch 497 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79070, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2656480)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79070, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2656480)])], lastFetchTimestamp=1748527632029, lastCaughtUpTimestamp=1748527632029, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:07:12,076] INFO [ControllerRegistrationManager id=2 incarnation=7l6nTrM3Q0SV1pN5feY6fQ] maybeSendControllerRegistration: cannot register yet because the metadata.version is not known yet. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:12,106] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,130] INFO [broker-2-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:12,137] INFO [broker-2-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:12,138] INFO [broker-2-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:12,150] INFO [broker-2-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:07:12,209] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,313] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,314] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:12,361] INFO [BrokerServer id=2] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:07:12,361] INFO [BrokerServer id=2] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:07:12,419] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,437] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=497, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=496, lastOffset=79065, preVote=true)])]) with epoch 497 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:12,451] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=497, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=497, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1752, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:12,467] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=497, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=496, lastOffset=79065, preVote=true)])]) with epoch 497 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:07:12,502] INFO [ReplicaFetcherManager on broker 1] Added fetcher to broker 2 for partitions HashMap(my-topic-0 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),19,0), my-topic-1 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),17,0), my-topic-2 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=2, host=172.23.38.230:9095),18,0)) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:12,526] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,533] INFO [ReplicaFetcherThread-0-2]: Starting (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:12,564] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Truncating partition my-topic-0 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:12,591] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=497, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=497, leaderId=OptionalInt.empty, retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1752, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:07:12,607] INFO [UnifiedLog partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:07:12,609] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Truncating partition my-topic-1 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:12,609] INFO [UnifiedLog partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:07:12,609] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Truncating partition my-topic-2 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:07:12,609] INFO [UnifiedLog partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:07:12,612] INFO [controller-2-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:12,630] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,706] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:12,706] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:12,707] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:12,732] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,707] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:12,733] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:12,750] INFO [broker-2-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:12,762] INFO [broker-2-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:12,769] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:12,769] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:12,769] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:12,770] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:12,809] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-13 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,823] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:07:12,835] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,879] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-46 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,880] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-9 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,880] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-42 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,880] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-21 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,881] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-17 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,881] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-30 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,881] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-26 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,881] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-5 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,882] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-38 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,882] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-1 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,882] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-34 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,883] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-16 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,911] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-45 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,940] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:12,942] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-12 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,942] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-41 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,943] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-24 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,943] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-20 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,943] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-49 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,943] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-0 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,944] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-29 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,944] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-25 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,944] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-8 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,945] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-37 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,944] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:12,945] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-4 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,945] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-33 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,958] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-15 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,958] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-48 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,989] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-11 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,990] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-44 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,990] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-23 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,991] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-19 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,999] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-32 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,999] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-28 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:12,999] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-7 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,000] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-40 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,000] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-3 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,000] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-36 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,000] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-47 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,001] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-14 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,001] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-43 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,001] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-10 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,001] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-22 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,001] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-18 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,002] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-31 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,006] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-27 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,006] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-39 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,006] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-6 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,018] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-35 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,019] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-2 with epoch 22 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,047] INFO [DynamicConfigPublisher broker id=1] Updating topic __consumer_offsets with new configuration : compression.type -> producer,cleanup.policy -> compact,segment.bytes -> 104857600 (kafka.server.metadata.DynamicConfigPublisher)
[2025-05-29 17:07:13,049] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,113] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=1) with a snapshot at offset 78990 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,126] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-17 with epoch 22 in 32ms where 32ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,126] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-5 with epoch 22 in 31ms where 31ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,127] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-13 with epoch 22 in 6ms where 5ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,155] INFO [MetadataLoader id=2] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,215] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=79070, metadata=Optional.empty)] for the first time for epoch 497 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:07:13,215] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:07:13,262] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-42 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-42 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,265] INFO [MetadataLoader id=2] initializeNewPublishers: The loader is still catching up because we have loaded up to offset -1, but the high water mark is 79070 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,282] INFO [MetadataLoader id=2] handleLoadSnapshot(00000000000000065900-0000000286): incrementing HandleLoadSnapshotCount to 1. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,297] INFO [GroupCoordinator id=1 topic=__consumer_offsets partition=42] [GroupId=console-consumer-53364] Unloading group metadata for generation 4. (org.apache.kafka.coordinator.group.GroupMetadataManager)
[2025-05-29 17:07:13,298] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-27 with epoch 22 in 166ms where 166ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,298] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-24 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-24 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,298] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-9 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-9 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,298] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-38 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-38 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,298] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-48 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-48 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,302] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-47 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-47 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,303] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-3 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-3 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,303] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-49 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-49 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,303] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-41 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-41 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,303] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-43 with epoch 22 in 178ms where 178ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,304] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-36 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-36 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,304] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-10 with epoch 22 in 179ms where 179ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,304] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-20 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-20 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,304] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-44 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-44 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,305] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-34 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-34 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,262] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-45 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-45 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,315] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-4 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-4 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,315] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-25 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-25 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,315] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-31 with epoch 22 in 168ms where 168ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,316] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-37 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-37 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,316] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-19 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-19 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,316] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-35 with epoch 22 in 180ms where 180ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,316] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-30 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-30 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,317] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-8 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-8 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,317] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-6 with epoch 22 in 154ms where 154ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,317] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-0 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-0 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,317] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-32 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-32 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,262] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-28 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-28 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,318] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-39 with epoch 22 in 167ms where 167ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,331] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-2 with epoch 22 in 167ms where 167ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,331] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-21 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-21 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,332] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-33 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-33 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,332] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-23 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-23 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,332] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-15 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-15 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,332] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-11 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-11 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,333] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-18 with epoch 22 in 61ms where 61ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,333] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-12 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-12 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,333] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-7 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-7 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,333] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-26 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-26 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,333] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-29 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-29 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,333] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-16 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-16 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,330] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-46 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-46 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,334] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-22 with epoch 22 in 75ms where 75ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,337] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(__consumer_offsets-13, __consumer_offsets-46, __consumer_offsets-9, __consumer_offsets-42, __consumer_offsets-21, __consumer_offsets-17, ssl-test-topic-0, __consumer_offsets-30, __consumer_offsets-26, __consumer_offsets-5, __consumer_offsets-38, __consumer_offsets-1, __consumer_offsets-34, __consumer_offsets-16, __consumer_offsets-45, __consumer_offsets-12, __consumer_offsets-41, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-49, __consumer_offsets-0, ssl-test-topic-1, __consumer_offsets-29, __consumer_offsets-25, __consumer_offsets-8, __consumer_offsets-37, __consumer_offsets-4, __consumer_offsets-33, __consumer_offsets-15, __consumer_offsets-48, __consumer_offsets-11, __consumer_offsets-44, __consumer_offsets-23, __consumer_offsets-19, ssl-test-topic-2, __consumer_offsets-32, test-topic-0, __consumer_offsets-28, __consumer_offsets-7, __consumer_offsets-40, __consumer_offsets-3, __consumer_offsets-36, __consumer_offsets-47, __consumer_offsets-14, __consumer_offsets-43, __consumer_offsets-10, __consumer_offsets-22, __consumer_offsets-18, __consumer_offsets-31, __consumer_offsets-27, __consumer_offsets-39, __consumer_offsets-6, __consumer_offsets-35, __consumer_offsets-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:13,345] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-14 with epoch 22 in 179ms where 179ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,262] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-1 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-1 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,350] ERROR [GroupCoordinator id=1] Failed to load metadata from __consumer_offsets-40 with epoch 22 due to org.apache.kafka.common.errors.NotLeaderOrFollowerException: Stopped loading records from __consumer_offsets-40 because the partition is not online or is no longer the leader.. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,368] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-13 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,382] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-13 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,382] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-13 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,382] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-46 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,383] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-46 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,383] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-46 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,383] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-9 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,395] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-42 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,395] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-21 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,395] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-17 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,395] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-30 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,395] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-26 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-5 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-38 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-1 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-34 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-16 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-45 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-12 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-41 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-24 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-20 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-49 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-0 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,396] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-29 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-25 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-8 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-37 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-4 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-33 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-15 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-48 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-11 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-44 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-23 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-19 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,397] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-32 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,398] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-28 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,398] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-7 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,398] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-40 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,402] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-3 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,402] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-36 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,402] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-47 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,403] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-14 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,403] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-43 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,403] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-10 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,403] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-22 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-18 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-25 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,403] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-38 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-25 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-38 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-12 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-12 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-34 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-31 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,405] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-27 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,405] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-39 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,405] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-6 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,405] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-35 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,406] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-2 with epoch OptionalInt[23] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,414] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-28 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,414] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-28 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,404] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-40 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,414] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-40 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,415] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-7 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,415] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-7 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,415] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-23 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,415] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-23 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,419] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-33 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,419] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-33 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,419] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-34 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,439] INFO [MetadataLoader id=2] handleLoadSnapshot(00000000000000065900-0000000286): generated a metadata delta between offset -1 and this snapshot in 156345 us. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,414] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-27 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,443] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-27 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,448] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-19 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,448] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-19 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,448] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-37 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,448] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-37 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-29 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-29 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-21 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-21 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-24 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-24 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-1 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-1 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-47 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-47 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,449] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-5 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-5 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-45 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-45 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-32 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-32 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-26 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-26 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-9 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-9 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,450] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-0 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-0 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-15 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-15 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-31 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-31 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-11 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-11 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,451] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-17 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-17 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-3 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-3 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-49 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-49 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-22 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-22 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,452] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-10 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,454] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-20 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,463] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-20 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,463] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-41 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,463] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-41 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,463] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-18 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,463] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-18 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,463] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-44 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-44 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-4 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-4 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-30 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-30 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-14 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-14 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-36 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-36 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-43 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,464] INFO [MetadataLoader id=2] maybePublishMetadata(SNAPSHOT): The loader is still catching up because we have loaded up to offset 65899, but the high water mark is 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-43 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-8 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-8 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,465] INFO [MetadataLoader id=2] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 65899, but the high water mark is 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-16 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-16 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-42 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-42 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,465] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-39 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,466] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-10 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,466] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-48 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,466] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-48 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,466] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-35 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,466] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-39 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,466] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-2 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,467] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-2 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,466] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-35 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,480] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-6 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,481] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-6 with epoch OptionalInt[23]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:13,527] INFO [BrokerLifecycleManager id=1] The broker has caught up. Transitioning from STARTING to RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:13,538] INFO [BrokerServer id=1] Finished waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:07:13,538] INFO [BrokerServer id=1] Waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:07:13,538] INFO [BrokerServer id=1] Finished waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:07:13,541] INFO KafkaConfig values: 
	add.partitions.to.txn.retry.backoff.max.ms = 100
	add.partitions.to.txn.retry.backoff.ms = 20
	advertised.listeners = SSL://172.23.38.230:9092
	alter.config.policy.class.name = null
	alter.log.dirs.replication.quota.window.num = 11
	alter.log.dirs.replication.quota.window.size.seconds = 1
	authorizer.class.name = 
	auto.create.topics.enable = true
	auto.leader.rebalance.enable = true
	background.threads = 10
	broker.heartbeat.interval.ms = 2000
	broker.id = 1
	broker.rack = null
	broker.session.timeout.ms = 9000
	client.quota.callback.class = null
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = producer
	compression.zstd.level = 3
	connection.failed.authentication.delay.ms = 100
	connections.max.idle.ms = 600000
	connections.max.reauth.ms = 0
	controlled.shutdown.enable = true
	controller.listener.names = CONTROLLER
	controller.performance.always.log.threshold.ms = 2000
	controller.performance.sample.period.ms = 60000
	controller.quorum.append.linger.ms = 25
	controller.quorum.bootstrap.servers = []
	controller.quorum.election.backoff.max.ms = 1000
	controller.quorum.election.timeout.ms = 1000
	controller.quorum.fetch.timeout.ms = 2000
	controller.quorum.request.timeout.ms = 2000
	controller.quorum.retry.backoff.ms = 20
	controller.quorum.voters = [1@localhost:9093, 2@localhost:9096, 3@localhost:9099]
	controller.quota.window.num = 11
	controller.quota.window.size.seconds = 1
	controller.socket.timeout.ms = 30000
	create.topic.policy.class.name = null
	default.replication.factor = 3
	delegation.token.expiry.check.interval.ms = 3600000
	delegation.token.expiry.time.ms = 86400000
	delegation.token.max.lifetime.ms = 604800000
	delegation.token.secret.key = null
	delete.records.purgatory.purge.interval.requests = 1
	delete.topic.enable = true
	early.start.listeners = null
	fetch.max.bytes = 57671680
	fetch.purgatory.purge.interval.requests = 1000
	group.consumer.assignors = [uniform, range]
	group.consumer.heartbeat.interval.ms = 5000
	group.consumer.max.heartbeat.interval.ms = 15000
	group.consumer.max.session.timeout.ms = 60000
	group.consumer.max.size = 2147483647
	group.consumer.migration.policy = bidirectional
	group.consumer.min.heartbeat.interval.ms = 5000
	group.consumer.min.session.timeout.ms = 45000
	group.consumer.session.timeout.ms = 45000
	group.coordinator.append.linger.ms = 5
	group.coordinator.new.enable = true
	group.coordinator.rebalance.protocols = [classic, consumer]
	group.coordinator.threads = 4
	group.initial.rebalance.delay.ms = 3000
	group.max.session.timeout.ms = 1800000
	group.max.size = 2147483647
	group.min.session.timeout.ms = 6000
	group.share.delivery.count.limit = 5
	group.share.enable = false
	group.share.heartbeat.interval.ms = 5000
	group.share.max.groups = 10
	group.share.max.heartbeat.interval.ms = 15000
	group.share.max.record.lock.duration.ms = 60000
	group.share.max.session.timeout.ms = 60000
	group.share.max.size = 200
	group.share.min.heartbeat.interval.ms = 5000
	group.share.min.record.lock.duration.ms = 15000
	group.share.min.session.timeout.ms = 45000
	group.share.partition.max.record.locks = 200
	group.share.persister.class.name = org.apache.kafka.server.share.persister.DefaultStatePersister
	group.share.record.lock.duration.ms = 30000
	group.share.session.timeout.ms = 45000
	initial.broker.registration.timeout.ms = 60000
	inter.broker.listener.name = SSL
	kafka.metrics.polling.interval.secs = 10
	kafka.metrics.reporters = []
	leader.imbalance.check.interval.seconds = 300
	listener.security.protocol.map = SSL:SSL,CONTROLLER:SSL
	listeners = SSL://0.0.0.0:9092,CONTROLLER://:9093
	log.cleaner.backoff.ms = 15000
	log.cleaner.dedupe.buffer.size = 134217728
	log.cleaner.delete.retention.ms = 86400000
	log.cleaner.enable = true
	log.cleaner.io.buffer.load.factor = 0.9
	log.cleaner.io.buffer.size = 524288
	log.cleaner.io.max.bytes.per.second = 1.7976931348623157E308
	log.cleaner.max.compaction.lag.ms = 9223372036854775807
	log.cleaner.min.cleanable.ratio = 0.5
	log.cleaner.min.compaction.lag.ms = 0
	log.cleaner.threads = 1
	log.cleanup.policy = [delete]
	log.dir = /tmp/kafka-logs
	log.dir.failure.timeout.ms = 30000
	log.dirs = /home/ammar/kafka_data/broker1_4.0.0
	log.flush.interval.messages = 9223372036854775807
	log.flush.interval.ms = null
	log.flush.offset.checkpoint.interval.ms = 60000
	log.flush.scheduler.interval.ms = 9223372036854775807
	log.flush.start.offset.checkpoint.interval.ms = 60000
	log.index.interval.bytes = 4096
	log.index.size.max.bytes = 10485760
	log.initial.task.delay.ms = 30000
	log.local.retention.bytes = -2
	log.local.retention.ms = -2
	log.message.timestamp.after.max.ms = 3600000
	log.message.timestamp.before.max.ms = 9223372036854775807
	log.message.timestamp.type = CreateTime
	log.preallocate = false
	log.retention.bytes = -1
	log.retention.check.interval.ms = 300000
	log.retention.hours = 168
	log.retention.minutes = null
	log.retention.ms = null
	log.roll.hours = 168
	log.roll.jitter.hours = 0
	log.roll.jitter.ms = null
	log.roll.ms = null
	log.segment.bytes = 1073741824
	log.segment.delete.delay.ms = 60000
	max.connection.creation.rate = 2147483647
	max.connections = 2147483647
	max.connections.per.ip = 2147483647
	max.connections.per.ip.overrides = 
	max.incremental.fetch.session.cache.slots = 1000
	max.request.partition.size.limit = 2000
	message.max.bytes = 1048588
	metadata.log.dir = null
	metadata.log.max.record.bytes.between.snapshots = 20971520
	metadata.log.max.snapshot.interval.ms = 3600000
	metadata.log.segment.bytes = 1073741824
	metadata.log.segment.min.bytes = 8388608
	metadata.log.segment.ms = 604800000
	metadata.max.idle.interval.ms = 500
	metadata.max.retention.bytes = 104857600
	metadata.max.retention.ms = 604800000
	metric.reporters = [org.apache.kafka.common.metrics.JmxReporter]
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	min.insync.replicas = 2
	node.id = 1
	num.io.threads = 8
	num.network.threads = 3
	num.partitions = 1
	num.recovery.threads.per.data.dir = 1
	num.replica.alter.log.dirs.threads = null
	num.replica.fetchers = 1
	offset.metadata.max.bytes = 4096
	offsets.commit.timeout.ms = 5000
	offsets.load.buffer.size = 5242880
	offsets.retention.check.interval.ms = 600000
	offsets.retention.minutes = 10080
	offsets.topic.compression.codec = 0
	offsets.topic.num.partitions = 50
	offsets.topic.replication.factor = 3
	offsets.topic.segment.bytes = 104857600
	principal.builder.class = class org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder
	process.roles = [broker, controller]
	producer.id.expiration.check.interval.ms = 600000
	producer.id.expiration.ms = 86400000
	producer.purgatory.purge.interval.requests = 1000
	queued.max.request.bytes = -1
	queued.max.requests = 500
	quota.window.num = 11
	quota.window.size.seconds = 1
	remote.fetch.max.wait.ms = 500
	remote.list.offsets.request.timeout.ms = 30000
	remote.log.index.file.cache.total.size.bytes = 1073741824
	remote.log.manager.copier.thread.pool.size = 10
	remote.log.manager.copy.max.bytes.per.second = 9223372036854775807
	remote.log.manager.copy.quota.window.num = 11
	remote.log.manager.copy.quota.window.size.seconds = 1
	remote.log.manager.expiration.thread.pool.size = 10
	remote.log.manager.fetch.max.bytes.per.second = 9223372036854775807
	remote.log.manager.fetch.quota.window.num = 11
	remote.log.manager.fetch.quota.window.size.seconds = 1
	remote.log.manager.task.interval.ms = 30000
	remote.log.manager.task.retry.backoff.max.ms = 30000
	remote.log.manager.task.retry.backoff.ms = 500
	remote.log.manager.task.retry.jitter = 0.2
	remote.log.manager.thread.pool.size = 2
	remote.log.metadata.custom.metadata.max.bytes = 128
	remote.log.metadata.manager.class.name = org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager
	remote.log.metadata.manager.class.path = null
	remote.log.metadata.manager.impl.prefix = rlmm.config.
	remote.log.metadata.manager.listener.name = null
	remote.log.reader.max.pending.tasks = 100
	remote.log.reader.threads = 10
	remote.log.storage.manager.class.name = null
	remote.log.storage.manager.class.path = null
	remote.log.storage.manager.impl.prefix = rsm.config.
	remote.log.storage.system.enable = false
	replica.fetch.backoff.ms = 1000
	replica.fetch.max.bytes = 1048576
	replica.fetch.min.bytes = 1
	replica.fetch.response.max.bytes = 10485760
	replica.fetch.wait.max.ms = 500
	replica.high.watermark.checkpoint.interval.ms = 5000
	replica.lag.time.max.ms = 30000
	replica.selector.class = null
	replica.socket.receive.buffer.bytes = 65536
	replica.socket.timeout.ms = 30000
	replication.quota.window.num = 11
	replication.quota.window.size.seconds = 1
	request.timeout.ms = 30000
	sasl.client.callback.handler.class = null
	sasl.enabled.mechanisms = [GSSAPI]
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.principal.to.local.rules = [DEFAULT]
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism.controller.protocol = GSSAPI
	sasl.mechanism.inter.broker.protocol = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	sasl.server.callback.handler.class = null
	sasl.server.max.receive.size = 524288
	security.inter.broker.protocol = PLAINTEXT
	security.providers = null
	server.max.startup.time.ms = 9223372036854775807
	share.coordinator.append.linger.ms = 10
	share.coordinator.load.buffer.size = 5242880
	share.coordinator.snapshot.update.records.per.snapshot = 500
	share.coordinator.state.topic.compression.codec = 0
	share.coordinator.state.topic.min.isr = 2
	share.coordinator.state.topic.num.partitions = 50
	share.coordinator.state.topic.prune.interval.ms = 300000
	share.coordinator.state.topic.replication.factor = 3
	share.coordinator.state.topic.segment.bytes = 104857600
	share.coordinator.threads = 1
	share.coordinator.write.timeout.ms = 5000
	share.fetch.max.fetch.records = 2147483647
	share.fetch.purgatory.purge.interval.requests = 1000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	socket.listen.backlog.size = 50
	socket.receive.buffer.bytes = 102400
	socket.request.max.bytes = 104857600
	socket.send.buffer.bytes = 102400
	ssl.allow.dn.changes = false
	ssl.allow.san.changes = false
	ssl.cipher.suites = []
	ssl.client.auth = required
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = 
	ssl.engine.factory.class = null
	ssl.key.password = [hidden]
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.keystore.jks
	ssl.keystore.password = [hidden]
	ssl.keystore.type = JKS
	ssl.principal.mapping.rules = DEFAULT
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.truststore.jks
	ssl.truststore.password = [hidden]
	ssl.truststore.type = JKS
	telemetry.max.bytes = 1048576
	transaction.abort.timed.out.transaction.cleanup.interval.ms = 10000
	transaction.max.timeout.ms = 900000
	transaction.partition.verification.enable = true
	transaction.remove.expired.transaction.cleanup.interval.ms = 3600000
	transaction.state.log.load.buffer.size = 5242880
	transaction.state.log.min.isr = 2
	transaction.state.log.num.partitions = 50
	transaction.state.log.replication.factor = 3
	transaction.state.log.segment.bytes = 104857600
	transactional.id.expiration.ms = 604800000
	unclean.leader.election.enable = false
	unclean.leader.election.interval.ms = 300000
	unstable.api.versions.enable = false
	unstable.feature.versions.enable = false
 (org.apache.kafka.common.config.AbstractConfig)
[2025-05-29 17:07:13,556] INFO [BrokerLifecycleManager id=1] The broker is in RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:13,605] INFO [BrokerServer id=1] Waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:07:13,743] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:13,743] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:13,790] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:13,790] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:13,791] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:13,858] INFO [BrokerLifecycleManager id=1] The broker has been unfenced. Transitioning from RECOVERY to RUNNING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:13,860] INFO [BrokerServer id=1] Finished waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:07:13,860] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(__consumer_offsets-13, __consumer_offsets-46, __consumer_offsets-9, __consumer_offsets-42, __consumer_offsets-21, __consumer_offsets-17, ssl-test-topic-0, __consumer_offsets-30, __consumer_offsets-26, __consumer_offsets-5, __consumer_offsets-38, __consumer_offsets-1, __consumer_offsets-34, __consumer_offsets-16, __consumer_offsets-45, __consumer_offsets-12, __consumer_offsets-41, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-49, __consumer_offsets-0, ssl-test-topic-1, __consumer_offsets-29, __consumer_offsets-25, __consumer_offsets-8, __consumer_offsets-37, __consumer_offsets-4, __consumer_offsets-33, __consumer_offsets-15, __consumer_offsets-48, __consumer_offsets-11, __consumer_offsets-44, __consumer_offsets-23, __consumer_offsets-19, ssl-test-topic-2, __consumer_offsets-32, test-topic-0, __consumer_offsets-28, __consumer_offsets-7, __consumer_offsets-40, __consumer_offsets-3, __consumer_offsets-36, __consumer_offsets-47, __consumer_offsets-14, __consumer_offsets-43, __consumer_offsets-10, __consumer_offsets-22, __consumer_offsets-18, __consumer_offsets-31, __consumer_offsets-27, __consumer_offsets-39, __consumer_offsets-6, __consumer_offsets-35, __consumer_offsets-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:13,861] INFO authorizerStart completed for endpoint SSL. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:07:13,861] INFO [SocketServer listenerType=BROKER, nodeId=1] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:07:13,862] INFO Awaiting socket connections on 0.0.0.0:9092. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:07:13,891] INFO [BrokerServer id=1] Waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:07:13,900] INFO [BrokerServer id=1] Finished waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:07:13,900] INFO [BrokerServer id=1] Waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:07:13,900] INFO [BrokerServer id=1] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:07:13,900] INFO [BrokerServer id=1] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-29 17:07:13,903] INFO Kafka version: 4.0.0 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:07:13,903] INFO Kafka commitId: 985bc99521dd22bb (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:07:13,903] INFO Kafka startTimeMs: 1748527633900 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:07:13,905] INFO [KafkaRaftServer nodeId=1] Kafka Server started (kafka.server.KafkaRaftServer)
[2025-05-29 17:07:14,022] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:14,023] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:14,023] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:14,023] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:14,025] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:14,204] INFO [MetadataLoader id=2] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have loaded up to offset 79069, but the high water mark is 79072 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,205] INFO [MetadataLoader id=2] initializeNewPublishers: The loader is still catching up because we have loaded up to offset 79069, but the high water mark is 79072 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,206] INFO [MetadataLoader id=2] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 79072 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,218] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,219] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,220] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,238] INFO [ControllerServer id=2] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=79071). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-29 17:07:14,238] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,239] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,241] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=2 with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,247] INFO [ControllerRegistrationManager id=2 incarnation=7l6nTrM3Q0SV1pN5feY6fQ] Found registration for aYXCWjkTQHCFvAZjws693g instead of our incarnation. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:14,248] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=2 with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,251] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=2 with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,252] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing ScramPublisher controller id=2 with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,254] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=2 with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,267] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,267] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing AclPublisher controller id=2 with a snapshot at offset 79071 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:14,315] INFO [ControllerRegistrationManager id=2 incarnation=7l6nTrM3Q0SV1pN5feY6fQ] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=2, incarnationId=7l6nTrM3Q0SV1pN5feY6fQ, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.localdomain', port=9096, securityProtocol=1)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:14,701] INFO [ControllerRegistrationManager id=2 incarnation=7l6nTrM3Q0SV1pN5feY6fQ] RegistrationResponseHandler: controller acknowledged ControllerRegistrationRequest. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:14,748] INFO [SocketServer listenerType=BROKER, nodeId=2] Created data-plane acceptor and processors for endpoint : ListenerName(SSL) (kafka.network.SocketServer)
[2025-05-29 17:07:14,793] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:14,794] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:14,794] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:14,794] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:14,795] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:14,833] INFO [ControllerRegistrationManager id=2 incarnation=7l6nTrM3Q0SV1pN5feY6fQ] Our registration has been persisted to the metadata log. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:07:14,903] INFO [broker-2-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:14,904] INFO [broker-2-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:15,028] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:15,029] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:15,029] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:15,029] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:15,030] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:15,092] INFO [broker-2-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:15,093] INFO [broker-2-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:15,127] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:15,131] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:15,133] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:15,135] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:15,138] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:15,140] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:15,175] INFO [BrokerServer id=2] Using no op persister (kafka.server.BrokerServer)
[2025-05-29 17:07:15,180] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:07:15,270] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:15,271] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:15,271] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:15,271] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:07:15,508] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:15,628] INFO Unable to read the broker epoch in /home/ammar/kafka_data/broker2_4.0.0. (kafka.log.LogManager)
[2025-05-29 17:07:15,630] INFO [broker-2-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:15,631] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:07:15,637] INFO [BrokerLifecycleManager id=2] Incarnation xGQP8Cj_R4OJfgai_AMIkA of broker 2 in cluster vN8K3C85SQS4roeM5v3xFg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:15,679] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:07:15,735] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:07:15,764] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:15,801] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:15,801] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:15,801] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:15,801] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:15,804] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:15,808] INFO [BrokerServer id=2] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:07:15,813] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing MetadataVersionPublisher(id=2) with a snapshot at offset 79130 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:15,820] INFO [BrokerServer id=2] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:07:15,820] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 79130 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:15,820] INFO [BrokerServer id=2] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:07:15,822] INFO [BrokerMetadataPublisher id=2] Publishing initial metadata at offset OffsetAndEpoch(offset=79130, epoch=497) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-29 17:07:15,832] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker2_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:15,844] INFO Recovering 3 logs from /home/ammar/kafka_data/broker2_4.0.0 since no clean shutdown file was found (kafka.log.LogManager)
[2025-05-29 17:07:15,867] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker2_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-2. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:15,868] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,868] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,868] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,882] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,882] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,882] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,896] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:15,939] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker2_4.0.0/my-topic-2, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 27ms (1/3 completed in /home/ammar/kafka_data/broker2_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:15,944] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:15,952] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,975] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,982] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,993] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,994] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,994] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:15,999] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker2_4.0.0/my-topic-0, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 59ms (2/3 completed in /home/ammar/kafka_data/broker2_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:16,003] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker2_4.0.0] Recovering unflushed segment 0. 0 recovered for my-topic-1. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:07:16,010] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:16,010] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:16,011] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:16,020] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:16,021] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:16,021] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:07:16,030] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker2_4.0.0/my-topic-1, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 24ms (3/3 completed in /home/ammar/kafka_data/broker2_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:07:16,033] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:16,033] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:16,034] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:16,034] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:16,037] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:16,049] INFO Loaded 3 logs in 204ms (unclean log dirs = ArrayBuffer(/home/ammar/kafka_data/broker2_4.0.0)) (kafka.log.LogManager)
[2025-05-29 17:07:16,051] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-29 17:07:16,053] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-29 17:07:16,103] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:16,534] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-13 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,536] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-46 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,537] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-9 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,537] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-42 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,539] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-46 with epoch 24 in 0ms where 0ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,539] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-21 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,538] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-9 with epoch 24 in 0ms where 0ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,538] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-13 with epoch 24 in 0ms where 0ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,539] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-17 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,539] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-30 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,539] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-26 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,540] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-5 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,543] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-38 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,544] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-1 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,544] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-34 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,544] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-16 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,544] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-45 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,545] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-12 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,545] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-41 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,545] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-24 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,546] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-20 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,546] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-49 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,546] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-0 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,547] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-29 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,547] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-25 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,547] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-8 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,547] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-37 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,547] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-4 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,548] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-33 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,548] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-15 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,548] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-48 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,548] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-11 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,549] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-44 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,549] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-23 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,549] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-19 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,549] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-32 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,550] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-28 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,550] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-7 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,550] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-40 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,551] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-3 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,551] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-36 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,551] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-47 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,551] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-14 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,552] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-43 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,552] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-10 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,552] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-22 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,553] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-18 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,553] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-31 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,557] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-27 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,559] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-39 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,564] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-6 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,564] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-35 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,564] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-2 with epoch 24 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-42 with epoch 24 in 64ms where 1ms was spent in the scheduler. Loaded 3 records which total to 592 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-17 with epoch 24 in 64ms where 64ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-21 with epoch 24 in 64ms where 64ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-34 with epoch 24 in 59ms where 59ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-16 with epoch 24 in 59ms where 59ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-1 with epoch 24 in 60ms where 60ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-5 with epoch 24 in 60ms where 60ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-45 with epoch 24 in 59ms where 59ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-30 with epoch 24 in 59ms where 59ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-26 with epoch 24 in 61ms where 61ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,604] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-4 with epoch 24 in 55ms where 55ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-38 with epoch 24 in 60ms where 60ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-15 with epoch 24 in 56ms where 56ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-41 with epoch 24 in 58ms where 58ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-12 with epoch 24 in 59ms where 59ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-48 with epoch 24 in 56ms where 55ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-8 with epoch 24 in 55ms where 55ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-44 with epoch 24 in 56ms where 56ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-23 with epoch 24 in 55ms where 55ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-7 with epoch 24 in 54ms where 54ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-0 with epoch 24 in 55ms where 55ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,605] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-28 with epoch 24 in 54ms where 54ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-25 with epoch 24 in 52ms where 52ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-20 with epoch 24 in 53ms where 53ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-3 with epoch 24 in 51ms where 50ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-18 with epoch 24 in 51ms where 51ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-22 with epoch 24 in 51ms where 51ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-2 with epoch 24 in 40ms where 40ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-35 with epoch 24 in 40ms where 40ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,607] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-37 with epoch 24 in 52ms where 52ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,607] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-49 with epoch 24 in 52ms where 52ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,607] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-31 with epoch 24 in 49ms where 49ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-36 with epoch 24 in 51ms where 51ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-24 with epoch 24 in 58ms where 58ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,607] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-19 with epoch 24 in 51ms where 51ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,607] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-6 with epoch 24 in 40ms where 40ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,607] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-11 with epoch 24 in 55ms where 55ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,606] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-39 with epoch 24 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,609] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-43 with epoch 24 in 52ms where 52ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,609] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-33 with epoch 24 in 53ms where 53ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,609] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-27 with epoch 24 in 47ms where 47ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,609] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-32 with epoch 24 in 54ms where 54ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,610] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-14 with epoch 24 in 50ms where 50ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,610] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-47 with epoch 24 in 50ms where 50ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,610] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-29 with epoch 24 in 51ms where 51ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,610] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-40 with epoch 24 in 51ms where 51ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,609] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-10 with epoch 24 in 51ms where 51ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:07:16,809] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:16,810] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:16,810] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:16,810] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:16,811] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:17,040] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:17,040] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:17,040] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:17,040] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:17,041] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:17,086] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:17,090] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:07:17,098] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:07:17,101] INFO [AddPartitionsToTxnSenderThread-2]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:07:17,104] INFO [GroupCoordinator id=2] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:07:17,105] INFO [GroupCoordinator id=2] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:07:17,106] INFO [TransactionCoordinator id=2] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:07:17,111] INFO [TxnMarkerSenderThread-2]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:07:17,111] INFO [TransactionCoordinator id=2] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:07:17,121] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:07:17,166] INFO [Partition my-topic-0 broker=2] Log loaded for partition my-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:17,204] INFO [Partition my-topic-1 broker=2] Log loaded for partition my-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:17,220] INFO [Partition my-topic-2 broker=2] Log loaded for partition my-topic-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:07:17,249] INFO [DynamicConfigPublisher broker id=2] Updating topic __consumer_offsets with new configuration : compression.type -> producer,cleanup.policy -> compact,segment.bytes -> 104857600 (kafka.server.metadata.DynamicConfigPublisher)
[2025-05-29 17:07:17,263] INFO [MetadataLoader id=2] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=2) with a snapshot at offset 79130 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:07:17,814] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:17,814] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:17,814] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:17,815] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:17,816] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:17,905] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:07:18,043] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:18,044] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:18,044] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:18,044] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:18,045] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:18,819] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:18,819] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:18,819] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:18,819] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:18,820] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:19,047] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:19,048] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:19,048] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:07:19,048] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:19,049] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:07:19,536] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:06:36,731] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:04,884] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:04,884] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:04,885] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:04,885] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:04,886] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:05,065] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:08:05,066] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 79141 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,067] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 79141 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,068] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,069] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,070] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=497, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1960, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=497, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,080] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=497, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1816, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=497, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,089] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=497, voters=[1, 2, 3], electionTimeoutMs=1020, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=497, epochStartOffset=79069, highWatermark=Optional[LogOffsetMetadata(offset=79141, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659848)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79141, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659848)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79141, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659848)])], lastFetchTimestamp=1748527639771, lastCaughtUpTimestamp=1748527639771, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79141, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659848)])], lastFetchTimestamp=1748527639769, lastCaughtUpTimestamp=1748527639769, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,092] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=497, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=true)])]) with epoch 497 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,098] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=498, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1390) from ProspectiveState(epoch=497, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1816, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,110] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=497, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=true)])]) with epoch 497 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,113] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=497, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=true)])]) with epoch 497 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,141] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=498, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1796) from ProspectiveState(epoch=497, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1960, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,215] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=498, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1390) from ProspectiveState(epoch=497, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1816, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,225] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=863, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=497, voters=[1, 2, 3], electionTimeoutMs=1020, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,255] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=498, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1796) from ProspectiveState(epoch=497, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1960, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,256] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=498, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=false)])]) with epoch 498 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,271] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=498, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=false)])]) with epoch 498 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,287] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=863, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=497, voters=[1, 2, 3], electionTimeoutMs=1020, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,288] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1579, highWatermark=Optional.empty) from UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=863, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,288] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1505913039). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:08:05,344] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1579, highWatermark=Optional.empty) from UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=863, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,344] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=498, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=false)])]) with epoch 498 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,345] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=498, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=false)])]) with epoch 498 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,356] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,356] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,357] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=498, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1865, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=498, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1796) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,367] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=498, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=true)])]) with epoch 498 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,372] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=499, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1641) from ProspectiveState(epoch=498, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1865, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,380] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=498, epochStartOffset=79141, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=498, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1390) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,447] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=498, epochStartOffset=79141, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=498, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1390) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,448] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=499, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1641) from ProspectiveState(epoch=498, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1865, highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,460] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1407, highWatermark=Optional.empty) from UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1579, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,526] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1407, highWatermark=Optional.empty) from UnattachedState(epoch=498, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1579, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,527] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1094, highWatermark=Optional.empty) from UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1407, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,558] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1094, highWatermark=Optional.empty) from UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1407, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,560] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=499, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=false)])]) with epoch 499 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,578] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=499, epochStartOffset=79141, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=499, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1641) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,615] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=498, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=true)])]) with epoch 498 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,630] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1736, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=498, epochStartOffset=79141, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79141, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659848)])], lastFetchTimestamp=1748527685593, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79142, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659954)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,656] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:05,656] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:05,657] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:05,657] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:05,657] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=499, epochStartOffset=79141, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=499, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79140, metadata=Optional.empty)], electionTimeoutMs=1641) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,658] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:05,672] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1736, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=498, epochStartOffset=79141, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79141, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659848)])], lastFetchTimestamp=1748527685593, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79142, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659954)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,675] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=499, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=497, lastOffset=79141, preVote=false)])]) with epoch 499 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,799] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=499, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1736, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,807] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=499, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1094, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,854] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=499, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1736, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,865] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 79141 (kafka.log.UnifiedLog)
[2025-05-29 17:08:05,871] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=499, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=499, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1094, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:05,870] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 79141 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:08:05,878] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 79141 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:08:05,878] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=79065, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000079065.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:08:05,890] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:05,890] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:05,890] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:05,891] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:05,892] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:05,900] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 79141 with 0 producer ids in 20 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:08:05,900] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 1ms for snapshot load and 21ms for segment recovery from offset 79141 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:08:05,901] INFO [RaftManager id=2] Truncated to offset 79141 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:05,932] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=79142, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659954)]) for the first time for epoch 499 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79142, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659954)])], lastFetchTimestamp=1748527685930, lastCaughtUpTimestamp=1748527685930, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79142, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659954)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79141, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2659848)])], lastFetchTimestamp=1748527685906, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:08:06,439] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=79142, metadata=Optional.empty)] for the first time for epoch 499 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:08:06,527] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=79142, metadata=Optional.empty)] for the first time for epoch 499 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:08:06,662] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:06,662] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:06,663] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:06,663] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:06,664] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:06,715] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=308, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=79141, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=308, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:35448-2-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2ef4791a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:08:06,716] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:06,716] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:08:06,896] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:06,896] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:06,896] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:06,896] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:06,897] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:07,532] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:07,535] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:08:07,591] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:07,667] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:07,668] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:07,668] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:07,668] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:07,669] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:07,900] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:07,900] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:07,901] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:07,901] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:07,902] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:08,673] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:08,673] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:08,673] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:08,673] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:08,674] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:08,904] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:08,905] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:08,905] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:08,905] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:08,906] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:09,271] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:09,272] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:08:09,307] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:09,678] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:09,678] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:09,679] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:09,679] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:09,680] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:09,909] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:09,909] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:09,909] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:09,909] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:09,910] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:10,683] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:10,683] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:10,683] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:10,683] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:10,684] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:10,913] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:10,913] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:10,913] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:10,913] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:10,914] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:11,686] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:11,687] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:11,687] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:11,687] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:11,688] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:11,917] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:11,917] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:11,917] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:11,917] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:11,918] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:12,095] INFO [BrokerLifecycleManager id=2] Unable to register broker 2 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:12,691] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:12,691] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:12,691] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:12,691] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:12,692] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:12,920] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:12,921] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:12,921] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:12,921] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:12,922] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:13,695] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:13,696] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:13,696] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:13,696] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:13,697] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:13,760] INFO [BrokerLifecycleManager id=3] Unable to register broker 3 because the controller returned error DUPLICATE_BROKER_REGISTRATION (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:13,924] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:13,924] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:13,924] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:13,925] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:13,925] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:14,703] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:14,703] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:14,703] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:14,703] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:14,704] WARN [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=3, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:14,927] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:14,928] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Connection to node 2 (/172.23.38.230:9095) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:14,928] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:14,928] INFO [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=INVALID, epoch=INITIAL) to node 2: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:14,929] WARN [ReplicaFetcher replicaId=1, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=1, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={my-topic-0=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[19], lastFetchedEpoch=Optional.empty), my-topic-1=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[17], lastFetchedEpoch=Optional.empty), my-topic-2=PartitionData(topicId=P_42li05RQ6ikIgdf1uRrA, fetchOffset=0, logStartOffset=0, maxBytes=1048576, currentLeaderEpoch=Optional[18], lastFetchedEpoch=Optional.empty)}, isolationLevel=read_uncommitted, removed=, replaced=, metadata=(sessionId=INVALID, epoch=INITIAL), rackId=) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 172.23.38.230:9095 (id: 2 rack: null isFenced: false) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:107) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:08:15,007] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:15,009] INFO [ReplicaFetcherThread-0-2]: Shutting down (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:15,010] INFO [ReplicaFetcherThread-0-2]: Stopped (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:15,010] INFO [ReplicaFetcherThread-0-2]: Shutdown completed (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:15,504] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:15,505] INFO [ReplicaFetcherThread-0-2]: Shutting down (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:15,506] INFO [ReplicaFetcherThread-0-2]: Stopped (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:15,506] INFO [ReplicaFetcherThread-0-2]: Shutdown completed (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:15,540] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:16,613] INFO [BrokerLifecycleManager id=2] Successfully registered broker 2 with broker epoch 79171 (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:17,030] INFO [BrokerLifecycleManager id=2] The broker has caught up. Transitioning from STARTING to RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:17,031] INFO [BrokerServer id=2] Finished waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:08:17,031] INFO [BrokerServer id=2] Waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:08:17,031] INFO [BrokerServer id=2] Finished waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:08:17,036] INFO KafkaConfig values: 
	add.partitions.to.txn.retry.backoff.max.ms = 100
	add.partitions.to.txn.retry.backoff.ms = 20
	advertised.listeners = SSL://172.23.38.230:9095
	alter.config.policy.class.name = null
	alter.log.dirs.replication.quota.window.num = 11
	alter.log.dirs.replication.quota.window.size.seconds = 1
	authorizer.class.name = 
	auto.create.topics.enable = true
	auto.leader.rebalance.enable = true
	background.threads = 10
	broker.heartbeat.interval.ms = 2000
	broker.id = 2
	broker.rack = null
	broker.session.timeout.ms = 9000
	client.quota.callback.class = null
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = producer
	compression.zstd.level = 3
	connection.failed.authentication.delay.ms = 100
	connections.max.idle.ms = 600000
	connections.max.reauth.ms = 0
	controlled.shutdown.enable = true
	controller.listener.names = CONTROLLER
	controller.performance.always.log.threshold.ms = 2000
	controller.performance.sample.period.ms = 60000
	controller.quorum.append.linger.ms = 25
	controller.quorum.bootstrap.servers = []
	controller.quorum.election.backoff.max.ms = 1000
	controller.quorum.election.timeout.ms = 1000
	controller.quorum.fetch.timeout.ms = 2000
	controller.quorum.request.timeout.ms = 2000
	controller.quorum.retry.backoff.ms = 20
	controller.quorum.voters = [1@localhost:9093, 2@localhost:9096, 3@localhost:9099]
	controller.quota.window.num = 11
	controller.quota.window.size.seconds = 1
	controller.socket.timeout.ms = 30000
	create.topic.policy.class.name = null
	default.replication.factor = 3
	delegation.token.expiry.check.interval.ms = 3600000
	delegation.token.expiry.time.ms = 86400000
	delegation.token.max.lifetime.ms = 604800000
	delegation.token.secret.key = null
	delete.records.purgatory.purge.interval.requests = 1
	delete.topic.enable = true
	early.start.listeners = null
	fetch.max.bytes = 57671680
	fetch.purgatory.purge.interval.requests = 1000
	group.consumer.assignors = [uniform, range]
	group.consumer.heartbeat.interval.ms = 5000
	group.consumer.max.heartbeat.interval.ms = 15000
	group.consumer.max.session.timeout.ms = 60000
	group.consumer.max.size = 2147483647
	group.consumer.migration.policy = bidirectional
	group.consumer.min.heartbeat.interval.ms = 5000
	group.consumer.min.session.timeout.ms = 45000
	group.consumer.session.timeout.ms = 45000
	group.coordinator.append.linger.ms = 5
	group.coordinator.new.enable = true
	group.coordinator.rebalance.protocols = [classic, consumer]
	group.coordinator.threads = 4
	group.initial.rebalance.delay.ms = 3000
	group.max.session.timeout.ms = 1800000
	group.max.size = 2147483647
	group.min.session.timeout.ms = 6000
	group.share.delivery.count.limit = 5
	group.share.enable = false
	group.share.heartbeat.interval.ms = 5000
	group.share.max.groups = 10
	group.share.max.heartbeat.interval.ms = 15000
	group.share.max.record.lock.duration.ms = 60000
	group.share.max.session.timeout.ms = 60000
	group.share.max.size = 200
	group.share.min.heartbeat.interval.ms = 5000
	group.share.min.record.lock.duration.ms = 15000
	group.share.min.session.timeout.ms = 45000
	group.share.partition.max.record.locks = 200
	group.share.persister.class.name = org.apache.kafka.server.share.persister.DefaultStatePersister
	group.share.record.lock.duration.ms = 30000
	group.share.session.timeout.ms = 45000
	initial.broker.registration.timeout.ms = 60000
	inter.broker.listener.name = SSL
	kafka.metrics.polling.interval.secs = 10
	kafka.metrics.reporters = []
	leader.imbalance.check.interval.seconds = 300
	listener.security.protocol.map = SSL:SSL,CONTROLLER:SSL
	listeners = SSL://0.0.0.0:9095,CONTROLLER://:9096
	log.cleaner.backoff.ms = 15000
	log.cleaner.dedupe.buffer.size = 134217728
	log.cleaner.delete.retention.ms = 86400000
	log.cleaner.enable = true
	log.cleaner.io.buffer.load.factor = 0.9
	log.cleaner.io.buffer.size = 524288
	log.cleaner.io.max.bytes.per.second = 1.7976931348623157E308
	log.cleaner.max.compaction.lag.ms = 9223372036854775807
	log.cleaner.min.cleanable.ratio = 0.5
	log.cleaner.min.compaction.lag.ms = 0
	log.cleaner.threads = 1
	log.cleanup.policy = [delete]
	log.dir = /tmp/kafka-logs
	log.dir.failure.timeout.ms = 30000
	log.dirs = /home/ammar/kafka_data/broker2_4.0.0
	log.flush.interval.messages = 9223372036854775807
	log.flush.interval.ms = null
	log.flush.offset.checkpoint.interval.ms = 60000
	log.flush.scheduler.interval.ms = 9223372036854775807
	log.flush.start.offset.checkpoint.interval.ms = 60000
	log.index.interval.bytes = 4096
	log.index.size.max.bytes = 10485760
	log.initial.task.delay.ms = 30000
	log.local.retention.bytes = -2
	log.local.retention.ms = -2
	log.message.timestamp.after.max.ms = 3600000
	log.message.timestamp.before.max.ms = 9223372036854775807
	log.message.timestamp.type = CreateTime
	log.preallocate = false
	log.retention.bytes = -1
	log.retention.check.interval.ms = 300000
	log.retention.hours = 168
	log.retention.minutes = null
	log.retention.ms = null
	log.roll.hours = 168
	log.roll.jitter.hours = 0
	log.roll.jitter.ms = null
	log.roll.ms = null
	log.segment.bytes = 1073741824
	log.segment.delete.delay.ms = 60000
	max.connection.creation.rate = 2147483647
	max.connections = 2147483647
	max.connections.per.ip = 2147483647
	max.connections.per.ip.overrides = 
	max.incremental.fetch.session.cache.slots = 1000
	max.request.partition.size.limit = 2000
	message.max.bytes = 1048588
	metadata.log.dir = null
	metadata.log.max.record.bytes.between.snapshots = 20971520
	metadata.log.max.snapshot.interval.ms = 3600000
	metadata.log.segment.bytes = 1073741824
	metadata.log.segment.min.bytes = 8388608
	metadata.log.segment.ms = 604800000
	metadata.max.idle.interval.ms = 500
	metadata.max.retention.bytes = 104857600
	metadata.max.retention.ms = 604800000
	metric.reporters = [org.apache.kafka.common.metrics.JmxReporter]
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	min.insync.replicas = 2
	node.id = 2
	num.io.threads = 8
	num.network.threads = 3
	num.partitions = 1
	num.recovery.threads.per.data.dir = 1
	num.replica.alter.log.dirs.threads = null
	num.replica.fetchers = 1
	offset.metadata.max.bytes = 4096
	offsets.commit.timeout.ms = 5000
	offsets.load.buffer.size = 5242880
	offsets.retention.check.interval.ms = 600000
	offsets.retention.minutes = 10080
	offsets.topic.compression.codec = 0
	offsets.topic.num.partitions = 50
	offsets.topic.replication.factor = 3
	offsets.topic.segment.bytes = 104857600
	principal.builder.class = class org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder
	process.roles = [broker, controller]
	producer.id.expiration.check.interval.ms = 600000
	producer.id.expiration.ms = 86400000
	producer.purgatory.purge.interval.requests = 1000
	queued.max.request.bytes = -1
	queued.max.requests = 500
	quota.window.num = 11
	quota.window.size.seconds = 1
	remote.fetch.max.wait.ms = 500
	remote.list.offsets.request.timeout.ms = 30000
	remote.log.index.file.cache.total.size.bytes = 1073741824
	remote.log.manager.copier.thread.pool.size = 10
	remote.log.manager.copy.max.bytes.per.second = 9223372036854775807
	remote.log.manager.copy.quota.window.num = 11
	remote.log.manager.copy.quota.window.size.seconds = 1
	remote.log.manager.expiration.thread.pool.size = 10
	remote.log.manager.fetch.max.bytes.per.second = 9223372036854775807
	remote.log.manager.fetch.quota.window.num = 11
	remote.log.manager.fetch.quota.window.size.seconds = 1
	remote.log.manager.task.interval.ms = 30000
	remote.log.manager.task.retry.backoff.max.ms = 30000
	remote.log.manager.task.retry.backoff.ms = 500
	remote.log.manager.task.retry.jitter = 0.2
	remote.log.manager.thread.pool.size = 2
	remote.log.metadata.custom.metadata.max.bytes = 128
	remote.log.metadata.manager.class.name = org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager
	remote.log.metadata.manager.class.path = null
	remote.log.metadata.manager.impl.prefix = rlmm.config.
	remote.log.metadata.manager.listener.name = null
	remote.log.reader.max.pending.tasks = 100
	remote.log.reader.threads = 10
	remote.log.storage.manager.class.name = null
	remote.log.storage.manager.class.path = null
	remote.log.storage.manager.impl.prefix = rsm.config.
	remote.log.storage.system.enable = false
	replica.fetch.backoff.ms = 1000
	replica.fetch.max.bytes = 1048576
	replica.fetch.min.bytes = 1
	replica.fetch.response.max.bytes = 10485760
	replica.fetch.wait.max.ms = 500
	replica.high.watermark.checkpoint.interval.ms = 5000
	replica.lag.time.max.ms = 30000
	replica.selector.class = null
	replica.socket.receive.buffer.bytes = 65536
	replica.socket.timeout.ms = 30000
	replication.quota.window.num = 11
	replication.quota.window.size.seconds = 1
	request.timeout.ms = 30000
	sasl.client.callback.handler.class = null
	sasl.enabled.mechanisms = [GSSAPI]
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.principal.to.local.rules = [DEFAULT]
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism.controller.protocol = GSSAPI
	sasl.mechanism.inter.broker.protocol = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	sasl.server.callback.handler.class = null
	sasl.server.max.receive.size = 524288
	security.inter.broker.protocol = PLAINTEXT
	security.providers = null
	server.max.startup.time.ms = 9223372036854775807
	share.coordinator.append.linger.ms = 10
	share.coordinator.load.buffer.size = 5242880
	share.coordinator.snapshot.update.records.per.snapshot = 500
	share.coordinator.state.topic.compression.codec = 0
	share.coordinator.state.topic.min.isr = 2
	share.coordinator.state.topic.num.partitions = 50
	share.coordinator.state.topic.prune.interval.ms = 300000
	share.coordinator.state.topic.replication.factor = 3
	share.coordinator.state.topic.segment.bytes = 104857600
	share.coordinator.threads = 1
	share.coordinator.write.timeout.ms = 5000
	share.fetch.max.fetch.records = 2147483647
	share.fetch.purgatory.purge.interval.requests = 1000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	socket.listen.backlog.size = 50
	socket.receive.buffer.bytes = 102400
	socket.request.max.bytes = 104857600
	socket.send.buffer.bytes = 102400
	ssl.allow.dn.changes = false
	ssl.allow.san.changes = false
	ssl.cipher.suites = []
	ssl.client.auth = required
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = 
	ssl.engine.factory.class = null
	ssl.key.password = [hidden]
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.keystore.jks
	ssl.keystore.password = [hidden]
	ssl.keystore.type = JKS
	ssl.principal.mapping.rules = DEFAULT
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.truststore.jks
	ssl.truststore.password = [hidden]
	ssl.truststore.type = JKS
	telemetry.max.bytes = 1048576
	transaction.abort.timed.out.transaction.cleanup.interval.ms = 10000
	transaction.max.timeout.ms = 900000
	transaction.partition.verification.enable = true
	transaction.remove.expired.transaction.cleanup.interval.ms = 3600000
	transaction.state.log.load.buffer.size = 5242880
	transaction.state.log.min.isr = 2
	transaction.state.log.num.partitions = 50
	transaction.state.log.replication.factor = 3
	transaction.state.log.segment.bytes = 104857600
	transactional.id.expiration.ms = 604800000
	unclean.leader.election.enable = false
	unclean.leader.election.interval.ms = 300000
	unstable.api.versions.enable = false
	unstable.feature.versions.enable = false
 (org.apache.kafka.common.config.AbstractConfig)
[2025-05-29 17:08:17,046] INFO [BrokerLifecycleManager id=2] The broker is in RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:17,076] INFO [BrokerServer id=2] Waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:08:17,131] INFO [BrokerLifecycleManager id=2] The broker has been unfenced. Transitioning from RECOVERY to RUNNING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:17,132] INFO [BrokerServer id=2] Finished waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:08:17,136] INFO authorizerStart completed for endpoint SSL. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:08:17,137] INFO [SocketServer listenerType=BROKER, nodeId=2] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:08:17,138] INFO Awaiting socket connections on 0.0.0.0:9095. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:08:17,140] INFO [BrokerServer id=2] Waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:08:17,140] INFO [BrokerServer id=2] Finished waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:08:17,140] INFO [BrokerServer id=2] Waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:08:17,141] INFO [BrokerServer id=2] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:08:17,141] INFO [BrokerServer id=2] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-29 17:08:17,143] INFO Kafka version: 4.0.0 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:08:17,143] INFO Kafka commitId: 985bc99521dd22bb (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:08:17,143] INFO Kafka startTimeMs: 1748527697142 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:08:17,146] INFO [KafkaRaftServer nodeId=2] Kafka Server started (kafka.server.KafkaRaftServer)
[2025-05-29 17:08:18,271] INFO [BrokerLifecycleManager id=3] Successfully registered broker 3 with broker epoch 79176 (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:18,278] INFO [BrokerLifecycleManager id=3] The broker has caught up. Transitioning from STARTING to RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:18,278] INFO [BrokerServer id=3] Finished waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:08:18,278] INFO [BrokerServer id=3] Waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:08:18,278] INFO [BrokerServer id=3] Finished waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:08:18,282] INFO KafkaConfig values: 
	add.partitions.to.txn.retry.backoff.max.ms = 100
	add.partitions.to.txn.retry.backoff.ms = 20
	advertised.listeners = SSL://172.23.38.230:9097
	alter.config.policy.class.name = null
	alter.log.dirs.replication.quota.window.num = 11
	alter.log.dirs.replication.quota.window.size.seconds = 1
	authorizer.class.name = 
	auto.create.topics.enable = true
	auto.leader.rebalance.enable = true
	background.threads = 10
	broker.heartbeat.interval.ms = 2000
	broker.id = 3
	broker.rack = null
	broker.session.timeout.ms = 9000
	client.quota.callback.class = null
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = producer
	compression.zstd.level = 3
	connection.failed.authentication.delay.ms = 100
	connections.max.idle.ms = 600000
	connections.max.reauth.ms = 0
	controlled.shutdown.enable = true
	controller.listener.names = CONTROLLER
	controller.performance.always.log.threshold.ms = 2000
	controller.performance.sample.period.ms = 60000
	controller.quorum.append.linger.ms = 25
	controller.quorum.bootstrap.servers = []
	controller.quorum.election.backoff.max.ms = 1000
	controller.quorum.election.timeout.ms = 1000
	controller.quorum.fetch.timeout.ms = 2000
	controller.quorum.request.timeout.ms = 2000
	controller.quorum.retry.backoff.ms = 20
	controller.quorum.voters = [1@localhost:9093, 2@localhost:9096, 3@localhost:9099]
	controller.quota.window.num = 11
	controller.quota.window.size.seconds = 1
	controller.socket.timeout.ms = 30000
	create.topic.policy.class.name = null
	default.replication.factor = 3
	delegation.token.expiry.check.interval.ms = 3600000
	delegation.token.expiry.time.ms = 86400000
	delegation.token.max.lifetime.ms = 604800000
	delegation.token.secret.key = null
	delete.records.purgatory.purge.interval.requests = 1
	delete.topic.enable = true
	early.start.listeners = null
	fetch.max.bytes = 57671680
	fetch.purgatory.purge.interval.requests = 1000
	group.consumer.assignors = [uniform, range]
	group.consumer.heartbeat.interval.ms = 5000
	group.consumer.max.heartbeat.interval.ms = 15000
	group.consumer.max.session.timeout.ms = 60000
	group.consumer.max.size = 2147483647
	group.consumer.migration.policy = bidirectional
	group.consumer.min.heartbeat.interval.ms = 5000
	group.consumer.min.session.timeout.ms = 45000
	group.consumer.session.timeout.ms = 45000
	group.coordinator.append.linger.ms = 5
	group.coordinator.new.enable = true
	group.coordinator.rebalance.protocols = [classic, consumer]
	group.coordinator.threads = 4
	group.initial.rebalance.delay.ms = 3000
	group.max.session.timeout.ms = 1800000
	group.max.size = 2147483647
	group.min.session.timeout.ms = 6000
	group.share.delivery.count.limit = 5
	group.share.enable = false
	group.share.heartbeat.interval.ms = 5000
	group.share.max.groups = 10
	group.share.max.heartbeat.interval.ms = 15000
	group.share.max.record.lock.duration.ms = 60000
	group.share.max.session.timeout.ms = 60000
	group.share.max.size = 200
	group.share.min.heartbeat.interval.ms = 5000
	group.share.min.record.lock.duration.ms = 15000
	group.share.min.session.timeout.ms = 45000
	group.share.partition.max.record.locks = 200
	group.share.persister.class.name = org.apache.kafka.server.share.persister.DefaultStatePersister
	group.share.record.lock.duration.ms = 30000
	group.share.session.timeout.ms = 45000
	initial.broker.registration.timeout.ms = 60000
	inter.broker.listener.name = SSL
	kafka.metrics.polling.interval.secs = 10
	kafka.metrics.reporters = []
	leader.imbalance.check.interval.seconds = 300
	listener.security.protocol.map = SSL:SSL,CONTROLLER:SSL
	listeners = SSL://0.0.0.0:9097,CONTROLLER://:9099
	log.cleaner.backoff.ms = 15000
	log.cleaner.dedupe.buffer.size = 134217728
	log.cleaner.delete.retention.ms = 86400000
	log.cleaner.enable = true
	log.cleaner.io.buffer.load.factor = 0.9
	log.cleaner.io.buffer.size = 524288
	log.cleaner.io.max.bytes.per.second = 1.7976931348623157E308
	log.cleaner.max.compaction.lag.ms = 9223372036854775807
	log.cleaner.min.cleanable.ratio = 0.5
	log.cleaner.min.compaction.lag.ms = 0
	log.cleaner.threads = 1
	log.cleanup.policy = [delete]
	log.dir = /tmp/kafka-logs
	log.dir.failure.timeout.ms = 30000
	log.dirs = /home/ammar/kafka_data/broker3_4.0.0
	log.flush.interval.messages = 9223372036854775807
	log.flush.interval.ms = null
	log.flush.offset.checkpoint.interval.ms = 60000
	log.flush.scheduler.interval.ms = 9223372036854775807
	log.flush.start.offset.checkpoint.interval.ms = 60000
	log.index.interval.bytes = 4096
	log.index.size.max.bytes = 10485760
	log.initial.task.delay.ms = 30000
	log.local.retention.bytes = -2
	log.local.retention.ms = -2
	log.message.timestamp.after.max.ms = 3600000
	log.message.timestamp.before.max.ms = 9223372036854775807
	log.message.timestamp.type = CreateTime
	log.preallocate = false
	log.retention.bytes = -1
	log.retention.check.interval.ms = 300000
	log.retention.hours = 168
	log.retention.minutes = null
	log.retention.ms = null
	log.roll.hours = 168
	log.roll.jitter.hours = 0
	log.roll.jitter.ms = null
	log.roll.ms = null
	log.segment.bytes = 1073741824
	log.segment.delete.delay.ms = 60000
	max.connection.creation.rate = 2147483647
	max.connections = 2147483647
	max.connections.per.ip = 2147483647
	max.connections.per.ip.overrides = 
	max.incremental.fetch.session.cache.slots = 1000
	max.request.partition.size.limit = 2000
	message.max.bytes = 1048588
	metadata.log.dir = null
	metadata.log.max.record.bytes.between.snapshots = 20971520
	metadata.log.max.snapshot.interval.ms = 3600000
	metadata.log.segment.bytes = 1073741824
	metadata.log.segment.min.bytes = 8388608
	metadata.log.segment.ms = 604800000
	metadata.max.idle.interval.ms = 500
	metadata.max.retention.bytes = 104857600
	metadata.max.retention.ms = 604800000
	metric.reporters = [org.apache.kafka.common.metrics.JmxReporter]
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	min.insync.replicas = 2
	node.id = 3
	num.io.threads = 8
	num.network.threads = 3
	num.partitions = 1
	num.recovery.threads.per.data.dir = 1
	num.replica.alter.log.dirs.threads = null
	num.replica.fetchers = 1
	offset.metadata.max.bytes = 4096
	offsets.commit.timeout.ms = 5000
	offsets.load.buffer.size = 5242880
	offsets.retention.check.interval.ms = 600000
	offsets.retention.minutes = 10080
	offsets.topic.compression.codec = 0
	offsets.topic.num.partitions = 50
	offsets.topic.replication.factor = 3
	offsets.topic.segment.bytes = 104857600
	principal.builder.class = class org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder
	process.roles = [broker, controller]
	producer.id.expiration.check.interval.ms = 600000
	producer.id.expiration.ms = 86400000
	producer.purgatory.purge.interval.requests = 1000
	queued.max.request.bytes = -1
	queued.max.requests = 500
	quota.window.num = 11
	quota.window.size.seconds = 1
	remote.fetch.max.wait.ms = 500
	remote.list.offsets.request.timeout.ms = 30000
	remote.log.index.file.cache.total.size.bytes = 1073741824
	remote.log.manager.copier.thread.pool.size = 10
	remote.log.manager.copy.max.bytes.per.second = 9223372036854775807
	remote.log.manager.copy.quota.window.num = 11
	remote.log.manager.copy.quota.window.size.seconds = 1
	remote.log.manager.expiration.thread.pool.size = 10
	remote.log.manager.fetch.max.bytes.per.second = 9223372036854775807
	remote.log.manager.fetch.quota.window.num = 11
	remote.log.manager.fetch.quota.window.size.seconds = 1
	remote.log.manager.task.interval.ms = 30000
	remote.log.manager.task.retry.backoff.max.ms = 30000
	remote.log.manager.task.retry.backoff.ms = 500
	remote.log.manager.task.retry.jitter = 0.2
	remote.log.manager.thread.pool.size = 2
	remote.log.metadata.custom.metadata.max.bytes = 128
	remote.log.metadata.manager.class.name = org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager
	remote.log.metadata.manager.class.path = null
	remote.log.metadata.manager.impl.prefix = rlmm.config.
	remote.log.metadata.manager.listener.name = null
	remote.log.reader.max.pending.tasks = 100
	remote.log.reader.threads = 10
	remote.log.storage.manager.class.name = null
	remote.log.storage.manager.class.path = null
	remote.log.storage.manager.impl.prefix = rsm.config.
	remote.log.storage.system.enable = false
	replica.fetch.backoff.ms = 1000
	replica.fetch.max.bytes = 1048576
	replica.fetch.min.bytes = 1
	replica.fetch.response.max.bytes = 10485760
	replica.fetch.wait.max.ms = 500
	replica.high.watermark.checkpoint.interval.ms = 5000
	replica.lag.time.max.ms = 30000
	replica.selector.class = null
	replica.socket.receive.buffer.bytes = 65536
	replica.socket.timeout.ms = 30000
	replication.quota.window.num = 11
	replication.quota.window.size.seconds = 1
	request.timeout.ms = 30000
	sasl.client.callback.handler.class = null
	sasl.enabled.mechanisms = [GSSAPI]
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.principal.to.local.rules = [DEFAULT]
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism.controller.protocol = GSSAPI
	sasl.mechanism.inter.broker.protocol = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	sasl.server.callback.handler.class = null
	sasl.server.max.receive.size = 524288
	security.inter.broker.protocol = PLAINTEXT
	security.providers = null
	server.max.startup.time.ms = 9223372036854775807
	share.coordinator.append.linger.ms = 10
	share.coordinator.load.buffer.size = 5242880
	share.coordinator.snapshot.update.records.per.snapshot = 500
	share.coordinator.state.topic.compression.codec = 0
	share.coordinator.state.topic.min.isr = 2
	share.coordinator.state.topic.num.partitions = 50
	share.coordinator.state.topic.prune.interval.ms = 300000
	share.coordinator.state.topic.replication.factor = 3
	share.coordinator.state.topic.segment.bytes = 104857600
	share.coordinator.threads = 1
	share.coordinator.write.timeout.ms = 5000
	share.fetch.max.fetch.records = 2147483647
	share.fetch.purgatory.purge.interval.requests = 1000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	socket.listen.backlog.size = 50
	socket.receive.buffer.bytes = 102400
	socket.request.max.bytes = 104857600
	socket.send.buffer.bytes = 102400
	ssl.allow.dn.changes = false
	ssl.allow.san.changes = false
	ssl.cipher.suites = []
	ssl.client.auth = required
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = 
	ssl.engine.factory.class = null
	ssl.key.password = [hidden]
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.keystore.jks
	ssl.keystore.password = [hidden]
	ssl.keystore.type = JKS
	ssl.principal.mapping.rules = DEFAULT
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.truststore.jks
	ssl.truststore.password = [hidden]
	ssl.truststore.type = JKS
	telemetry.max.bytes = 1048576
	transaction.abort.timed.out.transaction.cleanup.interval.ms = 10000
	transaction.max.timeout.ms = 900000
	transaction.partition.verification.enable = true
	transaction.remove.expired.transaction.cleanup.interval.ms = 3600000
	transaction.state.log.load.buffer.size = 5242880
	transaction.state.log.min.isr = 2
	transaction.state.log.num.partitions = 50
	transaction.state.log.replication.factor = 3
	transaction.state.log.segment.bytes = 104857600
	transactional.id.expiration.ms = 604800000
	unclean.leader.election.enable = false
	unclean.leader.election.interval.ms = 300000
	unstable.api.versions.enable = false
	unstable.feature.versions.enable = false
 (org.apache.kafka.common.config.AbstractConfig)
[2025-05-29 17:08:18,290] INFO [BrokerServer id=3] Waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:08:18,292] INFO [BrokerLifecycleManager id=3] The broker is in RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:18,341] INFO [BrokerLifecycleManager id=3] The broker has been unfenced. Transitioning from RECOVERY to RUNNING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:08:18,341] INFO [BrokerServer id=3] Finished waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:08:18,342] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:18,343] INFO authorizerStart completed for endpoint SSL. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:08:18,343] INFO [SocketServer listenerType=BROKER, nodeId=3] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:08:18,344] INFO Awaiting socket connections on 0.0.0.0:9097. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:08:18,346] INFO [BrokerServer id=3] Waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:08:18,346] INFO [BrokerServer id=3] Finished waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:08:18,346] INFO [BrokerServer id=3] Waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:08:18,347] INFO [BrokerServer id=3] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:08:18,347] INFO [BrokerServer id=3] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-29 17:08:18,348] INFO Kafka version: 4.0.0 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:08:18,348] INFO Kafka commitId: 985bc99521dd22bb (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:08:18,348] INFO Kafka startTimeMs: 1748527698347 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:08:18,351] INFO [KafkaRaftServer nodeId=3] Kafka Server started (kafka.server.KafkaRaftServer)
[2025-05-29 17:08:18,506] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:18,509] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:18,610] INFO [ReplicaFetcherThread-0-3]: Starting (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:18,612] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Truncating partition my-topic-0 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:18,612] INFO [UnifiedLog partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:08:18,613] INFO [ReplicaFetcherManager on broker 1] Added fetcher to broker 3 for partitions HashMap(my-topic-0 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),22,0), my-topic-1 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),20,0), my-topic-2 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),21,0)) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:18,614] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Truncating partition my-topic-1 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:18,615] INFO [UnifiedLog partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:08:18,616] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Truncating partition my-topic-2 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:18,616] INFO [UnifiedLog partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:08:18,660] INFO [ReplicaFetcherThread-0-3]: Starting (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:08:18,676] INFO [ReplicaFetcherManager on broker 2] Added fetcher to broker 3 for partitions HashMap(my-topic-0 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),22,0), my-topic-1 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),20,0), my-topic-2 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),21,0)) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:18,835] INFO [NodeToControllerChannelManager id=3 name=alter-partition] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:18,836] INFO [broker-3-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:08:18,933] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:19,007] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:19,011] INFO [Partition my-topic-1 broker=3] ISR updated to 3,1  and version updated to 51 (kafka.cluster.Partition)
[2025-05-29 17:08:19,012] INFO [Partition my-topic-2 broker=3] ISR updated to 3,1  and version updated to 52 (kafka.cluster.Partition)
[2025-05-29 17:08:19,365] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:19,368] INFO [Partition my-topic-0 broker=3] ISR updated to 3,1,2  and version updated to 53 (kafka.cluster.Partition)
[2025-05-29 17:08:19,455] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:08:55,548] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:08:55,549] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 79340 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,550] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 79340 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,551] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,551] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,553] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=499, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1758, highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=499, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,553] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=499, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1758, highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=499, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,554] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=499, voters=[1, 2, 3], electionTimeoutMs=1674, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=499, epochStartOffset=79141, highWatermark=Optional[LogOffsetMetadata(offset=79340, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674271)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79340, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674271)])], lastFetchTimestamp=1748527732430, lastCaughtUpTimestamp=1748527732430, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79340, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674271)])], lastFetchTimestamp=1748527732429, lastCaughtUpTimestamp=1748527732429, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79340, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674271)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,555] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=499, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=true)])]) with epoch 499 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,556] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=499, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=true)])]) with epoch 499 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,556] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=499, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=true)])]) with epoch 499 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,556] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=499, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=true)])]) with epoch 499 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,559] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1099) from ProspectiveState(epoch=499, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1758, highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,560] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1668) from ProspectiveState(epoch=499, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1758, highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,580] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1099) from ProspectiveState(epoch=499, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1758, highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,580] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1668) from ProspectiveState(epoch=499, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1758, highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,583] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=500, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=false)])]) with epoch 500 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,583] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=499, voters=[1, 2, 3], electionTimeoutMs=1674, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,584] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=500, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=false)])]) with epoch 500 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,598] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=499, voters=[1, 2, 3], electionTimeoutMs=1674, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,599] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1540, highWatermark=Optional.empty) from UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,626] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1540, highWatermark=Optional.empty) from UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,627] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=500, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=false)])]) with epoch 500 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,627] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=500, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=499, lastOffset=79340, preVote=false)])]) with epoch 500 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,629] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=500, epochStartOffset=79340, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1099) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,629] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:08:55,643] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=500, epochStartOffset=79340, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1099) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,665] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=500, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1540, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,665] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=500, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1668) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,681] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=500, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=500, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1540, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,687] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=500, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=500, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79339, metadata=Optional.empty)], electionTimeoutMs=1668) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:08:55,721] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=79341, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674377)]) for the first time for epoch 500 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79341, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674377)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79341, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674377)])], lastFetchTimestamp=1748527735721, lastCaughtUpTimestamp=1748527735721, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79340, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2674271)])], lastFetchTimestamp=1748527735690, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:08:55,934] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=80, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=79338, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=80, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33094-2-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2583dcc9]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:08:55,947] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:55,948] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:08:56,223] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=79341, metadata=Optional.empty)] for the first time for epoch 500 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:08:57,092] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=91, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=79341, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=91, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:60730-0-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@47f65040]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:08:57,093] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:57,094] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:08:57,570] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=355, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=79343, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=355, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33078-1-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5b179295]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:08:57,572] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:08:57,573] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:09:59,235] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:09:59,236] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=500, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1993, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=500, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,237] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:09:59,237] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 296 due to node 1 being disconnected (elapsed time since creation: 3148ms, elapsed time since send: 3148ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:09:59,237] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:09:59,239] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=500, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1911, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=500, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,239] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=500, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=500, lastOffset=79460, preVote=true)])]) with epoch 500 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:09:59,240] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:09:59,240] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 79460 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:09:59,241] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 79460 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:09:59,241] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:09:59,242] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=501, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], electionTimeoutMs=1317) from ProspectiveState(epoch=500, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1993, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,242] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=500, voters=[1, 2, 3], electionTimeoutMs=1173, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=500, epochStartOffset=79340, highWatermark=Optional[LogOffsetMetadata(offset=79460, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2682945)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79460, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2682945)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79460, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2682945)])], lastFetchTimestamp=1748527796093, lastCaughtUpTimestamp=1748527796093, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79460, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2682945)])], lastFetchTimestamp=1748527796090, lastCaughtUpTimestamp=1748527796090, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,245] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 348 due to node 1 being disconnected (elapsed time since creation: 3148ms, elapsed time since send: 3148ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:09:59,261] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=501, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], electionTimeoutMs=1317) from ProspectiveState(epoch=500, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1993, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,263] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1151, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=500, voters=[1, 2, 3], electionTimeoutMs=1173, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,264] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1886, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) from ProspectiveState(epoch=500, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1911, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,283] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1151, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=500, voters=[1, 2, 3], electionTimeoutMs=1173, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,284] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1886, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) from ProspectiveState(epoch=500, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1911, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,286] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1786, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1886, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,308] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1786, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1886, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,309] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=501, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=500, lastOffset=79460, preVote=false)])]) with epoch 501 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:09:59,310] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1668, highWatermark=Optional.empty) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1151, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,312] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=501, epochStartOffset=79460, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=501, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], electionTimeoutMs=1317) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,335] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=501, epochStartOffset=79460, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=501, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], electionTimeoutMs=1317) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,338] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1668, highWatermark=Optional.empty) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1151, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,339] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=501, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=500, lastOffset=79460, preVote=false)])]) with epoch 501 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:09:59,388] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=501, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1668, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,389] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=501, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1786, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,408] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=501, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1668, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,417] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=501, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=501, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1786, highWatermark=Optional[LogOffsetMetadata(offset=79459, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:09:59,444] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=79461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2683051)]) for the first time for epoch 501 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2683051)])], lastFetchTimestamp=1748527799443, lastCaughtUpTimestamp=1748527799443, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2683051)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79460, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2682945)])], lastFetchTimestamp=1748527799387, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:09:59,649] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=112, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=79458, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=112, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44372-0-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2b12b256]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:09:59,650] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:09:59,651] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:09:59,946] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=79461, metadata=Optional.empty)] for the first time for epoch 501 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:10:00,778] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=123, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=79462, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=123, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44384-1-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@69ce8ff0]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:10:00,779] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:10:00,781] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:10:01,259] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=387, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=79462, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=387, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:44390-2-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@64c61c8f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:10:01,260] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:10:01,261] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:10:32,183] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:10:32,184] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 79519 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,184] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 79519 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,185] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,186] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,186] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=501, voters=[1, 2, 3], electionTimeoutMs=1084, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=501, epochStartOffset=79460, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687227)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79519, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687227)])], lastFetchTimestamp=1748527828489, lastCaughtUpTimestamp=1748527828489, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79519, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687227)])], lastFetchTimestamp=1748527828489, lastCaughtUpTimestamp=1748527828489, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79519, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687227)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,186] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=501, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1656, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=501, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,186] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=501, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1215, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=501, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,188] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=501, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=true)])]) with epoch 501 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,189] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=501, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=true)])]) with epoch 501 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,189] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=501, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=true)])]) with epoch 501 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,189] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=501, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=true)])]) with epoch 501 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,191] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=502, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1838) from ProspectiveState(epoch=501, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1656, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,191] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=502, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1441) from ProspectiveState(epoch=501, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1215, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,216] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=502, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1838) from ProspectiveState(epoch=501, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1656, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,216] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=502, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1441) from ProspectiveState(epoch=501, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1215, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,219] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1051, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=501, voters=[1, 2, 3], electionTimeoutMs=1084, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,219] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=502, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=false)])]) with epoch 502 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,219] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=502, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=false)])]) with epoch 502 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,236] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1051, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=501, voters=[1, 2, 3], electionTimeoutMs=1084, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,236] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1044401567). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:10:32,237] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1170063118). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:10:32,237] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) from UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1051, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,238] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:10:32,258] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) from UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1051, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,259] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=502, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=false)])]) with epoch 502 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,259] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=502, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=false)])]) with epoch 502 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,261] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,261] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=502, epochStartOffset=79519, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=502, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1838) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,261] INFO [RaftManager id=2] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,262] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=502, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1571, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=502, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1441) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,265] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=502, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=true)])]) with epoch 502 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,267] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=503, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1330) from ProspectiveState(epoch=502, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1571, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,296] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=502, epochStartOffset=79519, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=502, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1838) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,313] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=503, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1330) from ProspectiveState(epoch=502, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1571, highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,315] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1896, highWatermark=Optional.empty) from UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,334] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1896, highWatermark=Optional.empty) from UnattachedState(epoch=502, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,335] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1098, highWatermark=Optional.empty) from UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1896, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,340] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:10:32,343] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=502, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=true)])]) with epoch 502 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,345] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=502, epochStartOffset=79519, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79520, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687333)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79519, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687227)])], lastFetchTimestamp=1748527832342, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,356] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1098, highWatermark=Optional.empty) from UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1896, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,357] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=503, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=false)])]) with epoch 503 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,362] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=404, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=79518, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=404, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:53868-2-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@72f7bd14]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:10:32,363] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=503, epochStartOffset=79519, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=503, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1330) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,363] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:10:32,364] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:10:32,384] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=502, epochStartOffset=79519, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79520, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687333)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79519, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687227)])], lastFetchTimestamp=1748527832342, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,385] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=503, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=501, lastOffset=79519, preVote=false)])]) with epoch 503 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,401] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=503, epochStartOffset=79519, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=503, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79519, metadata=Optional.empty)], electionTimeoutMs=1330) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,436] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=503, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,436] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=503, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1098, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,452] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=503, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,452] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=503, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=503, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1098, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:10:32,459] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to offset 79519 (kafka.log.UnifiedLog)
[2025-05-29 17:10:32,474] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 79519 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:10:32,474] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 79519 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:10:32,475] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=78971, file=/home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000078971.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:10:32,481] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 79519 with 0 producer ids in 6 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:10:32,482] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 7ms for segment recovery from offset 79519 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:10:32,482] INFO [RaftManager id=1] Truncated to offset 79519 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:10:32,484] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=129, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=79518, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=129, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:45724-2-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@44b47b4e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:10:32,485] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:10:32,487] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:10:32,508] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=79520, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687333)]) for the first time for epoch 503 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79520, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687333)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79520, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687333)])], lastFetchTimestamp=1748527832508, lastCaughtUpTimestamp=1748527832508, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79519, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2687227)])], lastFetchTimestamp=1748527832486, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:10:32,515] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:10:33,014] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=79520, metadata=Optional.empty)] for the first time for epoch 503 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:10:33,074] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=79520, metadata=Optional.empty)] for the first time for epoch 503 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:10:33,611] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=140, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=79520, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=140, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:45726-0-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@670256a7]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:10:33,612] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:10:33,613] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:12:17,886] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:12:17,886] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=503, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1033, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=503, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,888] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:12:17,888] INFO [RaftManager id=1] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:12:17,889] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 637 due to node 2 being disconnected (elapsed time since creation: 45307ms, elapsed time since send: 45306ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:12:17,889] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=503, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1673, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=503, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,891] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:12:17,891] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=503, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=503, lastOffset=79638, preVote=true)])]) with epoch 503 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:12:17,894] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:12:17,894] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 79638 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:12:17,894] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=504, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], electionTimeoutMs=1299) from ProspectiveState(epoch=503, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1033, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,894] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 488 due to node 2 being disconnected (elapsed time since creation: 45312ms, elapsed time since send: 45312ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:12:17,895] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 79638 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:12:17,897] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=503, voters=[1, 2, 3], electionTimeoutMs=1390, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=503, epochStartOffset=79519, highWatermark=Optional[LogOffsetMetadata(offset=79638, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695829)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79638, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695829)])], lastFetchTimestamp=1748527892582, lastCaughtUpTimestamp=1748527892582, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79638, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695829)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79638, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695829)])], lastFetchTimestamp=1748527892582, lastCaughtUpTimestamp=1748527892582, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,923] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=504, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], electionTimeoutMs=1299) from ProspectiveState(epoch=503, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1033, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,925] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1637, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) from ProspectiveState(epoch=503, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1673, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,926] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1360, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=503, voters=[1, 2, 3], electionTimeoutMs=1390, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,979] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1637, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) from ProspectiveState(epoch=503, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1673, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:17,980] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1717, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1637, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,000] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1360, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=503, voters=[1, 2, 3], electionTimeoutMs=1390, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,034] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1584, highWatermark=Optional.empty) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1360, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,076] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1717, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1637, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,077] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=504, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=503, lastOffset=79638, preVote=false)])]) with epoch 504 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:12:18,078] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=504, epochStartOffset=79638, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=504, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], electionTimeoutMs=1299) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,122] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1584, highWatermark=Optional.empty) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1360, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,128] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=504, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=503, lastOffset=79638, preVote=false)])]) with epoch 504 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:12:18,166] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=504, epochStartOffset=79638, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=504, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], electionTimeoutMs=1299) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,189] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=504, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1717, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,189] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=504, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1584, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,223] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=504, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1584, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,234] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=504, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=504, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1717, highWatermark=Optional[LogOffsetMetadata(offset=79637, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:12:18,273] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=79639, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695935)]) for the first time for epoch 504 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79639, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695935)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79639, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695935)])], lastFetchTimestamp=1748527938273, lastCaughtUpTimestamp=1748527938273, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79638, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2695829)])], lastFetchTimestamp=1748527938245, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:12:18,597] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=438, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=79638, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=438, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56670-2-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@71c4bdf4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:12:18,604] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:12:18,605] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:12:18,597] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=161, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=79637, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=161, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56654-1-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3df9c7e6]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:12:18,607] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:12:18,608] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:12:18,775] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=79639, metadata=Optional.empty)] for the first time for epoch 504 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:12:19,551] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=172, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=79639, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=172, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56684-0-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2066aa8]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:12:19,552] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:12:19,553] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:13:39,186] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,187] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=504, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1366, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=504, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,187] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,188] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=504, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1656, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=504, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,188] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:13:39,189] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 793 due to node 1 being disconnected (elapsed time since creation: 3168ms, elapsed time since send: 3168ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:13:39,189] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:13:39,190] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 736 due to node 1 being disconnected (elapsed time since creation: 3170ms, elapsed time since send: 3169ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:13:39,190] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=504, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=true)])]) with epoch 504 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,191] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:13:39,191] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=504, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=true)])]) with epoch 504 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,191] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 79877 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,192] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 79877 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,193] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=505, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1571) from ProspectiveState(epoch=504, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1366, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,193] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=505, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1319) from ProspectiveState(epoch=504, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1656, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,193] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=504, voters=[1, 2, 3], electionTimeoutMs=1673, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=504, epochStartOffset=79638, highWatermark=Optional[LogOffsetMetadata(offset=79877, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713071)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79877, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713071)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79877, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713071)])], lastFetchTimestamp=1748528016021, lastCaughtUpTimestamp=1748528016021, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79877, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713071)])], lastFetchTimestamp=1748528016020, lastCaughtUpTimestamp=1748528016020, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,221] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=505, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1319) from ProspectiveState(epoch=504, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1656, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,221] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=505, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1571) from ProspectiveState(epoch=504, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1366, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,223] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=505, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=false)])]) with epoch 505 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,223] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=505, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=false)])]) with epoch 505 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,224] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=504, voters=[1, 2, 3], electionTimeoutMs=1673, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,261] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=504, voters=[1, 2, 3], electionTimeoutMs=1673, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,261] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(937316373). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:13:39,294] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional.empty) from UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,353] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional.empty) from UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1642, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,353] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=505, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=false)])]) with epoch 505 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,354] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=505, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=false)])]) with epoch 505 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,355] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,355] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=505, epochStartOffset=79877, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=505, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1319) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,355] INFO [RaftManager id=2] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,356] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=505, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1200, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=505, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1571) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,357] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=505, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=true)])]) with epoch 505 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,360] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=506, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1080) from ProspectiveState(epoch=505, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1200, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,409] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=505, epochStartOffset=79877, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=505, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1319) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,409] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=506, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1080) from ProspectiveState(epoch=505, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1200, highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,411] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1293, highWatermark=Optional.empty) from UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,439] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1293, highWatermark=Optional.empty) from UnattachedState(epoch=505, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,440] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1387, highWatermark=Optional.empty) from UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1293, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,449] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=505, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=true)])]) with epoch 505 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,451] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1651, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=505, epochStartOffset=79877, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79877, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713071)])], lastFetchTimestamp=1748528019449, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79878, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713177)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,519] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1387, highWatermark=Optional.empty) from UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1293, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,520] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=506, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=false)])]) with epoch 506 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,522] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=506, epochStartOffset=79877, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=506, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1080) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,543] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1651, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=505, epochStartOffset=79877, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79877, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713071)])], lastFetchTimestamp=1748528019449, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79878, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713177)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,544] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=506, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=504, lastOffset=79877, preVote=false)])]) with epoch 506 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,551] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=506, epochStartOffset=79877, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=506, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79876, metadata=Optional.empty)], electionTimeoutMs=1080) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,574] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=506, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1387, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,574] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=506, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1651, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,595] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=506, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1651, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,599] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 79877 (kafka.log.UnifiedLog)
[2025-05-29 17:13:39,600] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=506, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=506, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1387, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:13:39,603] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 79877 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:13:39,604] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 79877 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:13:39,604] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=79052, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000079052.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:13:39,622] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 79877 with 0 producer ids in 18 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:13:39,623] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 18ms for segment recovery from offset 79877 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:13:39,623] INFO [RaftManager id=3] Truncated to offset 79877 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:13:39,643] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=79878, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713177)]) for the first time for epoch 506 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79878, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713177)])], lastFetchTimestamp=1748528019643, lastCaughtUpTimestamp=1748528019643, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79878, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713177)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79877, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2713071)])], lastFetchTimestamp=1748528019626, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:13:40,131] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=500, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=79876, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=500, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:53006-0-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@194433b7]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:13:40,131] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:13:40,132] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:13:40,139] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=223, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=79877, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=223, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:53012-1-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4258444]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:13:40,140] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:13:40,141] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:13:40,147] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=79878, metadata=Optional.empty)] for the first time for epoch 506 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:13:40,160] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=79878, metadata=Optional.empty)] for the first time for epoch 506 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:13:41,072] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=234, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=79878, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=234, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:53018-2-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5a89747f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:13:41,074] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:13:41,075] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:14:11,927] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:14:11,927] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 79936 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,928] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 79936 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,928] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,929] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,929] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=506, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1543, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=506, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,929] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=506, voters=[1, 2, 3], electionTimeoutMs=1123, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=506, epochStartOffset=79877, highWatermark=Optional[LogOffsetMetadata(offset=79936, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717353)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79936, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717353)])], lastFetchTimestamp=1748528048707, lastCaughtUpTimestamp=1748528048707, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79936, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717353)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79936, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717353)])], lastFetchTimestamp=1748528048706, lastCaughtUpTimestamp=1748528048706, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,929] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=506, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1806, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=506, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,931] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=506, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=true)])]) with epoch 506 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,931] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=506, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=true)])]) with epoch 506 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,932] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=506, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=true)])]) with epoch 506 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,932] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=506, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=true)])]) with epoch 506 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,933] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=507, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1365) from ProspectiveState(epoch=506, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1543, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,934] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=507, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1484) from ProspectiveState(epoch=506, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1806, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,953] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=507, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1365) from ProspectiveState(epoch=506, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1543, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,955] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1096, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=506, voters=[1, 2, 3], electionTimeoutMs=1123, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,959] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=507, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1484) from ProspectiveState(epoch=506, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1806, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,960] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=507, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=false)])]) with epoch 507 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,960] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=507, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=false)])]) with epoch 507 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,970] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1096, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=506, voters=[1, 2, 3], electionTimeoutMs=1123, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,971] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(50050933). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:14:11,971] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional.empty) from UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1096, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,982] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional.empty) from UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1096, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,983] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=507, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=false)])]) with epoch 507 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,984] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=507, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=false)])]) with epoch 507 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,985] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,985] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,985] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=507, epochStartOffset=79936, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=507, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1365) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,986] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=507, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1365, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=507, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1484) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:11,988] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=507, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=true)])]) with epoch 507 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:11,991] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=508, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1775) from ProspectiveState(epoch=507, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1365, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,011] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=507, epochStartOffset=79936, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=507, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1365) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,019] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=508, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1775) from ProspectiveState(epoch=507, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1365, highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,021] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1119, highWatermark=Optional.empty) from UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,038] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1119, highWatermark=Optional.empty) from UnattachedState(epoch=507, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,039] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1827, highWatermark=Optional.empty) from UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1119, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,045] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=507, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=true)])]) with epoch 507 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:12,047] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1787, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=507, epochStartOffset=79936, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79936, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717353)])], lastFetchTimestamp=1748528052045, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79937, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717459)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,052] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1827, highWatermark=Optional.empty) from UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1119, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,052] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=508, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=false)])]) with epoch 508 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:12,054] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=508, epochStartOffset=79936, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=508, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1775) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,066] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1787, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=507, epochStartOffset=79936, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79936, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717353)])], lastFetchTimestamp=1748528052045, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79937, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717459)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,067] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=508, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=506, lastOffset=79936, preVote=false)])]) with epoch 508 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:12,075] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=508, epochStartOffset=79936, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=508, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=79935, metadata=Optional.empty)], electionTimeoutMs=1775) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,094] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=508, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1787, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,094] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=508, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1827, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,114] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=508, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1787, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,114] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=508, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=508, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1827, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:14:12,117] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 79936 (kafka.log.UnifiedLog)
[2025-05-29 17:14:12,118] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 79936 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:14:12,118] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 79936 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:14:12,118] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=79877, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000079877.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:14:12,132] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 79936 with 0 producer ids in 13 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:14:12,132] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 14ms for segment recovery from offset 79936 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:14:12,132] INFO [RaftManager id=3] Truncated to offset 79936 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:14:12,154] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=79937, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717459)]) for the first time for epoch 508 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79937, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717459)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79937, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717459)])], lastFetchTimestamp=1748528052154, lastCaughtUpTimestamp=1748528052154, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=79936, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2717353)])], lastFetchTimestamp=1748528052133, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:14:12,656] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=79937, metadata=Optional.empty)] for the first time for epoch 508 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:14:12,669] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=79937, metadata=Optional.empty)] for the first time for epoch 508 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:14:13,015] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=517, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=79937, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=517, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:46626-0-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@459e2f1b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:14:13,016] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:14:13,016] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=240, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=79936, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=240, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:46638-1-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@70f7be6c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:14:13,016] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:14:13,017] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:14:13,018] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:14:13,899] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=251, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=79938, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=251, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:46650-2-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@481b48c5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:14:13,899] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:14:13,900] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:14,302] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:14,303] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 996 due to node 1 being disconnected (elapsed time since creation: 44463ms, elapsed time since send: 44463ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:14,306] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:14,306] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 937 due to node 1 being disconnected (elapsed time since creation: 44463ms, elapsed time since send: 44463ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:14,367] INFO [RaftManager id=3] Hostname for node 1 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:15:14,373] INFO [RaftManager id=2] Hostname for node 1 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:15:47,020] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:15:47,020] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 80115 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,021] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 80115 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,022] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,023] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,023] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=508, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1372, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=508, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,022] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=508, voters=[1, 2, 3], electionTimeoutMs=1545, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=508, epochStartOffset=79936, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730275)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80115, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730275)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80115, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730275)])], lastFetchTimestamp=1748528143418, lastCaughtUpTimestamp=1748528143418, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80115, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730275)])], lastFetchTimestamp=1748528143420, lastCaughtUpTimestamp=1748528143420, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,023] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=508, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1094, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=508, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,025] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=508, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=true)])]) with epoch 508 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,025] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=508, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=true)])]) with epoch 508 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,026] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=508, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=true)])]) with epoch 508 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,028] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=509, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1421) from ProspectiveState(epoch=508, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1372, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,036] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=508, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=true)])]) with epoch 508 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,038] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=509, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1563) from ProspectiveState(epoch=508, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1094, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,054] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1494004460). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:15:47,054] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(1860522905). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:15:47,055] INFO [QuorumController id=1] failAll(NotControllerException): failing maybeFenceStaleBroker(30701786). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:15:47,055] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:47,057] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,106] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,107] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=509, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1421) from ProspectiveState(epoch=508, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1372, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,110] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1458, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=508, voters=[1, 2, 3], electionTimeoutMs=1545, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,126] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=509, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1563) from ProspectiveState(epoch=508, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1094, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,132] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=509, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=false)])]) with epoch 509 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,137] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=509, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=false)])]) with epoch 509 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,143] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=299, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80114, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=299, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:57466-1-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@57d44b4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:15:47,144] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:47,164] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1458, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=508, voters=[1, 2, 3], electionTimeoutMs=1545, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,165] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) from UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1458, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,177] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) from UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1458, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,177] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=509, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=false)])]) with epoch 509 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,178] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=509, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=false)])]) with epoch 509 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,179] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,180] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,180] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=509, epochStartOffset=80115, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=509, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1421) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,180] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=509, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1535, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=509, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1563) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,182] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=509, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=true)])]) with epoch 509 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,184] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=510, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1839) from ProspectiveState(epoch=509, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1535, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,221] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=509, epochStartOffset=80115, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=509, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1421) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,229] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=510, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1839) from ProspectiveState(epoch=509, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1535, highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,236] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1284, highWatermark=Optional.empty) from UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,263] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1284, highWatermark=Optional.empty) from UnattachedState(epoch=509, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,264] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1529, highWatermark=Optional.empty) from UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1284, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,273] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=509, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=true)])]) with epoch 509 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,274] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1713, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=509, epochStartOffset=80115, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80115, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730275)])], lastFetchTimestamp=1748528147272, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80116, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730381)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,291] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1529, highWatermark=Optional.empty) from UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1284, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,291] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=510, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=false)])]) with epoch 510 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,293] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=510, epochStartOffset=80115, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=510, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1839) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,308] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1713, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=509, epochStartOffset=80115, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80115, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730275)])], lastFetchTimestamp=1748528147272, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80116, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730381)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,309] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=510, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=508, lastOffset=80115, preVote=false)])]) with epoch 510 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,339] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=510, epochStartOffset=80115, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=510, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80115, metadata=Optional.empty)], electionTimeoutMs=1839) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,346] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,386] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=301, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80114, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=301, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:57728-2-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@11ad21a5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:15:47,388] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:47,391] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,432] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=510, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1713, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,432] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=510, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1529, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,444] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,466] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=510, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1529, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,466] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=510, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=510, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1713, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:15:47,474] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 80115 (kafka.log.UnifiedLog)
[2025-05-29 17:15:47,475] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 80115 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:15:47,475] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 80115 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:15:47,476] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=79141, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000079141.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:15:47,477] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=304, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80114, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=304, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:57730-0-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@47995923]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:15:47,478] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:47,479] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,521] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 80115 with 0 producer ids in 45 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:15:47,521] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 45ms for segment recovery from offset 80115 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:15:47,522] INFO [RaftManager id=2] Truncated to offset 80115 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:15:47,530] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,569] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=307, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80114, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=307, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:57736-1-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5d3c1d79]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:15:47,570] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:47,571] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,574] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=80116, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730381)]) for the first time for epoch 510 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80116, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730381)])], lastFetchTimestamp=1748528147574, lastCaughtUpTimestamp=1748528147574, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80116, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730381)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80115, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2730275)])], lastFetchTimestamp=1748528147523, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:15:47,621] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:47,979] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=564, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80114, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=564, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:57128-2-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4e89e60]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:15:47,980] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:47,980] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:15:48,077] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=80116, metadata=Optional.empty)] for the first time for epoch 510 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:15:48,094] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=80116, metadata=Optional.empty)] for the first time for epoch 510 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:15:48,280] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=287, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80115, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=287, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:57140-0-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4c9e8241]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:15:48,283] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:15:48,284] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:16:17,721] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:17,722] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 1141 due to node 3 being disconnected (elapsed time since creation: 44513ms, elapsed time since send: 44512ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:17,724] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:17,736] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 1136 due to node 3 being disconnected (elapsed time since creation: 44512ms, elapsed time since send: 44512ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:17,785] INFO [RaftManager id=2] Hostname for node 3 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:16:17,817] INFO [RaftManager id=1] Hostname for node 3 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:16:48,473] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:48,473] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 1207 due to node 3 being disconnected (elapsed time since creation: 44082ms, elapsed time since send: 44082ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:48,473] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:48,473] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 1205 due to node 3 being disconnected (elapsed time since creation: 44077ms, elapsed time since send: 44076ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:48,789] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:48,789] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:48,789] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=510, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1140, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=510, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,790] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=510, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1370, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=510, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,796] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=510, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=510, lastOffset=80234, preVote=true)])]) with epoch 510 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:48,805] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=511, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], electionTimeoutMs=1981) from ProspectiveState(epoch=510, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1370, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,833] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=511, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], electionTimeoutMs=1981) from ProspectiveState(epoch=510, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1370, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,835] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1095, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) from ProspectiveState(epoch=510, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1140, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,854] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1095, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) from ProspectiveState(epoch=510, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1140, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,855] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) from UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1095, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,904] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) from UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1095, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,904] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=511, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=510, lastOffset=80234, preVote=false)])]) with epoch 511 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:48,906] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=511, epochStartOffset=80234, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=511, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], electionTimeoutMs=1981) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,948] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=510, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=510, lastOffset=80234, preVote=true)])]) with epoch 510 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:48,949] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=510, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=510, lastOffset=80234, preVote=true)])]) with epoch 510 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:48,950] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1373, highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=510, epochStartOffset=80115, highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], lastFetchTimestamp=1748528208926, lastCaughtUpTimestamp=1748528208598, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], lastFetchTimestamp=1748528208926, lastCaughtUpTimestamp=1748528208586, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80235, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738949)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:48,958] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=511, epochStartOffset=80234, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=511, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], electionTimeoutMs=1981) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:49,006] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1373, highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=510, epochStartOffset=80115, highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], lastFetchTimestamp=1748528208926, lastCaughtUpTimestamp=1748528208598, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], lastFetchTimestamp=1748528208926, lastCaughtUpTimestamp=1748528208586, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80235, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738949)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:49,007] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=511, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=510, lastOffset=80234, preVote=false)])]) with epoch 511 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:49,011] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1968573796). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:16:49,011] INFO [QuorumController id=3] failAll(NotControllerException): failing maybeFenceStaleBroker(1762413209). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:16:49,070] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=511, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1373, highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:49,071] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=511, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:49,093] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=511, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1373, highWatermark=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:49,093] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=511, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=511, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1039, highWatermark=Optional[LogOffsetMetadata(offset=80233, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:16:49,096] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 80234 (kafka.log.UnifiedLog)
[2025-05-29 17:16:49,104] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 80234 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:16:49,105] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 80234 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:16:49,105] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=79936, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000079936.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:16:49,134] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 80234 with 0 producer ids in 29 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:16:49,135] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 30ms for segment recovery from offset 80234 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:16:49,135] INFO [RaftManager id=3] Truncated to offset 80234 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:16:49,261] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=80235, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738983)]) for the first time for epoch 511 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80235, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738983)])], lastFetchTimestamp=1748528209261, lastCaughtUpTimestamp=1748528209261, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80235, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738983)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80234, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2738877)])], lastFetchTimestamp=1748528209138, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:16:49,554] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=341, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80233, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=341, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:57740-2-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@307dade6]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:16:49,555] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:49,556] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:16:49,873] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=596, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80234, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=596, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:57752-0-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4305462]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:16:49,874] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:49,875] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:16:50,195] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=319, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80235, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=319, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:57758-1-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1326a515]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:16:50,196] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:16:50,197] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:17:21,556] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:17:21,557] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 80293 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,557] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 80293 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,558] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,558] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,559] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=511, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1967, highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=511, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,559] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=511, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1912, highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=511, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,560] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=511, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=true)])]) with epoch 511 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,561] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=511, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=true)])]) with epoch 511 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,562] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1986) from ProspectiveState(epoch=511, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1912, highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,562] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1003) from ProspectiveState(epoch=511, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1967, highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,563] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=511, voters=[1, 2, 3], electionTimeoutMs=1173, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=511, epochStartOffset=80234, highWatermark=Optional[LogOffsetMetadata(offset=80293, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743159)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80293, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743159)])], lastFetchTimestamp=1748528238322, lastCaughtUpTimestamp=1748528238322, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80293, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743159)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80293, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743159)])], lastFetchTimestamp=1748528238322, lastCaughtUpTimestamp=1748528238322, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,563] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=511, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=true)])]) with epoch 511 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,564] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=511, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=true)])]) with epoch 511 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,580] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1003) from ProspectiveState(epoch=511, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1967, highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,580] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1986) from ProspectiveState(epoch=511, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1912, highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,581] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=512, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=false)])]) with epoch 512 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,582] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=512, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=false)])]) with epoch 512 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,582] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=511, voters=[1, 2, 3], electionTimeoutMs=1173, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,596] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=511, voters=[1, 2, 3], electionTimeoutMs=1173, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,597] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(542690327). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:17:21,597] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1949, highWatermark=Optional.empty) from UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,607] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1949, highWatermark=Optional.empty) from UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,608] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=512, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=false)])]) with epoch 512 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,608] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=512, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=511, lastOffset=80293, preVote=false)])]) with epoch 512 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,609] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:21,610] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=512, epochStartOffset=80293, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1986) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,628] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=512, epochStartOffset=80293, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1986) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,659] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=512, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1003) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,659] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=512, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1949, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,696] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=512, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=512, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80292, metadata=Optional.empty)], electionTimeoutMs=1003) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,709] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=512, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=512, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1949, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:21,822] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=80294, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743265)]) for the first time for epoch 512 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80294, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743265)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80294, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743265)])], lastFetchTimestamp=1748528241821, lastCaughtUpTimestamp=1748528241821, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80293, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2743159)])], lastFetchTimestamp=1748528241713, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:17:22,350] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=80294, metadata=Optional.empty)] for the first time for epoch 512 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:17:22,419] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=358, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80293, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=358, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:46666-0-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@27de9fe5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:17:22,420] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:17:22,421] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:17:22,714] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=613, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80294, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=613, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:46674-1-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@69710ed4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:17:22,715] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:17:22,716] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:17:23,024] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=336, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80294, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=336, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:46676-2-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4dd6f630]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:17:23,025] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:17:23,026] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:17:45,977] INFO [NodeToControllerChannelManager id=2 name=registration] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:17:54,045] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:17:54,046] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 80352 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,046] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 80352 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,047] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,048] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,048] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=512, voters=[1, 2, 3], electionTimeoutMs=1743, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=512, epochStartOffset=80293, highWatermark=Optional[LogOffsetMetadata(offset=80352, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747441)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80352, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747441)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80352, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747441)])], lastFetchTimestamp=1748528270885, lastCaughtUpTimestamp=1748528270885, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80352, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747441)])], lastFetchTimestamp=1748528270885, lastCaughtUpTimestamp=1748528270885, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,048] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=512, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1919, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=512, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,049] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=512, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1894, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=512, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,050] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=512, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=true)])]) with epoch 512 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,051] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=513, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1136) from ProspectiveState(epoch=512, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1894, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,054] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=512, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=true)])]) with epoch 512 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,054] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=512, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=true)])]) with epoch 512 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,055] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=513, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1308) from ProspectiveState(epoch=512, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1919, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,117] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=513, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1136) from ProspectiveState(epoch=512, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1894, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,119] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1671, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=512, voters=[1, 2, 3], electionTimeoutMs=1743, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,129] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=513, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1308) from ProspectiveState(epoch=512, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1919, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,133] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=513, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=false)])]) with epoch 513 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,134] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=513, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=false)])]) with epoch 513 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,158] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1671, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=512, voters=[1, 2, 3], electionTimeoutMs=1743, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,159] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1844704697). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:17:54,159] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional.empty) from UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1671, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,206] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional.empty) from UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1671, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,206] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=513, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=false)])]) with epoch 513 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,207] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=513, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=false)])]) with epoch 513 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,208] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=513, epochStartOffset=80352, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=513, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1136) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,208] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,208] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,209] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=513, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1346, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=513, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1308) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,211] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=513, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=true)])]) with epoch 513 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,214] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=514, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1815) from ProspectiveState(epoch=513, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1346, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,266] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=513, epochStartOffset=80352, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=513, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1136) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,282] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=514, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1815) from ProspectiveState(epoch=513, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1346, highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,284] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=986, highWatermark=Optional.empty) from UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,307] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=986, highWatermark=Optional.empty) from UnattachedState(epoch=513, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,308] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1081, highWatermark=Optional.empty) from UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=986, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,317] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=513, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=true)])]) with epoch 513 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,319] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1424, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=513, epochStartOffset=80352, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80352, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747441)])], lastFetchTimestamp=1748528274317, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80353, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747547)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,340] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1081, highWatermark=Optional.empty) from UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=986, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,341] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=514, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=false)])]) with epoch 514 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,345] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=514, epochStartOffset=80352, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=514, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1815) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,373] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1424, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=513, epochStartOffset=80352, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80352, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747441)])], lastFetchTimestamp=1748528274317, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80353, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747547)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,374] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=514, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=512, lastOffset=80352, preVote=false)])]) with epoch 514 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,387] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=514, epochStartOffset=80352, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=514, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80351, metadata=Optional.empty)], electionTimeoutMs=1815) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,409] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=514, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1424, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,410] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=514, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1081, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,443] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=514, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1424, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,444] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=514, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=514, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1081, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:17:54,446] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 80352 (kafka.log.UnifiedLog)
[2025-05-29 17:17:54,447] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 80352 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:17:54,448] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 80352 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:17:54,448] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=80115, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000080115.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:17:54,493] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 80352 with 0 producer ids in 44 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:17:54,493] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 1ms for snapshot load and 44ms for segment recovery from offset 80352 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:17:54,495] INFO [RaftManager id=2] Truncated to offset 80352 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:17:54,526] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=80353, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747547)]) for the first time for epoch 514 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80353, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747547)])], lastFetchTimestamp=1748528274525, lastCaughtUpTimestamp=1748528274525, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80353, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747547)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80352, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2747441)])], lastFetchTimestamp=1748528274497, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:17:55,027] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=80353, metadata=Optional.empty)] for the first time for epoch 514 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:17:55,044] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=80353, metadata=Optional.empty)] for the first time for epoch 514 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:17:55,298] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=375, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80353, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=375, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:46208-2-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@ba8f721]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:17:55,299] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:17:55,300] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:17:55,485] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=630, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80352, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=630, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:46216-0-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3929af16]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:17:55,486] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:17:55,487] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:17:55,780] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=353, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80353, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=353, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:46218-1-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1c2aecc9]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:17:55,780] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:17:55,782] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:18:08,559] INFO [NodeToControllerChannelManager id=3 name=alter-partition] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:19:59,407] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:19:59,408] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=514, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1799, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=514, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,410] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:19:59,410] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 1601 due to node 3 being disconnected (elapsed time since creation: 3163ms, elapsed time since send: 3163ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:19:59,412] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=514, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=514, lastOffset=80591, preVote=true)])]) with epoch 514 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:19:59,412] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:19:59,413] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=514, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1005, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=514, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,414] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:19:59,414] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 1597 due to node 3 being disconnected (elapsed time since creation: 3166ms, elapsed time since send: 3166ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:19:59,416] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=514, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=514, lastOffset=80591, preVote=true)])]) with epoch 514 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:19:59,417] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=515, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], electionTimeoutMs=1401) from ProspectiveState(epoch=514, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1005, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,421] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:19:59,422] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 80591 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:19:59,422] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 80591 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:19:59,424] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=514, voters=[1, 2, 3], electionTimeoutMs=1743, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=514, epochStartOffset=80352, highWatermark=Optional[LogOffsetMetadata(offset=80591, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764683)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80591, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764683)])], lastFetchTimestamp=1748528396248, lastCaughtUpTimestamp=1748528396248, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80591, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764683)])], lastFetchTimestamp=1748528396247, lastCaughtUpTimestamp=1748528396247, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80591, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764683)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,436] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=515, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], electionTimeoutMs=1401) from ProspectiveState(epoch=514, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1005, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,438] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1728, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=514, voters=[1, 2, 3], electionTimeoutMs=1743, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,438] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1770, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) from ProspectiveState(epoch=514, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1799, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,451] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1728, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=514, voters=[1, 2, 3], electionTimeoutMs=1743, unackedVoters=[1], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,451] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1770, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) from ProspectiveState(epoch=514, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1799, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,452] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1959, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) from UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1770, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,464] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1959, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) from UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1770, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,465] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=515, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=514, lastOffset=80591, preVote=false)])]) with epoch 515 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:19:59,466] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=515, epochStartOffset=80591, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=515, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], electionTimeoutMs=1401) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,467] INFO [RaftManager id=2] Hostname for node 3 changed from DESKTOP-T3O0CHU.localdomain to localhost. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:19:59,502] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=515, epochStartOffset=80591, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=515, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], electionTimeoutMs=1401) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,522] INFO [RaftManager id=1] Hostname for node 3 changed from DESKTOP-T3O0CHU.localdomain to localhost. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:19:59,524] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=515, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1728, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,524] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=515, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1959, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,553] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=515, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1959, highWatermark=Optional[LogOffsetMetadata(offset=80590, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,558] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=515, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=515, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1728, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:19:59,588] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=80592, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764789)]) for the first time for epoch 515 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80592, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764789)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80592, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764789)])], lastFetchTimestamp=1748528399588, lastCaughtUpTimestamp=1748528399588, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80591, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2764683)])], lastFetchTimestamp=1748528399522, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:20:00,099] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=80592, metadata=Optional.empty)] for the first time for epoch 515 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:20:00,764] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=437, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80592, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=437, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:51782-0-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1e437854]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:20:00,765] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:20:00,766] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:20:01,125] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=692, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80593, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=692, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:51796-1-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6908c39b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:20:01,126] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:20:01,127] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:20:01,277] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=415, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80593, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=415, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:51806-2-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@44a6e2c8]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:20:01,278] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:20:01,279] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:20:32,282] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:20:32,282] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 80651 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,283] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 80651 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,283] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,284] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,284] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=515, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1653, highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=515, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,284] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=515, voters=[1, 2, 3], electionTimeoutMs=1097, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=515, epochStartOffset=80591, highWatermark=Optional[LogOffsetMetadata(offset=80651, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769037)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80651, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769037)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80651, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769037)])], lastFetchTimestamp=1748528429133, lastCaughtUpTimestamp=1748528429133, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80651, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769037)])], lastFetchTimestamp=1748528429132, lastCaughtUpTimestamp=1748528429132, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,285] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=515, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1305, highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=515, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,286] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=515, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=true)])]) with epoch 515 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,286] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=515, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=true)])]) with epoch 515 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,286] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=515, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=true)])]) with epoch 515 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,286] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=515, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=true)])]) with epoch 515 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,288] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1215) from ProspectiveState(epoch=515, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1653, highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,288] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1566) from ProspectiveState(epoch=515, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1305, highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,406] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1215) from ProspectiveState(epoch=515, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1653, highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,406] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1566) from ProspectiveState(epoch=515, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1305, highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,408] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=false)])]) with epoch 516 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,408] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=false)])]) with epoch 516 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,408] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=974, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=515, voters=[1, 2, 3], electionTimeoutMs=1097, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,508] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=974, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=515, voters=[1, 2, 3], electionTimeoutMs=1097, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,509] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1559, highWatermark=Optional.empty) from UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=974, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,553] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1559, highWatermark=Optional.empty) from UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=974, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,553] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=false)])]) with epoch 516 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,553] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=515, lastOffset=80651, preVote=false)])]) with epoch 516 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,554] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:20:32,555] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=516, epochStartOffset=80651, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1566) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,580] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=516, epochStartOffset=80651, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1566) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,599] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=516, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1559, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,599] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=516, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1215) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,624] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=516, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=516, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80650, metadata=Optional.empty)], electionTimeoutMs=1215) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,630] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=516, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=516, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1559, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:20:32,660] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=80652, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769143)]) for the first time for epoch 516 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80652, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769143)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80652, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769143)])], lastFetchTimestamp=1748528432659, lastCaughtUpTimestamp=1748528432659, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80651, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2769037)])], lastFetchTimestamp=1748528432632, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:20:33,165] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=80652, metadata=Optional.empty)] for the first time for epoch 516 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:20:33,572] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=454, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80651, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=454, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60772-2-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@49a9a402]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:20:33,572] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:20:33,573] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:20:33,969] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=709, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80652, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=709, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60774-0-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@613e44ed]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:20:33,970] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:20:33,971] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:20:34,081] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=432, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80653, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=432, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60778-1-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@f9f7076]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:20:34,082] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:20:34,082] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:21:04,947] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:21:04,947] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 80710 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,948] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 80710 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,948] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,949] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,949] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=516, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1953, highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=516, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:04,950] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=516, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1042, highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=516, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:04,950] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=516, voters=[1, 2, 3], electionTimeoutMs=1653, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=516, epochStartOffset=80651, highWatermark=Optional[LogOffsetMetadata(offset=80710, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773319)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80710, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773319)])], lastFetchTimestamp=1748528461719, lastCaughtUpTimestamp=1748528461719, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80710, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773319)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80710, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773319)])], lastFetchTimestamp=1748528461718, lastCaughtUpTimestamp=1748528461718, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:04,951] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=true)])]) with epoch 516 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,951] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=true)])]) with epoch 516 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,951] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=true)])]) with epoch 516 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,951] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=516, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=true)])]) with epoch 516 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,953] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1385) from ProspectiveState(epoch=516, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1953, highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:04,953] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1838) from ProspectiveState(epoch=516, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1042, highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:04,985] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1385) from ProspectiveState(epoch=516, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1953, highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:04,985] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1838) from ProspectiveState(epoch=516, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1042, highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:04,987] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=false)])]) with epoch 517 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,987] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=false)])]) with epoch 517 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:04,987] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1614, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=516, voters=[1, 2, 3], electionTimeoutMs=1653, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,063] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1614, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=516, voters=[1, 2, 3], electionTimeoutMs=1653, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,063] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(411065810). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:21:05,063] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1961, highWatermark=Optional.empty) from UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1614, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,089] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1961, highWatermark=Optional.empty) from UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1614, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,089] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=false)])]) with epoch 517 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:05,090] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=516, lastOffset=80710, preVote=false)])]) with epoch 517 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:05,090] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:05,091] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=517, epochStartOffset=80710, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1385) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,108] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=517, epochStartOffset=80710, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1385) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,132] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=517, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1961, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,132] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=517, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1838) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,146] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=517, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=517, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80709, metadata=Optional.empty)], electionTimeoutMs=1838) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,153] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=517, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=517, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1961, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:05,185] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=80711, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773425)]) for the first time for epoch 517 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80711, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773425)])], lastFetchTimestamp=1748528465185, lastCaughtUpTimestamp=1748528465185, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80711, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773425)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80710, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2773319)])], lastFetchTimestamp=1748528465155, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:21:05,691] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=80711, metadata=Optional.empty)] for the first time for epoch 517 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:21:06,387] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=471, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80712, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=471, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:55772-0-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6a7ae130]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:21:06,388] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:21:06,389] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:21:06,787] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=726, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80712, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=726, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:55786-1-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@230025ed]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:21:06,788] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:21:06,788] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:21:06,893] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=449, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80712, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=449, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:55788-2-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@415544bf]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:21:06,894] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:21:06,895] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:21:37,970] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:21:37,971] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 80770 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,971] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 80770 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,971] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,972] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,972] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=517, voters=[1, 2, 3], electionTimeoutMs=1825, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=517, epochStartOffset=80710, highWatermark=Optional[LogOffsetMetadata(offset=80770, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777673)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80770, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777673)])], lastFetchTimestamp=1748528494726, lastCaughtUpTimestamp=1748528494235, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80770, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777673)])], lastFetchTimestamp=1748528494726, lastCaughtUpTimestamp=1748528494234, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80770, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777673)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:37,972] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=517, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1974, highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=517, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:37,973] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=517, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1453, highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=517, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:37,974] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=true)])]) with epoch 517 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,974] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=true)])]) with epoch 517 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,974] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=true)])]) with epoch 517 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,975] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=517, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=true)])]) with epoch 517 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:37,975] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1485) from ProspectiveState(epoch=517, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1974, highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:37,976] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1894) from ProspectiveState(epoch=517, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1453, highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,001] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1894) from ProspectiveState(epoch=517, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1453, highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,001] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1485) from ProspectiveState(epoch=517, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1974, highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,002] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=518, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=false)])]) with epoch 518 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:38,002] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=518, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=false)])]) with epoch 518 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:38,002] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=517, voters=[1, 2, 3], electionTimeoutMs=1825, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,015] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=517, voters=[1, 2, 3], electionTimeoutMs=1825, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,015] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1783826587). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:21:38,015] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1669, highWatermark=Optional.empty) from UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,029] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1669, highWatermark=Optional.empty) from UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,029] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=518, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=false)])]) with epoch 518 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:38,030] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=518, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=517, lastOffset=80770, preVote=false)])]) with epoch 518 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:38,031] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:21:38,031] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=518, epochStartOffset=80770, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1894) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,053] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=518, epochStartOffset=80770, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1894) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,108] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=518, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1669, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,108] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=518, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1485) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,126] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=518, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=518, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1669, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,132] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=518, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=518, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80769, metadata=Optional.empty)], electionTimeoutMs=1485) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:21:38,174] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=80771, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777779)]) for the first time for epoch 518 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80771, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777779)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80771, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777779)])], lastFetchTimestamp=1748528498173, lastCaughtUpTimestamp=1748528498173, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80770, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2777673)])], lastFetchTimestamp=1748528498133, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:21:38,675] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=80771, metadata=Optional.empty)] for the first time for epoch 518 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:21:39,209] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=488, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80770, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=488, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:36216-2-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5774ceac]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:21:39,210] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:21:39,211] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:21:39,628] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=743, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80771, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=743, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:36218-0-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6613483d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:21:39,629] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:21:39,630] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:21:39,725] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=466, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80772, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=466, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:36230-1-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@79e5d31a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:21:39,726] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:21:39,727] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:10,508] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,509] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=518, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1517, highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=518, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,510] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=518, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=518, lastOffset=80830, preVote=true)])]) with epoch 518 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,511] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:22:10,512] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=518, voters=[1, 2, 3], electionTimeoutMs=1016, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=518, epochStartOffset=80770, highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2781955)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80829, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2781955)])], lastFetchTimestamp=1748528527220, lastCaughtUpTimestamp=1748528527220, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80830, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2782027)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80829, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2781955)])], lastFetchTimestamp=1748528527219, lastCaughtUpTimestamp=1748528527219, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,514] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,515] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=518, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1339, highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=518, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,516] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=518, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=518, lastOffset=80830, preVote=true)])]) with epoch 518 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,517] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=518, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=518, lastOffset=80830, preVote=true)])]) with epoch 518 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,517] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1763) from ProspectiveState(epoch=518, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1517, highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,519] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1967) from ProspectiveState(epoch=518, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1339, highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,537] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1763) from ProspectiveState(epoch=518, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1517, highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,539] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=989, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=518, voters=[1, 2, 3], electionTimeoutMs=1016, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,543] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1967) from ProspectiveState(epoch=518, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1339, highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,544] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=518, lastOffset=80830, preVote=false)])]) with epoch 519 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,545] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=518, lastOffset=80830, preVote=false)])]) with epoch 519 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,559] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=989, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=518, voters=[1, 2, 3], electionTimeoutMs=1016, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,560] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(317260992). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:22:10,560] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1029, highWatermark=Optional.empty) from UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=989, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,582] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1029, highWatermark=Optional.empty) from UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=989, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,582] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=518, lastOffset=80830, preVote=false)])]) with epoch 519 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,583] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=518, lastOffset=80830, preVote=false)])]) with epoch 519 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,584] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=519, epochStartOffset=80830, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1763) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,584] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:10,605] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=519, epochStartOffset=80830, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1763) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,624] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=519, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1029, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,625] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=519, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1967) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,641] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=519, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=519, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1029, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,653] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=519, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=519, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80829, metadata=Optional.empty)], electionTimeoutMs=1967) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:10,677] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=482, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80828, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=482, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:60082-2-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@b6f42c9]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:22:10,678] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:22:10,679] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:10,712] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=483, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80828, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=483, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38398-2-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@619912f3]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:22:10,712] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:22:10,714] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:10,719] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=80831, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2782133)]) for the first time for epoch 519 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80831, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2782133)])], lastFetchTimestamp=1748528530718, lastCaughtUpTimestamp=1748528530718, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80831, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2782133)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80830, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2782027)])], lastFetchTimestamp=1748528530654, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:22:10,765] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:11,220] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=80831, metadata=Optional.empty)] for the first time for epoch 519 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:22:12,017] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=505, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80832, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=505, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:60060-0-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@657fcb9d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:22:12,018] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:22:12,019] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:12,440] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=760, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80832, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=760, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:60070-1-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@792a90]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:22:12,441] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:22:12,442] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:43,384] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:22:43,384] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 80890 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,385] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 80890 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,385] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,386] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,386] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=519, voters=[1, 2, 3], electionTimeoutMs=1697, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=519, epochStartOffset=80830, highWatermark=Optional[LogOffsetMetadata(offset=80890, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786381)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80890, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786381)])], lastFetchTimestamp=1748528560261, lastCaughtUpTimestamp=1748528560261, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80890, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786381)])], lastFetchTimestamp=1748528560261, lastCaughtUpTimestamp=1748528560261, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80890, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786381)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,386] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=519, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1622, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=519, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,386] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=519, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1945, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=519, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,388] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=true)])]) with epoch 519 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,388] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=true)])]) with epoch 519 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,388] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=true)])]) with epoch 519 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,389] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=519, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=true)])]) with epoch 519 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,389] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=520, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1510) from ProspectiveState(epoch=519, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1622, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,390] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=520, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1485) from ProspectiveState(epoch=519, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1945, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,406] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=520, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1510) from ProspectiveState(epoch=519, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1622, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,406] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=520, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1485) from ProspectiveState(epoch=519, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1945, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,407] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=520, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=false)])]) with epoch 520 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,407] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=520, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=false)])]) with epoch 520 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,408] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1675, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=519, voters=[1, 2, 3], electionTimeoutMs=1697, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,420] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1675, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=519, voters=[1, 2, 3], electionTimeoutMs=1697, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,421] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1729, highWatermark=Optional.empty) from UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1675, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,432] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1729, highWatermark=Optional.empty) from UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1675, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,432] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=520, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=false)])]) with epoch 520 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,433] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=520, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=false)])]) with epoch 520 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,434] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,434] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=520, epochStartOffset=80890, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=520, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1485) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,434] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,435] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=520, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1925, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=520, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1510) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,436] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=520, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=true)])]) with epoch 520 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,438] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=521, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1809) from ProspectiveState(epoch=520, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1925, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,452] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=520, epochStartOffset=80890, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=520, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1485) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,456] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=521, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1809) from ProspectiveState(epoch=520, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1925, highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,457] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) from UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1729, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,476] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) from UnattachedState(epoch=520, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1729, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,476] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1247, highWatermark=Optional.empty) from UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,484] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=520, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=true)])]) with epoch 520 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,486] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1025, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=520, epochStartOffset=80890, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80891, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786487)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80890, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786381)])], lastFetchTimestamp=1748528563484, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,491] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1247, highWatermark=Optional.empty) from UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,491] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=521, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=false)])]) with epoch 521 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,494] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=521, epochStartOffset=80890, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=521, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1809) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,511] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1025, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=520, epochStartOffset=80890, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80891, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786487)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80890, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786381)])], lastFetchTimestamp=1748528563484, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,511] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=521, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=519, lastOffset=80890, preVote=false)])]) with epoch 521 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,515] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=521, epochStartOffset=80890, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=521, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80889, metadata=Optional.empty)], electionTimeoutMs=1809) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,532] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=521, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1025, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,532] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=521, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1247, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,545] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=521, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1247, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,545] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=521, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=521, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1025, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:22:43,547] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 80890 (kafka.log.UnifiedLog)
[2025-05-29 17:22:43,548] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 80890 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:22:43,548] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 80890 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:22:43,549] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=80352, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000080352.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:22:43,560] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 80890 with 0 producer ids in 11 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:22:43,560] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 11ms for segment recovery from offset 80890 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:22:43,560] INFO [RaftManager id=2] Truncated to offset 80890 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:22:43,577] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=80891, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786487)]) for the first time for epoch 521 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80891, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786487)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80891, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786487)])], lastFetchTimestamp=1748528563577, lastCaughtUpTimestamp=1748528563577, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80890, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2786381)])], lastFetchTimestamp=1748528563561, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:22:43,599] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=502, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80888, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=502, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38410-0-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5903656f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:22:43,600] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:22:43,601] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:44,079] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=80891, metadata=Optional.empty)] for the first time for epoch 521 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:22:44,091] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=80891, metadata=Optional.empty)] for the first time for epoch 521 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:22:44,827] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=522, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80891, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=522, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38418-1-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2a4ef29e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:22:44,828] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:22:44,829] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:22:45,245] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=777, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80893, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=777, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38434-2-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6483e15f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:22:45,246] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:22:45,247] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:16,247] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:23:16,247] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 80950 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,248] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 80950 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,248] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,249] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,249] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=521, voters=[1, 2, 3], electionTimeoutMs=1557, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=521, epochStartOffset=80890, highWatermark=Optional[LogOffsetMetadata(offset=80950, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790735)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80950, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790735)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80950, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790735)])], lastFetchTimestamp=1748528593124, lastCaughtUpTimestamp=1748528593124, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80950, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790735)])], lastFetchTimestamp=1748528593124, lastCaughtUpTimestamp=1748528593124, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,249] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=521, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1707, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=521, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,249] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=521, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1222, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=521, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,250] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=521, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=true)])]) with epoch 521 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,250] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=521, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=true)])]) with epoch 521 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,251] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=521, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=true)])]) with epoch 521 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,251] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=521, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=true)])]) with epoch 521 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,252] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=522, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1342) from ProspectiveState(epoch=521, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1707, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,252] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=522, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1956) from ProspectiveState(epoch=521, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1222, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,276] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=522, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1342) from ProspectiveState(epoch=521, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1707, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,278] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1528, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=521, voters=[1, 2, 3], electionTimeoutMs=1557, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,281] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=522, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1956) from ProspectiveState(epoch=521, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1222, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,282] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=522, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=false)])]) with epoch 522 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,283] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=522, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=false)])]) with epoch 522 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,299] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1528, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=521, voters=[1, 2, 3], electionTimeoutMs=1557, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,300] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1719, highWatermark=Optional.empty) from UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1528, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,311] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1719, highWatermark=Optional.empty) from UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1528, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,312] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=522, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=false)])]) with epoch 522 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,312] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=522, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=false)])]) with epoch 522 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,313] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,313] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,313] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=522, epochStartOffset=80950, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=522, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1342) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,314] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=522, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1294, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=522, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1956) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,315] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=522, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=true)])]) with epoch 522 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,317] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=523, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1050) from ProspectiveState(epoch=522, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1294, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,336] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=522, epochStartOffset=80950, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=522, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1342) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,344] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=523, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1050) from ProspectiveState(epoch=522, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1294, highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,346] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1673, highWatermark=Optional.empty) from UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1719, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,364] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=519, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80948, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=519, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:35518-2-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5e3c64af]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:23:16,365] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:16,366] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:16,371] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1673, highWatermark=Optional.empty) from UnattachedState(epoch=522, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1719, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,371] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1441, highWatermark=Optional.empty) from UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1673, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,387] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=522, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=true)])]) with epoch 522 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,389] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1101, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=522, epochStartOffset=80950, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80950, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790735)])], lastFetchTimestamp=1748528596386, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80951, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790841)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,393] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=520, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80948, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=520, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:45310-0-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@737e4886]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:23:16,394] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:16,399] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:16,411] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1441, highWatermark=Optional.empty) from UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1673, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,411] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=523, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=false)])]) with epoch 523 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,413] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=523, epochStartOffset=80950, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=523, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1050) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,448] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:16,457] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1101, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=522, epochStartOffset=80950, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80950, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790735)])], lastFetchTimestamp=1748528596386, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80951, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790841)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,461] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=523, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=521, lastOffset=80950, preVote=false)])]) with epoch 523 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,473] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=523, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80948, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=523, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:45316-1-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1133a1ee]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:23:16,478] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:16,596] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=523, epochStartOffset=80950, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=523, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=80949, metadata=Optional.empty)], electionTimeoutMs=1050) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,747] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=523, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1101, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,747] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=523, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1441, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,879] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=523, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1101, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,880] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 80950 (kafka.log.UnifiedLog)
[2025-05-29 17:23:16,883] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 80950 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:23:16,884] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 80950 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:23:16,884] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=80890, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000080890.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:23:16,886] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:16,917] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=523, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=523, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1441, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:23:16,929] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=525, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80948, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=525, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:41878-0-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@171ffbd5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:23:16,930] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:16,932] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:16,942] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 80950 with 0 producer ids in 57 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:23:16,954] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 70ms for segment recovery from offset 80950 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:23:16,955] INFO [RaftManager id=2] Truncated to offset 80950 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:23:16,982] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:17,042] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=528, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80948, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=528, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:41882-1-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@50b3fbf3]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:23:17,043] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:17,043] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:17,105] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:17,164] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=531, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=80948, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=531, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:41884-2-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@746755c9]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:23:17,165] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:17,166] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:17,178] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=80951, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790841)]) for the first time for epoch 523 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80951, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790841)])], lastFetchTimestamp=1748528597178, lastCaughtUpTimestamp=1748528597178, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80951, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790841)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=80950, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2790735)])], lastFetchTimestamp=1748528596960, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:23:17,220] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:17,597] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=539, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=80950, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=539, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:35520-0-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@76d8e5f5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:23:17,598] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:17,599] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:23:17,679] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=80951, metadata=Optional.empty)] for the first time for epoch 523 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:23:17,717] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=80951, metadata=Optional.empty)] for the first time for epoch 523 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:23:18,011] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=794, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=80950, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=794, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:35524-1-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@46659812]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:23:18,011] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:23:18,012] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:24:32,929] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:24:32,930] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 81008 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,930] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 81008 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,931] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,931] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,931] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=523, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1988, highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=523, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,931] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=523, voters=[1, 2, 3], electionTimeoutMs=1115, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=523, epochStartOffset=80950, highWatermark=Optional[LogOffsetMetadata(offset=81008, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2794945)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81008, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2794945)])], lastFetchTimestamp=1748528625724, lastCaughtUpTimestamp=1748528625724, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81008, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2794945)])], lastFetchTimestamp=1748528625726, lastCaughtUpTimestamp=1748528625726, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81008, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2794945)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,932] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=523, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1606, highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=523, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,934] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=523, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=true)])]) with epoch 523 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,934] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=523, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=true)])]) with epoch 523 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,934] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=523, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=true)])]) with epoch 523 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,934] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=523, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=true)])]) with epoch 523 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,935] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1579) from ProspectiveState(epoch=523, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1988, highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,936] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1619) from ProspectiveState(epoch=523, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1606, highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,950] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1619) from ProspectiveState(epoch=523, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1606, highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,950] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1579) from ProspectiveState(epoch=523, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1988, highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,953] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=524, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=false)])]) with epoch 524 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,953] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=524, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=false)])]) with epoch 524 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,953] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1092, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=523, voters=[1, 2, 3], electionTimeoutMs=1115, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,966] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1092, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=523, voters=[1, 2, 3], electionTimeoutMs=1115, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,966] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1349, highWatermark=Optional.empty) from UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1092, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,966] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(2100670755). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:24:32,978] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1349, highWatermark=Optional.empty) from UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1092, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,978] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=524, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=false)])]) with epoch 524 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,979] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=524, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=523, lastOffset=81008, preVote=false)])]) with epoch 524 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,980] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:24:32,980] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=524, epochStartOffset=81008, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1579) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:32,994] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=524, epochStartOffset=81008, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1579) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:33,017] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=524, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1619) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:33,017] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=524, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1349, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:33,029] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=524, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=524, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81007, metadata=Optional.empty)], electionTimeoutMs=1619) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:33,029] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=524, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=524, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1349, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:24:33,052] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=81009, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2795051)]) for the first time for epoch 524 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81009, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2795051)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81009, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2795051)])], lastFetchTimestamp=1748528673052, lastCaughtUpTimestamp=1748528673052, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81008, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2794945)])], lastFetchTimestamp=1748528673030, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:24:33,554] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=81009, metadata=Optional.empty)] for the first time for epoch 524 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:24:34,030] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=550, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81008, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=550, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:41900-0-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@604fb9e4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:24:34,031] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:24:34,032] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:24:34,371] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=556, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81009, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=556, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:41904-1-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@39ecab2]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:24:34,371] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:24:34,372] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:24:34,788] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=811, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81011, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=811, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:41916-2-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5fdd05bc]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:24:34,789] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:24:34,790] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:24:50,348] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:24:50,348] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 2126 due to node 1 being disconnected (elapsed time since creation: 44496ms, elapsed time since send: 44496ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:24:50,354] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:24:50,355] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 2196 due to node 1 being disconnected (elapsed time since creation: 44497ms, elapsed time since send: 44497ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:21,209] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:21,210] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:21,210] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 2199 due to node 1 being disconnected (elapsed time since creation: 44187ms, elapsed time since send: 44186ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:21,210] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 2263 due to node 1 being disconnected (elapsed time since creation: 44189ms, elapsed time since send: 44189ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:54,072] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:25:54,072] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 81247 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,073] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 81247 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,073] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=524, voters=[1, 2, 3], electionTimeoutMs=1602, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=524, epochStartOffset=81008, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812187)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81247, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812187)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81247, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812187)])], lastFetchTimestamp=1748528750652, lastCaughtUpTimestamp=1748528750652, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81247, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812187)])], lastFetchTimestamp=1748528750653, lastCaughtUpTimestamp=1748528750653, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,075] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,075] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,075] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=524, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1356, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=524, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,077] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=524, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=true)])]) with epoch 524 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,078] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=525, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1457) from ProspectiveState(epoch=524, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1356, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,098] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=524, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1735, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=524, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,100] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=524, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=true)])]) with epoch 524 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,101] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=524, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=true)])]) with epoch 524 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,103] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=525, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1023) from ProspectiveState(epoch=524, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1735, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,238] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=525, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1457) from ProspectiveState(epoch=524, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1356, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,241] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1434, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=524, voters=[1, 2, 3], electionTimeoutMs=1602, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,250] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=525, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1023) from ProspectiveState(epoch=524, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1735, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,253] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=525, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=false)])]) with epoch 525 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,254] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=525, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=false)])]) with epoch 525 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,277] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(447400002). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:25:54,278] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(97181172). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:25:54,278] INFO [QuorumController id=1] failAll(NotControllerException): failing generatePeriodicPerformanceMessage(614464784). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:25:54,278] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:54,279] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:54,329] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:54,342] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1434, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=524, voters=[1, 2, 3], electionTimeoutMs=1602, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,354] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) from UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1434, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,362] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=874, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=874, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:59332-0-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7dced492]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:25:54,363] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:54,441] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) from UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1434, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,441] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=525, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=false)])]) with epoch 525 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,442] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=525, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=false)])]) with epoch 525 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,443] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=525, epochStartOffset=81247, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=525, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1457) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,444] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,515] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=525, epochStartOffset=81247, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=525, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1457) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,545] INFO [RaftManager id=2] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,545] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=525, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1881, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=525, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1023) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,546] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=525, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=true)])]) with epoch 525 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,548] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=526, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1276) from ProspectiveState(epoch=525, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1881, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,639] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=526, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1276) from ProspectiveState(epoch=525, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1881, highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,641] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1558, highWatermark=Optional.empty) from UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,682] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=525, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=true)])]) with epoch 525 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,683] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1431, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=525, epochStartOffset=81247, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81247, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812187)])], lastFetchTimestamp=1748528754682, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81248, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812293)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,720] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1558, highWatermark=Optional.empty) from UnattachedState(epoch=525, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,721] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional.empty) from UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1558, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,916] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1431, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=525, epochStartOffset=81247, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81247, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812187)])], lastFetchTimestamp=1748528754682, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81248, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812293)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,917] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=526, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=false)])]) with epoch 526 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,928] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional.empty) from UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1558, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:54,928] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=526, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=524, lastOffset=81247, preVote=false)])]) with epoch 526 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:54,930] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=526, epochStartOffset=81247, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=526, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1276) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:55,192] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=526, epochStartOffset=81247, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=526, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81247, metadata=Optional.empty)], electionTimeoutMs=1276) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:55,467] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=612, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=612, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60176-2-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1f05d1f8]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:25:55,468] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:55,469] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,500] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=613, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=613, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56234-2-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3c82f14d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:55,501] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:55,502] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,552] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=526, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1431, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:55,552] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=526, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:55,555] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,613] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=616, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=616, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56246-0-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@49ed8704]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:55,637] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:55,638] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,680] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=618, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=618, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60186-0-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@74ab34cb]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:25:55,681] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:55,690] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,752] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=619, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=619, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56258-1-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@37bc2a0e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:55,753] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:55,755] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,810] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,861] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=622, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=622, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56264-2-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@f26e3b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:55,862] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:55,864] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,891] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=526, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1431, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:55,907] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 81247 (kafka.log.UnifiedLog)
[2025-05-29 17:25:55,910] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 81247 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:25:55,911] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 81247 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:25:55,911] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=80234, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000080234.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:25:55,926] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=526, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=526, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:25:55,928] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:55,981] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,013] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,034] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 81247 with 0 producer ids in 123 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:25:56,035] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 123ms for segment recovery from offset 81247 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:25:56,035] INFO [RaftManager id=3] Truncated to offset 81247 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:25:56,059] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=625, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=625, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56266-0-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5a914bc7]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:56,068] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=876, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=876, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56276-1-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@20a5f8c2]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:56,078] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:56,078] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,083] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:56,135] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,152] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,195] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=619, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=619, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56282-2-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1a1f186b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:56,197] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:56,197] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,209] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,249] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,278] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=879, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=879, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56296-0-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@184af61f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:56,279] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:56,280] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,317] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=628, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=628, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56312-1-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7132d141]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:56,322] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=622, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81246, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=622, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56324-2-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@fdb369d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:25:56,323] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:56,326] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,318] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:25:56,334] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,330] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,345] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=81248, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812293)]) for the first time for epoch 526 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81248, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812293)])], lastFetchTimestamp=1748528756344, lastCaughtUpTimestamp=1748528756344, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81248, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812293)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81247, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2812187)])], lastFetchTimestamp=1748528756039, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:25:56,376] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,387] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:25:56,846] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=81248, metadata=Optional.empty)] for the first time for epoch 526 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:25:56,897] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=81248, metadata=Optional.empty)] for the first time for epoch 526 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:26:26,656] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,656] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=526, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1904, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=526, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,667] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=526, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=true)])]) with epoch 526 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,668] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:26:26,669] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=526, voters=[1, 2, 3], electionTimeoutMs=1295, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=526, epochStartOffset=81247, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816181)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81302, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816181)])], lastFetchTimestamp=1748528783426, lastCaughtUpTimestamp=1748528783426, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81303, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816253)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81302, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816181)])], lastFetchTimestamp=1748528783426, lastCaughtUpTimestamp=1748528783426, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,675] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,681] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=526, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1850, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=526, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,681] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=526, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=true)])]) with epoch 526 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,687] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=526, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=true)])]) with epoch 526 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,694] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=526, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=true)])]) with epoch 526 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,699] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=527, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1395) from ProspectiveState(epoch=526, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1904, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,715] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=527, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1663) from ProspectiveState(epoch=526, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1850, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,758] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=527, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1395) from ProspectiveState(epoch=526, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1904, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,760] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1203, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=526, voters=[1, 2, 3], electionTimeoutMs=1295, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,787] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=527, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1663) from ProspectiveState(epoch=526, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1850, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,794] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=527, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=false)])]) with epoch 527 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,796] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=527, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=false)])]) with epoch 527 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,815] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1203, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=526, voters=[1, 2, 3], electionTimeoutMs=1295, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,815] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(527670842). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:26:26,815] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1166, highWatermark=Optional.empty) from UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1203, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,889] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1166, highWatermark=Optional.empty) from UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1203, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,890] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=527, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=false)])]) with epoch 527 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,890] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=527, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=false)])]) with epoch 527 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,892] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=527, epochStartOffset=81303, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=527, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1395) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,892] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,892] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,893] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=527, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1497, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=527, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1663) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:26,905] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=527, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=true)])]) with epoch 527 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:26,914] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=528, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1691) from ProspectiveState(epoch=527, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1497, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,024] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=527, epochStartOffset=81303, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=527, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1395) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,038] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=528, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1691) from ProspectiveState(epoch=527, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1497, highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,045] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=936, highWatermark=Optional.empty) from UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1166, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,100] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=936, highWatermark=Optional.empty) from UnattachedState(epoch=527, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1166, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,100] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional.empty) from UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=936, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,108] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=527, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=true)])]) with epoch 527 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:27,114] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1852, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=527, epochStartOffset=81303, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81303, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816253)])], lastFetchTimestamp=1748528787107, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81304, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816359)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,177] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional.empty) from UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=936, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,178] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=528, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=false)])]) with epoch 528 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:27,180] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=528, epochStartOffset=81303, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=528, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1691) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,209] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=897, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=897, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56328-0-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@55e3bc20]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:26:27,210] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1852, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=527, epochStartOffset=81303, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81303, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816253)])], lastFetchTimestamp=1748528787107, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81304, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816359)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,211] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=528, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=526, lastOffset=81303, preVote=false)])]) with epoch 528 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:27,211] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,212] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=640, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=640, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56334-1-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@41344394]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:26:27,214] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,215] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=646, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=646, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56348-2-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3c2f3874]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:26:27,216] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,300] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=528, epochStartOffset=81303, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=528, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81302, metadata=Optional.empty)], electionTimeoutMs=1691) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,315] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,373] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=528, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1852, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,374] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=528, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,392] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=898, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=898, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33846-1-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@13521a79]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:26:27,394] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,394] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,431] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=528, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1852, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,431] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=528, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=528, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:26:27,435] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 81303 (kafka.log.UnifiedLog)
[2025-05-29 17:26:27,442] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,444] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,464] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 81303 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:26:27,464] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 81303 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:26:27,467] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=81247, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000081247.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:26:27,507] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=901, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=901, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33862-2-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@50138f4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:26:27,508] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,509] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,513] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 81303 with 0 producer ids in 45 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:26:27,522] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,515] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 3ms for snapshot load and 47ms for segment recovery from offset 81303 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:26:27,522] INFO [RaftManager id=3] Truncated to offset 81303 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:26:27,549] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=647, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=647, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33874-0-16', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5bd3c5d2]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:26:27,567] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,572] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,573] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,614] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=641, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=641, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33886-1-16', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2987929b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:26:27,627] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,637] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=904, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=904, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33902-2-16', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7d4e9e02]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:26:27,615] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,644] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,652] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,654] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,677] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=650, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=650, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33906-0-17', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@329b8c14]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:26:27,678] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,689] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,693] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,705] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,740] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,749] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=907, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81301, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=907, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33914-2-17', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7673bf0f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:26:27,750] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=81304, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816359)]) for the first time for epoch 528 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81304, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816359)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81304, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816359)])], lastFetchTimestamp=1748528787750, lastCaughtUpTimestamp=1748528787750, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81303, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2816253)])], lastFetchTimestamp=1748528787527, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:26:27,756] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:26:27,772] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:27,822] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:26:28,252] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=81304, metadata=Optional.empty)] for the first time for epoch 528 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:26:28,327] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=81304, metadata=Optional.empty)] for the first time for epoch 528 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:28:01,230] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:01,231] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=528, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1708, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=528, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,232] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:01,233] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 2589 due to node 1 being disconnected (elapsed time since creation: 3204ms, elapsed time since send: 3204ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:01,233] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:01,233] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=528, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1296, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=528, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,234] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:28:01,234] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=528, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=528, lastOffset=81481, preVote=true)])]) with epoch 528 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:01,234] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 81481 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:01,234] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 81481 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:01,235] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:01,235] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 2528 due to node 1 being disconnected (elapsed time since creation: 3213ms, elapsed time since send: 3213ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:01,235] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=528, voters=[1, 2, 3], electionTimeoutMs=1216, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=528, epochStartOffset=81303, highWatermark=Optional[LogOffsetMetadata(offset=81481, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829103)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81481, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829103)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81481, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829103)])], lastFetchTimestamp=1748528878033, lastCaughtUpTimestamp=1748528878033, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81481, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829103)])], lastFetchTimestamp=1748528878032, lastCaughtUpTimestamp=1748528878032, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,236] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=529, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], electionTimeoutMs=1902) from ProspectiveState(epoch=528, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1708, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,304] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=529, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], electionTimeoutMs=1902) from ProspectiveState(epoch=528, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1708, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,305] INFO [RaftManager id=3] Hostname for node 1 changed from DESKTOP-T3O0CHU.localdomain to localhost. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:28:01,312] INFO [RaftManager id=2] Hostname for node 1 changed from DESKTOP-T3O0CHU.localdomain to localhost. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:28:01,313] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) from ProspectiveState(epoch=528, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1296, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,314] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1137, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=528, voters=[1, 2, 3], electionTimeoutMs=1216, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,423] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1137, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=528, voters=[1, 2, 3], electionTimeoutMs=1216, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,424] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1476, highWatermark=Optional.empty) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1137, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,502] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) from ProspectiveState(epoch=528, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1296, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,503] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1211, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,581] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1476, highWatermark=Optional.empty) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1137, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,582] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=529, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=528, lastOffset=81481, preVote=false)])]) with epoch 529 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:01,585] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=529, epochStartOffset=81481, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=529, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], electionTimeoutMs=1902) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,591] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1211, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,592] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=529, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=528, lastOffset=81481, preVote=false)])]) with epoch 529 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:01,617] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=529, epochStartOffset=81481, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=529, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], electionTimeoutMs=1902) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,646] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=529, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1476, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,646] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=529, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1211, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,657] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=529, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1476, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,657] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=529, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=529, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1211, highWatermark=Optional[LogOffsetMetadata(offset=81480, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:01,697] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=81482, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829209)]) for the first time for epoch 529 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81482, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829209)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81482, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829209)])], lastFetchTimestamp=1748528881696, lastCaughtUpTimestamp=1748528881696, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81481, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2829103)])], lastFetchTimestamp=1748528881658, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:28:02,202] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=81482, metadata=Optional.empty)] for the first time for epoch 529 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:28:02,530] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=690, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81481, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=690, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33912-1-17', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3a4e37c8]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:28:02,530] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=699, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81482, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=699, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33928-0-18', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5dfa353e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:28:02,531] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:02,531] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:02,532] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:28:02,532] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:28:02,540] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=956, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81481, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=956, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:33940-1-18', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@c945a85]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:28:02,541] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:02,541] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:28:33,987] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:28:33,987] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 81540 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:33,988] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:33,988] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 81540 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:33,988] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=529, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1385, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=529, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:33,989] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:33,989] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=529, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1468, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=529, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:33,991] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=529, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=true)])]) with epoch 529 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:33,991] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=529, voters=[1, 2, 3], electionTimeoutMs=1308, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=529, epochStartOffset=81481, highWatermark=Optional[LogOffsetMetadata(offset=81540, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833385)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81540, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833385)])], lastFetchTimestamp=1748528910774, lastCaughtUpTimestamp=1748528910774, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81540, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833385)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81540, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833385)])], lastFetchTimestamp=1748528910774, lastCaughtUpTimestamp=1748528910774, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:33,991] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=529, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=true)])]) with epoch 529 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:33,993] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=530, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1058) from ProspectiveState(epoch=529, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1385, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:33,993] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=530, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1462) from ProspectiveState(epoch=529, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1468, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:33,995] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=529, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=true)])]) with epoch 529 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:33,998] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=529, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=true)])]) with epoch 529 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,009] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=530, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1462) from ProspectiveState(epoch=529, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1468, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,009] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=530, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1058) from ProspectiveState(epoch=529, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1385, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,011] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=530, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=false)])]) with epoch 530 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,011] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=530, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=false)])]) with epoch 530 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,011] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=529, voters=[1, 2, 3], electionTimeoutMs=1308, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,022] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=529, voters=[1, 2, 3], electionTimeoutMs=1308, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,022] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1060778161). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:28:34,023] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional.empty) from UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,033] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional.empty) from UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,034] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=530, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=false)])]) with epoch 530 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,034] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=530, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=false)])]) with epoch 530 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,035] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,035] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=530, epochStartOffset=81540, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=530, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1058) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,036] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,036] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=530, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1259, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=530, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1462) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,037] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=530, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=true)])]) with epoch 530 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,039] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=531, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1331) from ProspectiveState(epoch=530, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1259, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,053] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=530, epochStartOffset=81540, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=530, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1058) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,058] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=531, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1331) from ProspectiveState(epoch=530, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1259, highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,059] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1128, highWatermark=Optional.empty) from UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,080] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1128, highWatermark=Optional.empty) from UnattachedState(epoch=530, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,081] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1883, highWatermark=Optional.empty) from UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1128, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,088] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=530, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=true)])]) with epoch 530 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,089] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=530, epochStartOffset=81540, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81540, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833385)])], lastFetchTimestamp=1748528914088, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81541, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833491)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,095] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1883, highWatermark=Optional.empty) from UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1128, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,096] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=531, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=false)])]) with epoch 531 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,097] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=531, epochStartOffset=81540, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=531, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1331) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,113] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=530, epochStartOffset=81540, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81540, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833385)])], lastFetchTimestamp=1748528914088, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81541, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833491)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,114] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=531, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=529, lastOffset=81540, preVote=false)])]) with epoch 531 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,117] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=531, epochStartOffset=81540, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=531, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81539, metadata=Optional.empty)], electionTimeoutMs=1331) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,134] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=531, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,134] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=531, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1883, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,148] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=531, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1794, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,150] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 81540 (kafka.log.UnifiedLog)
[2025-05-29 17:28:34,151] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 81540 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:28:34,151] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 81540 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:28:34,151] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=81303, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000081303.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:28:34,155] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=531, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=531, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1883, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:28:34,160] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 81540 with 0 producer ids in 8 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:28:34,160] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 9ms for segment recovery from offset 81540 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:28:34,161] INFO [RaftManager id=3] Truncated to offset 81540 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:28:34,184] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=81541, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833491)]) for the first time for epoch 531 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81541, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833491)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81541, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833491)])], lastFetchTimestamp=1748528914184, lastCaughtUpTimestamp=1748528914184, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81540, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2833385)])], lastFetchTimestamp=1748528914161, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:28:34,686] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=81541, metadata=Optional.empty)] for the first time for epoch 531 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:28:34,699] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=81541, metadata=Optional.empty)] for the first time for epoch 531 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:28:35,372] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=707, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81541, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=707, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56038-1-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@27d11979]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:28:35,373] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:35,374] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:28:35,376] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=716, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81541, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=716, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56030-0-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3dd27f5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:28:35,377] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=973, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81542, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=973, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:56044-2-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@190ce415]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:28:35,377] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:35,377] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:28:35,378] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:28:35,378] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:29:06,900] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:29:06,900] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 81599 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,900] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 81599 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,901] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,901] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,902] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=531, voters=[1, 2, 3], electionTimeoutMs=1481, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=531, epochStartOffset=81540, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837667)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81599, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837667)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81599, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837667)])], lastFetchTimestamp=1748528943241, lastCaughtUpTimestamp=1748528943241, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81599, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837667)])], lastFetchTimestamp=1748528943240, lastCaughtUpTimestamp=1748528943240, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,902] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=531, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1684, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=531, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,902] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=531, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1129, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=531, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,903] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=531, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=true)])]) with epoch 531 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,903] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=531, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=true)])]) with epoch 531 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,904] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=531, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=true)])]) with epoch 531 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,905] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=532, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1628) from ProspectiveState(epoch=531, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1684, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,905] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=532, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1173) from ProspectiveState(epoch=531, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1129, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,905] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=531, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=true)])]) with epoch 531 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,909] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(99097705). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:29:06,930] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=532, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1628) from ProspectiveState(epoch=531, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1684, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,931] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=532, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1173) from ProspectiveState(epoch=531, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1129, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,932] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=532, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=false)])]) with epoch 532 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,932] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1450, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=531, voters=[1, 2, 3], electionTimeoutMs=1481, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,932] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=532, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=false)])]) with epoch 532 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,947] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1450, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=531, voters=[1, 2, 3], electionTimeoutMs=1481, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,947] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1844, highWatermark=Optional.empty) from UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1450, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,967] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1844, highWatermark=Optional.empty) from UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1450, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,967] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=532, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=false)])]) with epoch 532 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,968] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=532, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=false)])]) with epoch 532 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,969] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:06,969] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=532, epochStartOffset=81599, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=532, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1628) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:06,990] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=532, epochStartOffset=81599, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=532, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1628) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,068] INFO [RaftManager id=2] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:07,070] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=532, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1410, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=532, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1173) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,071] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=532, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=true)])]) with epoch 532 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:07,073] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=533, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1214) from ProspectiveState(epoch=532, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1410, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,076] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=532, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=true)])]) with epoch 532 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:07,077] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=532, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1844, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,107] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=533, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1214) from ProspectiveState(epoch=532, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1410, highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,109] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1926, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=532, epochStartOffset=81599, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81599, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837667)])], lastFetchTimestamp=1748528947076, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81600, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837773)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,113] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=532, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=532, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1844, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,114] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1652, highWatermark=Optional.empty) from FollowerState(fetchTimeoutMs=2000, epoch=532, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,129] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1926, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=532, epochStartOffset=81599, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81599, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837667)])], lastFetchTimestamp=1748528947076, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81600, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837773)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,130] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=533, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=false)])]) with epoch 533 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:07,136] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1652, highWatermark=Optional.empty) from FollowerState(fetchTimeoutMs=2000, epoch=532, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,137] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1455, highWatermark=Optional.empty) from UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1652, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,153] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1455, highWatermark=Optional.empty) from UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1652, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,153] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=533, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=531, lastOffset=81599, preVote=false)])]) with epoch 533 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:07,155] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=533, epochStartOffset=81599, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=533, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1214) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,181] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=533, epochStartOffset=81599, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=533, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81599, metadata=Optional.empty)], electionTimeoutMs=1214) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,198] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=533, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1455, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,198] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=533, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1926, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,209] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=533, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1926, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,209] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=533, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=533, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1455, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:29:07,210] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 81599 (kafka.log.UnifiedLog)
[2025-05-29 17:29:07,211] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 81599 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:29:07,211] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 81599 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:29:07,211] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=81540, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000081540.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:29:07,217] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 81599 with 0 producer ids in 5 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:29:07,217] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 6ms for segment recovery from offset 81599 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:29:07,218] INFO [RaftManager id=3] Truncated to offset 81599 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:29:07,233] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=81600, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837773)]) for the first time for epoch 533 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81600, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837773)])], lastFetchTimestamp=1748528947233, lastCaughtUpTimestamp=1748528947233, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81600, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837773)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81599, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2837667)])], lastFetchTimestamp=1748528947219, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:29:07,736] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=81600, metadata=Optional.empty)] for the first time for epoch 533 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:29:07,751] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=81600, metadata=Optional.empty)] for the first time for epoch 533 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:29:08,130] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=724, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81599, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=724, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:48020-1-19', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@61db259]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:29:08,130] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:29:08,131] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:29:08,136] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=733, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81600, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=733, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:48034-0-20', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@199202c6]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:29:08,137] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:29:08,139] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:29:08,139] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=990, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81599, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=990, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:48026-2-19', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4186b278]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:29:08,140] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:29:08,141] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:31:12,114] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:31:12,115] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=533, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1767, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=533, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,116] INFO [RaftManager id=1] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:31:12,116] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 2859 due to node 2 being disconnected (elapsed time since creation: 3202ms, elapsed time since send: 3202ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:31:12,117] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=533, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=533, lastOffset=81838, preVote=true)])]) with epoch 533 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:31:12,118] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:31:12,118] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=533, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1913, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=533, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,119] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:31:12,119] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 2922 due to node 2 being disconnected (elapsed time since creation: 3206ms, elapsed time since send: 3206ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:31:12,120] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=533, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=533, lastOffset=81838, preVote=true)])]) with epoch 533 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:31:12,122] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=534, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], electionTimeoutMs=1017) from ProspectiveState(epoch=533, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1913, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,122] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:31:12,122] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 81838 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:31:12,123] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 81838 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:31:12,124] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=533, voters=[1, 2, 3], electionTimeoutMs=1633, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=533, epochStartOffset=81599, highWatermark=Optional[LogOffsetMetadata(offset=81838, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2854909)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81838, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2854909)])], lastFetchTimestamp=1748529068915, lastCaughtUpTimestamp=1748529068915, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81838, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2854909)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81838, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2854909)])], lastFetchTimestamp=1748529068914, lastCaughtUpTimestamp=1748529068914, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,137] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=534, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], electionTimeoutMs=1017) from ProspectiveState(epoch=533, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1913, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,139] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1744, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) from ProspectiveState(epoch=533, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), electionTimeoutMs=1767, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,139] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1617, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=533, voters=[1, 2, 3], electionTimeoutMs=1633, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,149] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1617, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=533, voters=[1, 2, 3], electionTimeoutMs=1633, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,149] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1744, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) from ProspectiveState(epoch=533, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), electionTimeoutMs=1767, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,150] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) from UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1744, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,161] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) from UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1744, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,161] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=534, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=533, lastOffset=81838, preVote=false)])]) with epoch 534 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:31:12,162] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=534, epochStartOffset=81838, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=534, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], electionTimeoutMs=1017) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,174] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=534, epochStartOffset=81838, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=534, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], electionTimeoutMs=1017) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,192] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=534, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,192] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=534, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1617, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,227] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=534, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1617, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,227] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=534, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=534, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional[LogOffsetMetadata(offset=81837, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:31:12,270] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=81839, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2855015)]) for the first time for epoch 534 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81839, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2855015)])], lastFetchTimestamp=1748529072269, lastCaughtUpTimestamp=1748529072269, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81839, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2855015)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81838, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2854909)])], lastFetchTimestamp=1748529072190, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:31:12,774] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=81839, metadata=Optional.empty)] for the first time for epoch 534 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:31:13,624] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=786, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81840, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=786, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:39788-0-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@67b83071]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:31:13,625] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:31:13,626] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:31:13,627] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=795, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81839, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=795, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:39792-1-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@14910d86]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:31:13,627] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=1052, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81839, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=1052, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:39806-2-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@38044d08]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:31:13,628] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:31:13,628] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:31:13,629] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:31:13,629] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:32:29,034] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:32:29,034] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 81898 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,034] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 81898 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,035] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,035] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=534, voters=[1, 2, 3], electionTimeoutMs=1366, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=534, epochStartOffset=81838, highWatermark=Optional[LogOffsetMetadata(offset=81898, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859263)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81898, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859263)])], lastFetchTimestamp=1748529101822, lastCaughtUpTimestamp=1748529101822, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81898, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859263)])], lastFetchTimestamp=1748529101821, lastCaughtUpTimestamp=1748529101821, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81898, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859263)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,035] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,036] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=534, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1491, highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=534, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,036] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=534, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1048, highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=534, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,037] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=534, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=534, lastOffset=81898, preVote=true)])]) with epoch 534 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,037] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=534, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=534, lastOffset=81898, preVote=true)])]) with epoch 534 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,039] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1007) from ProspectiveState(epoch=534, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1491, highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,043] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=534, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=534, lastOffset=81898, preVote=true)])]) with epoch 534 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,045] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1470) from ProspectiveState(epoch=534, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1048, highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,075] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1470) from ProspectiveState(epoch=534, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1048, highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,077] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1324, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=534, voters=[1, 2, 3], electionTimeoutMs=1366, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,081] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1007) from ProspectiveState(epoch=534, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1491, highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,083] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=535, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=534, lastOffset=81898, preVote=false)])]) with epoch 535 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,083] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=535, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=534, lastOffset=81898, preVote=false)])]) with epoch 535 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,095] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1324, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=534, voters=[1, 2, 3], electionTimeoutMs=1366, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,095] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1057, highWatermark=Optional.empty) from UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1324, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,111] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1057, highWatermark=Optional.empty) from UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1324, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,111] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=535, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=534, lastOffset=81898, preVote=false)])]) with epoch 535 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,112] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=535, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=534, lastOffset=81898, preVote=false)])]) with epoch 535 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,113] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:32:29,113] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=535, epochStartOffset=81898, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1470) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,150] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=535, epochStartOffset=81898, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1470) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,172] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=535, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1057, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,172] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=535, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1007) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,182] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=535, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=535, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1057, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,183] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=535, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=535, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=81897, metadata=Optional.empty)], electionTimeoutMs=1007) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:32:29,206] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=81899, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859369)]) for the first time for epoch 535 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81899, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859369)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81899, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859369)])], lastFetchTimestamp=1748529149206, lastCaughtUpTimestamp=1748529149206, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=81898, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2859263)])], lastFetchTimestamp=1748529149184, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:32:29,708] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=81899, metadata=Optional.empty)] for the first time for epoch 535 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:32:30,517] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=803, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=81899, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=803, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:58746-0-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1b59d6b2]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:32:30,517] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=1069, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=81900, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=1069, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:58774-2-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@14144848]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:32:30,517] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=812, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=81899, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=812, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:58758-1-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@38ac9a4f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:32:30,518] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:32:30,518] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:32:30,518] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:32:30,519] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:32:30,519] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:32:30,519] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:33:19,393] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:33:19,394] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 82078 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,395] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 82078 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,395] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,395] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,396] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=535, voters=[1, 2, 3], electionTimeoutMs=1303, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=535, epochStartOffset=81898, highWatermark=Optional[LogOffsetMetadata(offset=82078, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872257)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82078, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872257)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82078, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872257)])], lastFetchTimestamp=1748529195717, lastCaughtUpTimestamp=1748529195717, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82078, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872257)])], lastFetchTimestamp=1748529195717, lastCaughtUpTimestamp=1748529195717, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,396] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=535, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1908, highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=535, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,397] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=535, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1516, highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=535, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,397] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=535, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=535, lastOffset=82078, preVote=true)])]) with epoch 535 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,399] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1687) from ProspectiveState(epoch=535, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1908, highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,400] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=535, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=535, lastOffset=82078, preVote=true)])]) with epoch 535 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,401] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=535, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=535, lastOffset=82078, preVote=true)])]) with epoch 535 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,404] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1505) from ProspectiveState(epoch=535, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1516, highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,442] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1687) from ProspectiveState(epoch=535, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1908, highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,444] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1255, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=535, voters=[1, 2, 3], electionTimeoutMs=1303, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,449] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1505) from ProspectiveState(epoch=535, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1516, highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,450] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=536, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=535, lastOffset=82078, preVote=false)])]) with epoch 536 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,451] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=536, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=535, lastOffset=82078, preVote=false)])]) with epoch 536 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,462] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1255, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=535, voters=[1, 2, 3], electionTimeoutMs=1303, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,463] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1833, highWatermark=Optional.empty) from UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1255, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,488] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1833, highWatermark=Optional.empty) from UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1255, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,488] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=536, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=535, lastOffset=82078, preVote=false)])]) with epoch 536 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,488] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=536, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=535, lastOffset=82078, preVote=false)])]) with epoch 536 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,490] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=536, epochStartOffset=82078, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1687) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,490] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:33:19,503] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=536, epochStartOffset=82078, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1687) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,535] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1833, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,536] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1505) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,557] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=536, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1833, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,565] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=536, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82077, metadata=Optional.empty)], electionTimeoutMs=1505) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:33:19,610] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=82079, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872363)]) for the first time for epoch 536 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82079, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872363)])], lastFetchTimestamp=1748529199609, lastCaughtUpTimestamp=1748529199609, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82079, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872363)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82078, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2872257)])], lastFetchTimestamp=1748529199566, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:33:20,111] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=82079, metadata=Optional.empty)] for the first time for epoch 536 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:33:20,770] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=1116, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=79051, currentMetadataOffset=82079, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=1116, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:41012-0-21', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6a1a2b65]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:33:20,771] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:33:20,771] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:33:20,779] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=850, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=82080, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=850, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:41010-1-20', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@10ecce7e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:33:20,780] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:33:20,781] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:33:20,790] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=859, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=82079, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=859, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:41022-2-20', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@78373ac4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:33:20,791] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:33:20,796] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:28,711] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:28,712] INFO [BrokerServer id=1] Transition from STARTED to SHUTTING_DOWN (kafka.server.BrokerServer)
[2025-05-29 17:35:28,713] INFO [BrokerServer id=1] shutting down (kafka.server.BrokerServer)
[2025-05-29 17:35:28,715] INFO [BrokerLifecycleManager id=1] Beginning controlled shutdown. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:28,758] INFO [BrokerLifecycleManager id=1] The broker is in PENDING_CONTROLLED_SHUTDOWN state, still waiting for the active controller. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:28,760] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0, my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:28,810] INFO [BrokerLifecycleManager id=1] The broker is in PENDING_CONTROLLED_SHUTDOWN state, still waiting for the active controller. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:28,874] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:28,889] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions HashSet(__consumer_offsets-22, my-topic-1, __consumer_offsets-25, ssl-test-topic-1, __consumer_offsets-37, test-topic-0, __consumer_offsets-30, my-topic-2, __consumer_offsets-8, __consumer_offsets-21, __consumer_offsets-4, __consumer_offsets-27, __consumer_offsets-7, __consumer_offsets-9, __consumer_offsets-46, __consumer_offsets-35, ssl-test-topic-0, __consumer_offsets-41, __consumer_offsets-33, __consumer_offsets-23, __consumer_offsets-49, __consumer_offsets-47, __consumer_offsets-16, __consumer_offsets-28, __consumer_offsets-31, __consumer_offsets-36, __consumer_offsets-42, __consumer_offsets-3, __consumer_offsets-18, __consumer_offsets-15, __consumer_offsets-24, my-topic-0, __consumer_offsets-38, __consumer_offsets-17, __consumer_offsets-48, __consumer_offsets-19, __consumer_offsets-11, ssl-test-topic-2, __consumer_offsets-13, __consumer_offsets-2, __consumer_offsets-43, __consumer_offsets-6, __consumer_offsets-14, __consumer_offsets-20, __consumer_offsets-0, __consumer_offsets-44, __consumer_offsets-39, __consumer_offsets-12, __consumer_offsets-45, __consumer_offsets-1, __consumer_offsets-5, __consumer_offsets-26, __consumer_offsets-29, __consumer_offsets-34, __consumer_offsets-10, __consumer_offsets-32, __consumer_offsets-40) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:28,890] INFO [ReplicaAlterLogDirsManager on broker 1] Removed fetcher for partitions HashSet(__consumer_offsets-22, my-topic-1, __consumer_offsets-25, ssl-test-topic-1, __consumer_offsets-37, test-topic-0, __consumer_offsets-30, my-topic-2, __consumer_offsets-8, __consumer_offsets-21, __consumer_offsets-4, __consumer_offsets-27, __consumer_offsets-7, __consumer_offsets-9, __consumer_offsets-46, __consumer_offsets-35, ssl-test-topic-0, __consumer_offsets-41, __consumer_offsets-33, __consumer_offsets-23, __consumer_offsets-49, __consumer_offsets-47, __consumer_offsets-16, __consumer_offsets-28, __consumer_offsets-31, __consumer_offsets-36, __consumer_offsets-42, __consumer_offsets-3, __consumer_offsets-18, __consumer_offsets-15, __consumer_offsets-24, my-topic-0, __consumer_offsets-38, __consumer_offsets-17, __consumer_offsets-48, __consumer_offsets-19, __consumer_offsets-11, ssl-test-topic-2, __consumer_offsets-13, __consumer_offsets-2, __consumer_offsets-43, __consumer_offsets-6, __consumer_offsets-14, __consumer_offsets-20, __consumer_offsets-0, __consumer_offsets-44, __consumer_offsets-39, __consumer_offsets-12, __consumer_offsets-45, __consumer_offsets-1, __consumer_offsets-5, __consumer_offsets-26, __consumer_offsets-29, __consumer_offsets-34, __consumer_offsets-10, __consumer_offsets-32, __consumer_offsets-40) (kafka.server.ReplicaAlterLogDirsManager)
[2025-05-29 17:35:28,895] INFO [ReplicaFetcherThread-0-3]: Shutting down (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:35:28,896] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Client requested connection close from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:28,896] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Cancelled in-flight FETCH request with correlation id 3154 due to node 3 being disconnected (elapsed time since creation: 57ms, elapsed time since send: 57ms, throttle time: 0ms, request timeout: 30000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:28,896] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Error sending fetch request (sessionId=90539575, epoch=3154) to node 3: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Client was shutdown before response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:120) ~[kafka-clients-4.0.0.jar:?]
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:112) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:76) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:315) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:129) ~[kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:128) ~[kafka_2.13-4.0.0.jar:?]
	at scala.Option.foreach(Option.scala:437) [scala-library-2.13.15.jar:?]
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:128) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111) [kafka_2.13-4.0.0.jar:?]
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:96) [kafka_2.13-4.0.0.jar:?]
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]
[2025-05-29 17:35:28,897] INFO [ReplicaFetcherThread-0-3]: Stopped (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:35:28,897] INFO [ReplicaFetcherThread-0-3]: Shutdown completed (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:35:28,899] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-13 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,899] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-46 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,899] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-13 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,899] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-9 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,899] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-46 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-13 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-46 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-9 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-42 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-9 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-42 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-42 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,900] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-21 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,901] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-21 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,901] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-21 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,901] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-17 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,902] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-17 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,902] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-17 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,902] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-30 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-30 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-26 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-30 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-26 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-5 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-26 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-38 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,903] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-5 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-1 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-5 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-34 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-1 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-16 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-1 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-16 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-45 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-16 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-12 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-45 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-41 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-12 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-24 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-12 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-24 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,905] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-24 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-38 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-45 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-20 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,905] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-41 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,905] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-49 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-41 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-49 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-49 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,904] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-34 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-0 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,905] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-20 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-29 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-0 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-20 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-25 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-29 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-8 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-29 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-8 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-8 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,907] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-25 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,907] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-25 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-34 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-37 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-38 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,909] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-37 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,910] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-37 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,909] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-4 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-33 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-15 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-33 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-48 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-15 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-11 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-33 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-15 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-11 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-11 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,906] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-0 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-48 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-44 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,911] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-4 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-48 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-4 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-23 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-44 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-19 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-44 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-23 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-19 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-32 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-23 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-32 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,912] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-19 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-32 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-28 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-7 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-28 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-40 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-28 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-3 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-36 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-40 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-7 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-47 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-40 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-14 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-7 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-47 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-3 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-3 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-36 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-43 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-36 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-14 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-43 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-14 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,913] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-47 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-10 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-43 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-10 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-22 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-10 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-18 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-22 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-31 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-22 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,914] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-18 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-27 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-31 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-39 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-27 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-6 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-18 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-27 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-6 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-39 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,916] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-6 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-35 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,916] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-2 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,915] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-31 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,916] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-2 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,916] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-2 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,916] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-39 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,916] INFO [GroupCoordinator id=1] Started unloading metadata for __consumer_offsets-35 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:28,916] INFO [GroupCoordinator id=1] Finished unloading metadata for __consumer_offsets-35 with epoch OptionalInt[25]. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:29,024] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,487] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,524] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,543] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,579] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,617] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,635] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,672] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,708] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,728] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,755] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,792] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,826] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,856] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,876] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,913] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,949] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:29,968] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,002] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,033] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,070] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,089] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,124] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,165] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,181] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,213] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,242] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,276] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,305] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,329] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,360] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,396] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,425] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,459] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,487] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,519] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,548] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,579] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,608] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,642] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,671] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,703] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,731] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,763] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,788] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,820] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,851] INFO [BrokerLifecycleManager id=1] The controller has asked us to exit controlled shutdown. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:30,851] INFO [BrokerLifecycleManager id=1] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:30,852] INFO [BrokerLifecycleManager id=1] Transitioning from PENDING_CONTROLLED_SHUTDOWN to SHUTTING_DOWN. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:30,852] INFO [broker-1-to-controller-heartbeat-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,852] INFO [broker-1-to-controller-heartbeat-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,852] INFO [broker-1-to-controller-heartbeat-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,853] INFO [SocketServer listenerType=BROKER, nodeId=1] Stopping socket server request processors (kafka.network.SocketServer)
[2025-05-29 17:35:30,860] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,864] INFO Node to controller channel manager for heartbeat shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-29 17:35:30,865] INFO [SocketServer listenerType=BROKER, nodeId=1] Stopped socket server request processors (kafka.network.SocketServer)
[2025-05-29 17:35:30,867] INFO [data-plane Kafka Request Handler on Broker 1], shutting down (kafka.server.KafkaRequestHandlerPool)
[2025-05-29 17:35:30,870] INFO [data-plane Kafka Request Handler on Broker 1], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2025-05-29 17:35:30,870] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,872] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,872] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,874] INFO [KafkaApi-1] Shutdown complete. (kafka.server.KafkaApis)
[2025-05-29 17:35:30,874] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,879] INFO [TransactionCoordinator id=1] Shutting down. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:35:30,880] INFO [Transaction State Manager 1]: Shutdown complete (kafka.coordinator.transaction.TransactionStateManager)
[2025-05-29 17:35:30,880] INFO [TxnMarkerSenderThread-1]: Shutting down (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:35:30,880] INFO [TxnMarkerSenderThread-1]: Stopped (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:35:30,880] INFO [TxnMarkerSenderThread-1]: Shutdown completed (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:35:30,884] INFO [TransactionCoordinator id=1] Shutdown complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:35:30,886] INFO [GroupCoordinator id=1] Shutting down. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:35:30,886] INFO [GroupCoordinator id=1] Closing coordinator runtime. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:30,886] INFO [group-coordinator-reaper]: Shutting down (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:30,887] INFO [group-coordinator-reaper]: Stopped (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:30,887] INFO [group-coordinator-reaper]: Shutdown completed (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:30,888] INFO [GroupCoordinator id=1] Shutting down event processor. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor)
[2025-05-29 17:35:30,888] INFO [group-coordinator-event-processor-3]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,888] INFO [group-coordinator-event-processor-2]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,888] INFO [group-coordinator-event-processor-3]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,888] INFO [group-coordinator-event-processor-0]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,888] INFO [group-coordinator-event-processor-2]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,888] INFO [group-coordinator-event-processor-0]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,889] INFO [group-coordinator-event-processor-1]: Shutting down. Draining the remaining events. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,889] INFO [group-coordinator-event-processor-1]: Shutdown completed (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:30,889] INFO [GroupCoordinator id=1] Event processor closed. (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor)
[2025-05-29 17:35:30,890] INFO [GroupCoordinator id=1] Coordinator runtime closed. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:30,892] INFO [GroupCoordinator id=1] Shutdown complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:35:30,893] INFO [AssignmentsManager id=1]KafkaEventQueue#close: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:30,894] INFO [AssignmentsManager id=1] shutting down. (org.apache.kafka.server.AssignmentsManager)
[2025-05-29 17:35:30,894] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,894] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,894] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,895] INFO Node to controller channel manager for directory-assignments shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-29 17:35:30,895] INFO [AssignmentsManager id=1]closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:30,896] INFO [ReplicaManager broker=1] Shutting down (kafka.server.ReplicaManager)
[2025-05-29 17:35:30,896] INFO [LogDirFailureHandler]: Shutting down (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:35:30,897] INFO [LogDirFailureHandler]: Stopped (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:35:30,897] INFO [LogDirFailureHandler]: Shutdown completed (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:35:30,897] INFO [ReplicaFetcherManager on broker 1] shutting down (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:30,899] INFO [ReplicaFetcherManager on broker 1] shutdown completed (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:30,900] INFO [ReplicaAlterLogDirsManager on broker 1] shutting down (kafka.server.ReplicaAlterLogDirsManager)
[2025-05-29 17:35:30,901] INFO [ReplicaAlterLogDirsManager on broker 1] shutdown completed (kafka.server.ReplicaAlterLogDirsManager)
[2025-05-29 17:35:30,905] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,905] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,906] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,906] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,907] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,907] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,907] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,908] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,909] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,909] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,909] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,910] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,910] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,911] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,911] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,911] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,912] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,913] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,913] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:30,927] INFO [AddPartitionsToTxnSenderThread-1]: Shutting down (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:35:30,927] INFO [AddPartitionsToTxnSenderThread-1]: Stopped (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:35:30,927] INFO [AddPartitionsToTxnSenderThread-1]: Shutdown completed (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:35:30,928] INFO [ReplicaManager broker=1] Shut down completely (kafka.server.ReplicaManager)
[2025-05-29 17:35:30,929] INFO [broker-1-to-controller-alter-partition-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,929] INFO [broker-1-to-controller-alter-partition-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,929] INFO [broker-1-to-controller-alter-partition-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,930] INFO Node to controller channel manager for alter-partition shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-29 17:35:30,930] INFO [broker-1-to-controller-forwarding-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,931] INFO [broker-1-to-controller-forwarding-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,931] INFO [broker-1-to-controller-forwarding-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:30,931] INFO Node to controller channel manager for forwarding shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-29 17:35:30,932] INFO Shutting down. (kafka.log.LogManager)
[2025-05-29 17:35:30,934] INFO [kafka-log-cleaner-thread-0]: Shutting down (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:35:30,934] INFO [kafka-log-cleaner-thread-0]: Stopped (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:35:30,934] INFO [kafka-log-cleaner-thread-0]: Shutdown completed (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:35:30,941] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:30,970] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,004] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,036] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,060] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,085] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,113] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,142] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,193] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,220] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,243] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,283] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,297] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,334] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,336] INFO Shutdown complete. (kafka.log.LogManager)
[2025-05-29 17:35:31,337] INFO [broker-1-ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,338] INFO [broker-1-ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,339] INFO [broker-1-ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,339] INFO [broker-1-ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,339] INFO [broker-1-ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,339] INFO [broker-1-ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,339] INFO [broker-1-ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,340] INFO [broker-1-ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,340] INFO [broker-1-ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,340] INFO [broker-1-ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,340] INFO [broker-1-ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,340] INFO [broker-1-ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,342] INFO [SocketServer listenerType=BROKER, nodeId=1] Shutting down socket server (kafka.network.SocketServer)
[2025-05-29 17:35:31,356] INFO [SocketServer listenerType=BROKER, nodeId=1] Shutdown completed (kafka.network.SocketServer)
[2025-05-29 17:35:31,357] INFO Broker and topic stats closed (org.apache.kafka.storage.log.metrics.BrokerTopicStats)
[2025-05-29 17:35:31,357] INFO [share-group-lock-timeout-reaper]: Shutting down (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:31,358] INFO [share-group-lock-timeout-reaper]: Stopped (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:31,358] INFO [share-group-lock-timeout-reaper]: Shutdown completed (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:31,359] INFO [BrokerLifecycleManager id=1] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,359] INFO [client-metrics-reaper]: Shutting down (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:31,360] INFO [client-metrics-reaper]: Stopped (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:31,360] INFO [client-metrics-reaper]: Shutdown completed (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:31,361] INFO [BrokerServer id=1] shut down completed (kafka.server.BrokerServer)
[2025-05-29 17:35:31,362] INFO [BrokerServer id=1] Transition from SHUTTING_DOWN to SHUTDOWN (kafka.server.BrokerServer)
[2025-05-29 17:35:31,362] INFO [ControllerServer id=1] shutting down (kafka.server.ControllerServer)
[2025-05-29 17:35:31,364] INFO [raft-expiration-reaper]: Shutting down (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:35:31,371] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,386] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,389] INFO [raft-expiration-reaper]: Stopped (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:35:31,389] INFO [raft-expiration-reaper]: Shutdown completed (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:35:31,390] INFO [kafka-1-raft-io-thread]: Shutting down (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:35:31,390] INFO [RaftManager id=1] Beginning graceful shutdown (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:31,391] INFO [RaftManager id=1] Graceful shutdown completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:31,391] INFO [kafka-1-raft-io-thread]: Stopped (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:35:31,391] INFO [RaftManager id=1] Completed graceful shutdown of RaftClient (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:35:31,392] INFO [kafka-1-raft-io-thread]: Shutdown completed (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:35:31,400] INFO [kafka-1-raft-outbound-request-thread]: Shutting down (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:35:31,400] INFO [kafka-1-raft-outbound-request-thread]: Stopped (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:35:31,400] INFO [kafka-1-raft-outbound-request-thread]: Shutdown completed (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:35:31,407] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 82394 with 0 producer ids in 5 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:31,414] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,415] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,415] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] shutting down. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:35:31,415] INFO [controller-1-to-controller-registration-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:31,415] INFO [controller-1-to-controller-registration-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:31,415] INFO [controller-1-to-controller-registration-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:31,416] INFO Node to controller channel manager for registration shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-29 17:35:31,416] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,416] INFO [controller-1-to-controller-registration-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:31,417] WARN [NodeToControllerChannelManager id=1 name=registration] Attempting to close NetworkClient that has already been closed. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:31,417] INFO Node to controller channel manager for registration shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-05-29 17:35:31,418] INFO [ControllerRegistrationManager id=1 incarnation=EKJnkiZ_TemMu71mUpLubw] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,420] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Stopping socket server request processors (kafka.network.SocketServer)
[2025-05-29 17:35:31,422] INFO [RaftManager id=2] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:31,422] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:31,426] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Stopped socket server request processors (kafka.network.SocketServer)
[2025-05-29 17:35:31,426] INFO [QuorumController id=1] QuorumController#beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,428] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Shutting down socket server (kafka.network.SocketServer)
[2025-05-29 17:35:31,435] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Shutdown completed (kafka.network.SocketServer)
[2025-05-29 17:35:31,436] INFO [data-plane Kafka Request Handler on Broker 1], shutting down (kafka.server.KafkaRequestHandlerPool)
[2025-05-29 17:35:31,437] INFO [data-plane Kafka Request Handler on Broker 1], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2025-05-29 17:35:31,437] INFO [ExpirationReaper-0-null]: Shutting down (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:31,438] INFO [ExpirationReaper-0-null]: Stopped (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:31,438] INFO [ExpirationReaper-0-null]: Shutdown completed (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:31,439] INFO [controller-1-ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,439] INFO [controller-1-ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,439] INFO [controller-1-ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,440] INFO [controller-1-ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,440] INFO [controller-1-ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,441] INFO [controller-1-ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,444] INFO [controller-1-ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,444] INFO [controller-1-ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,445] INFO [controller-1-ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,446] INFO [controller-1-ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,446] INFO [controller-1-ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,446] INFO [controller-1-ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:31,447] INFO [QuorumController id=1] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,447] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:31,449] INFO [SharedServer id=1] Stopping SharedServer (kafka.server.SharedServer)
[2025-05-29 17:35:31,450] INFO [MetadataLoader id=1] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,450] INFO [SnapshotGenerator id=1] close: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,450] INFO [SnapshotGenerator id=1] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,451] INFO [MetadataLoader id=1] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,451] INFO [SnapshotGenerator id=1] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-05-29 17:35:31,452] INFO Metrics scheduler closed (org.apache.kafka.common.metrics.Metrics)
[2025-05-29 17:35:31,452] INFO Closing reporter org.apache.kafka.common.metrics.JmxReporter (org.apache.kafka.common.metrics.Metrics)
[2025-05-29 17:35:31,453] INFO Metrics reporters closed (org.apache.kafka.common.metrics.Metrics)
[2025-05-29 17:35:31,453] INFO App info kafka.server for 1 unregistered (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:35:31,454] INFO App info kafka.server for 1 unregistered (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:35:31,800] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:31,800] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:32,800] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:32,800] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:33,800] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:33,800] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:34,800] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:34,801] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:35,714] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2025-05-29 17:35:35,800] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:35,801] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:36,342] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-05-29 17:35:36,350] INFO [ControllerServer id=1] Starting controller (kafka.server.ControllerServer)
[2025-05-29 17:35:36,802] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:36,802] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:37,070] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:35:37,663] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2025-05-29 17:35:37,676] INFO CONTROLLER: resolved wildcard host to DESKTOP-T3O0CHU.localdomain (org.apache.kafka.metadata.ListenerInfo)
[2025-05-29 17:35:37,693] INFO authorizerStart completed for endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:35:37,697] INFO [SharedServer id=1] Starting SharedServer (kafka.server.SharedServer)
[2025-05-29 17:35:37,788] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Recovering unflushed segment 41651. 0 recovered for __cluster_metadata-0. (org.apache.kafka.storage.internals.log.LogLoader)
[2025-05-29 17:35:37,793] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:37,795] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:37,796] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000078971.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:35:37,797] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000079519.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:35:37,798] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000082394.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:35:37,802] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:37,802] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:37,818] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 41651 with 0 producer ids in 17 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:37,825] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 3ms for snapshot load and 19ms for segment recovery from offset 41651 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:38,217] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 82394 with 0 producer ids in 5 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:38,223] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 82394 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:38,224] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 82394 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:38,225] INFO Deleted producer state snapshot /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000041651.snapshot (org.apache.kafka.storage.internals.log.SnapshotFile)
[2025-05-29 17:35:38,229] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=82394, file=/home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000082394.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:38,233] INFO [LogLoader partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 8ms for snapshot load and 0ms for segment recovery from offset 82394 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:38,282] INFO Initialized snapshots with IDs SortedSet(OffsetAndEpoch(offset=51468, epoch=142), OffsetAndEpoch(offset=58580, epoch=234), OffsetAndEpoch(offset=65880, epoch=286)) from /home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2025-05-29 17:35:38,358] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-05-29 17:35:38,380] INFO [RaftManager id=1] Reading KRaft snapshot and log as part of the initialization (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:38,385] INFO [RaftManager id=1] Loading snapshot (OffsetAndEpoch(offset=65880, epoch=286)) since log start offset (41651) is greater than the internal listener's next offset (-1) (org.apache.kafka.raft.internals.KRaftControlRecordStateMachine)
[2025-05-29 17:35:38,535] INFO [RaftManager id=1] Starting voters are VoterSet(voters={1=VoterNode(voterKey=ReplicaKey(id=1, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9093}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 2=VoterNode(voterKey=ReplicaKey(id=2, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9096}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0]), 3=VoterNode(voterKey=ReplicaKey(id=3, directoryId=<undefined>), listeners=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), supportedKRaftVersion=SupportedVersionRange[min_version:0, max_version:0])}) (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:38,538] INFO [RaftManager id=1] Starting request manager with static voters: [localhost:9093 (id: 1 rack: null isFenced: false), localhost:9096 (id: 2 rack: null isFenced: false), localhost:9099 (id: 3 rack: null isFenced: false)] (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:38,558] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=<undefined>)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:38,613] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=<undefined>)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from null (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:38,624] INFO [kafka-1-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-05-29 17:35:38,627] INFO [kafka-1-raft-io-thread]: Starting (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-05-29 17:35:38,667] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:38,671] INFO [RaftManager id=1] Registered the listener org.apache.kafka.image.loader.MetadataLoader@1564221422 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:38,672] INFO [ControllerServer id=1] Waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:35:38,672] INFO [ControllerServer id=1] Finished waiting for controller quorum voters future (kafka.server.ControllerServer)
[2025-05-29 17:35:38,753] INFO [RaftManager id=1] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@1512958859 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:38,764] INFO [controller-1-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:38,766] INFO [controller-1-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:38,768] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:38,769] INFO [controller-1-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:38,772] INFO [controller-1-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:38,802] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:38,804] WARN [RaftManager id=3] Connection to node 1 (localhost/127.0.0.1:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:38,827] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:38,877] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:38,880] INFO [ControllerServer id=1] Waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:35:38,881] INFO [ControllerServer id=1] Finished waiting for the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2025-05-29 17:35:38,881] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:38,883] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:35:38,887] INFO Awaiting socket connections on 0.0.0.0:9093. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:35:38,982] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,083] INFO [MetadataLoader id=1] initializeNewPublishers: the loader is still catching up because we still don't know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,104] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=82409, metadata=Optional.empty)] for the first time for epoch 536 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:35:39,111] INFO [MetadataLoader id=1] handleLoadSnapshot(00000000000000065880-0000000286): incrementing HandleLoadSnapshotCount to 1. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,136] INFO [MetadataLoader id=1] handleLoadSnapshot(00000000000000065880-0000000286): generated a metadata delta between offset -1 and this snapshot in 23864 us. (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,138] INFO [MetadataLoader id=1] maybePublishMetadata(SNAPSHOT): The loader is still catching up because we have loaded up to offset 65879, but the high water mark is 82409 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,217] INFO [controller-1-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:39,219] INFO [controller-1-to-controller-registration-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:39,219] INFO [ControllerServer id=1] Waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:35:39,219] INFO [ControllerServer id=1] Finished waiting for all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2025-05-29 17:35:39,219] INFO [ControllerServer id=1] Waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:35:39,220] INFO [ControllerServer id=1] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2025-05-29 17:35:39,220] INFO [ControllerRegistrationManager id=1 incarnation=_ycqFF8nQxOQtydspCO2Zw] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:35:39,221] INFO [ControllerRegistrationManager id=1 incarnation=_ycqFF8nQxOQtydspCO2Zw] maybeSendControllerRegistration: cannot register yet because the metadata.version is not known yet. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:35:39,221] INFO [BrokerServer id=1] Transition from SHUTDOWN to STARTING (kafka.server.BrokerServer)
[2025-05-29 17:35:39,225] INFO [BrokerServer id=1] Starting broker (kafka.server.BrokerServer)
[2025-05-29 17:35:39,237] INFO [broker-1-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:39,239] INFO [broker-1-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:39,241] INFO [broker-1-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:39,242] INFO [broker-1-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-05-29 17:35:39,295] INFO [BrokerServer id=1] Waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:35:39,295] INFO [BrokerServer id=1] Finished waiting for controller quorum voters future (kafka.server.BrokerServer)
[2025-05-29 17:35:39,400] INFO [broker-1-to-controller-forwarding-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:39,402] INFO [broker-1-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:39,435] INFO [MetadataLoader id=1] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 82409 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,440] INFO [client-metrics-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:39,450] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,458] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,459] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,467] INFO [ControllerServer id=1] Loaded new metadata Features(metadataVersion=4.0-IV3, finalizedFeatures={group.version=1, transaction.version=2, metadata.version=25}, finalizedFeaturesEpoch=82408). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2025-05-29 17:35:39,467] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,468] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,473] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=1 with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,478] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=1 with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,479] INFO [ControllerRegistrationManager id=1 incarnation=_ycqFF8nQxOQtydspCO2Zw] Found registration for EKJnkiZ_TemMu71mUpLubw instead of our incarnation. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:35:39,482] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DynamicTopicClusterQuotaPublisher controller id=1 with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,484] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ScramPublisher controller id=1 with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,488] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=1 with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,494] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,495] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing AclPublisher controller id=1 with a snapshot at offset 82408 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:39,525] INFO [ControllerRegistrationManager id=1 incarnation=_ycqFF8nQxOQtydspCO2Zw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=1, incarnationId=_ycqFF8nQxOQtydspCO2Zw, zkMigrationReady=false, listeners=[Listener(name='CONTROLLER', host='DESKTOP-T3O0CHU.localdomain', port=9093, securityProtocol=1)], features=[Feature(name='group.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='transaction.version', minSupportedVersion=0, maxSupportedVersion=2), Feature(name='eligible.leader.replicas.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), Feature(name='metadata.version', minSupportedVersion=7, maxSupportedVersion=25)]) (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:35:39,559] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2025-05-29 17:35:39,693] INFO [ControllerRegistrationManager id=1 incarnation=_ycqFF8nQxOQtydspCO2Zw] RegistrationResponseHandler: controller acknowledged ControllerRegistrationRequest. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:35:39,886] INFO [ControllerRegistrationManager id=1 incarnation=_ycqFF8nQxOQtydspCO2Zw] Our registration has been persisted to the metadata log. (kafka.server.ControllerRegistrationManager)
[2025-05-29 17:35:40,134] INFO [SocketServer listenerType=BROKER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(SSL) (kafka.network.SocketServer)
[2025-05-29 17:35:40,209] INFO [broker-1-to-controller-alter-partition-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:40,210] INFO [broker-1-to-controller-alter-partition-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:40,360] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:40,361] INFO [broker-1-to-controller-directory-assignments-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:40,386] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:40,389] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:40,390] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:40,391] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:40,393] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:40,395] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:40,453] INFO [BrokerServer id=1] Using no op persister (kafka.server.BrokerServer)
[2025-05-29 17:35:40,458] INFO [group-coordinator-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:40,573] INFO [group-coordinator-event-processor-2]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:40,574] INFO [group-coordinator-event-processor-3]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:40,564] INFO [group-coordinator-event-processor-0]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:40,573] INFO [group-coordinator-event-processor-1]: Starting (org.apache.kafka.coordinator.common.runtime.MultiThreadedEventProcessor$EventProcessorThread)
[2025-05-29 17:35:40,898] INFO [broker-1-to-controller-heartbeat-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:40,899] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:40,903] INFO [BrokerLifecycleManager id=1] Incarnation tm9WtHgYQFSC03cJEU0spA of broker 1 in cluster vN8K3C85SQS4roeM5v3xFg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:40,931] INFO [share-group-lock-timeout-reaper]: Starting (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-05-29 17:35:40,952] INFO [ExpirationReaper-0-null]: Starting (org.apache.kafka.server.purgatory.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-05-29 17:35:40,991] INFO [BrokerServer id=1] Waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:35:40,992] INFO [BrokerServer id=1] Finished waiting for the broker metadata publishers to be installed (kafka.server.BrokerServer)
[2025-05-29 17:35:40,992] INFO [BrokerServer id=1] Waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:35:40,993] INFO [BrokerLifecycleManager id=1] Successfully registered broker 1 with broker epoch 82415 (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:40,994] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing MetadataVersionPublisher(id=1) with a snapshot at offset 82414 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:40,994] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing BrokerMetadataPublisher with a snapshot at offset 82414 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:40,996] INFO [BrokerMetadataPublisher id=1] Publishing initial metadata at offset OffsetAndEpoch(offset=82414, epoch=536) with metadata.version Optional[4.0-IV3]. (kafka.server.metadata.BrokerMetadataPublisher)
[2025-05-29 17:35:40,999] INFO Loading logs from log dirs ArrayBuffer(/home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,009] INFO Skipping recovery of 57 logs from /home/ammar/kafka_data/broker1_4.0.0 since clean shutdown file was found (kafka.log.LogManager)
[2025-05-29 17:35:41,027] INFO [LogLoader partition=__consumer_offsets-20, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,044] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-20, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=20, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (1/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,053] INFO [LogLoader partition=__consumer_offsets-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,057] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-0, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 11ms (2/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,061] INFO [LogLoader partition=__consumer_offsets-8, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,063] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-8, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=8, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (3/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,069] INFO [LogLoader partition=__consumer_offsets-30, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,075] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-30, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=30, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (4/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,081] INFO [LogLoader partition=__consumer_offsets-19, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,085] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-19, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=19, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (5/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,090] INFO [LogLoader partition=__consumer_offsets-47, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,093] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-47, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=47, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (6/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,096] INFO [LogLoader partition=__consumer_offsets-27, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,099] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-27, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=27, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (7/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,105] INFO [LogLoader partition=__consumer_offsets-28, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,107] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-28, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=28, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (8/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,111] INFO [LogLoader partition=ssl-test-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,114] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-1, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (9/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,119] INFO [LogLoader partition=__consumer_offsets-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,120] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-2, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (10/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,125] INFO [LogLoader partition=__consumer_offsets-9, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,129] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-9, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=9, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (11/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,132] INFO [LogLoader partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,134] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-2, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=2, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 4ms (12/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,139] INFO [LogLoader partition=__consumer_offsets-33, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,141] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-33, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=33, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (13/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,147] INFO [LogLoader partition=__consumer_offsets-6, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,149] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-6, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=6, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (14/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,154] INFO [LogLoader partition=ssl-test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,157] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-0, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (15/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,163] INFO [LogLoader partition=__consumer_offsets-18, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,165] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-18, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=18, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (16/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,170] INFO [LogLoader partition=__consumer_offsets-16, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,172] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-16, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=16, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (17/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,178] INFO [LogLoader partition=__consumer_offsets-49, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,180] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-49, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=49, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (18/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,183] INFO [LogLoader partition=__consumer_offsets-29, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,185] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-29, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=29, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 4ms (19/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,190] INFO [LogLoader partition=__consumer_offsets-23, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,192] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-23, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=23, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (20/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,201] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,201] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,202] INFO [ProducerStateManager partition=__consumer_offsets-42] Loading producer state from snapshot file 'SnapshotFile(offset=7, file=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42/00000000000000000007.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:41,202] INFO [LogLoader partition=__consumer_offsets-42, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 0ms for segment recovery from offset 7 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,207] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-42, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=42, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=7) with 2 segments, local-log-start-offset 0 and log-end-offset 7 in 14ms (21/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,214] INFO [LogLoader partition=__consumer_offsets-36, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,216] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-36, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=36, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (22/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,224] INFO [LogLoader partition=__consumer_offsets-17, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,226] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-17, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=17, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 10ms (23/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,230] INFO [LogLoader partition=__consumer_offsets-5, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,232] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-5, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=5, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (24/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,236] INFO [LogLoader partition=__consumer_offsets-45, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,238] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-45, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=45, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (25/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,242] INFO [LogLoader partition=__consumer_offsets-12, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,245] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-12, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=12, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (26/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,248] INFO [LogLoader partition=__consumer_offsets-37, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,251] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-37, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=37, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (27/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,255] INFO [LogLoader partition=__consumer_offsets-26, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,259] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-26, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=26, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (28/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,263] INFO [LogLoader partition=__consumer_offsets-44, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,265] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-44, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=44, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (29/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,270] INFO [LogLoader partition=__consumer_offsets-32, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,272] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-32, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=32, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (30/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,277] INFO [LogLoader partition=__consumer_offsets-21, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,279] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-21, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=21, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (31/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,284] INFO [LogLoader partition=__consumer_offsets-24, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,285] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-24, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=24, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (32/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,288] INFO [LogLoader partition=__consumer_offsets-38, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,290] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-38, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=38, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (33/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,315] INFO [LogLoader partition=__consumer_offsets-14, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,317] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-14, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=14, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 27ms (34/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,321] INFO [LogLoader partition=__consumer_offsets-41, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,330] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-41, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=41, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 11ms (35/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,335] INFO [LogLoader partition=__consumer_offsets-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,337] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-1, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (36/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,343] INFO [LogLoader partition=__consumer_offsets-34, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,345] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-34, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=34, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (37/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,351] INFO [LogLoader partition=__consumer_offsets-11, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,353] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-11, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=11, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (38/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,357] INFO [LogLoader partition=__consumer_offsets-48, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,360] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-48, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=48, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (39/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,367] INFO [LogLoader partition=__consumer_offsets-25, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,369] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-25, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=25, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (40/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,374] INFO [LogLoader partition=__consumer_offsets-43, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,376] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-43, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=43, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (41/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,382] INFO [LogLoader partition=__consumer_offsets-10, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,384] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-10, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=10, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (42/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,392] INFO [LogLoader partition=__consumer_offsets-31, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,398] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-31, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=31, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 12ms (43/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,405] INFO [LogLoader partition=test-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 1 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,415] INFO [ProducerStateManager partition=test-topic-0] Wrote producer snapshot at offset 1 with 0 producer ids in 10 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:41,417] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/test-topic-0, topicId=5IOimlizQSmAmZHYHObOxA, topic=test-topic, partition=0, highWatermark=1, lastStableOffset=1, logStartOffset=1, logEndOffset=1) with 1 segments, local-log-start-offset 1 and log-end-offset 1 in 19ms (44/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,422] INFO [LogLoader partition=__consumer_offsets-15, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,424] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-15, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=15, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (45/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,428] INFO [LogLoader partition=__consumer_offsets-13, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,430] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-13, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=13, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (46/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,439] INFO [LogLoader partition=ssl-test-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 2 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,449] INFO [ProducerStateManager partition=ssl-test-topic-2] Wrote producer snapshot at offset 2 with 0 producer ids in 8 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:41,452] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/ssl-test-topic-2, topicId=k-JenWSBQ5y9bMuFSqN-pA, topic=ssl-test-topic, partition=2, highWatermark=2, lastStableOffset=2, logStartOffset=2, logEndOffset=2) with 1 segments, local-log-start-offset 2 and log-end-offset 2 in 20ms (47/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,455] INFO [LogLoader partition=__consumer_offsets-22, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,461] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-22, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=22, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (48/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,467] INFO [LogLoader partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,470] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-0, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=0, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (49/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,474] INFO [LogLoader partition=__consumer_offsets-4, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,476] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-4, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=4, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (50/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,484] INFO [LogLoader partition=__consumer_offsets-46, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,485] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-46, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=46, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (51/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,489] INFO [LogLoader partition=__consumer_offsets-40, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,491] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-40, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=40, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (52/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,497] INFO [LogLoader partition=__consumer_offsets-3, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,499] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-3, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=3, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 8ms (53/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,502] INFO [LogLoader partition=__consumer_offsets-35, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,504] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-35, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=35, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 5ms (54/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,507] INFO [LogLoader partition=__consumer_offsets-39, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,510] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-39, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=39, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 6ms (55/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,515] INFO [LogLoader partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,519] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/my-topic-1, topicId=P_42li05RQ6ikIgdf1uRrA, topic=my-topic, partition=1, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 7ms (56/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,527] INFO [LogLoader partition=__consumer_offsets-7, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 0 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:41,531] INFO Completed load of Log(dir=/home/ammar/kafka_data/broker1_4.0.0/__consumer_offsets-7, topicId=IGQEjktFSlaQpJR3kF7FvA, topic=__consumer_offsets, partition=7, highWatermark=0, lastStableOffset=0, logStartOffset=0, logEndOffset=0) with 1 segments, local-log-start-offset 0 and log-end-offset 0 in 9ms (57/57 completed in /home/ammar/kafka_data/broker1_4.0.0) (kafka.log.LogManager)
[2025-05-29 17:35:41,547] INFO Loaded 57 logs in 538ms (kafka.log.LogManager)
[2025-05-29 17:35:41,549] INFO Starting log cleanup with a period of 300000 ms. (kafka.log.LogManager)
[2025-05-29 17:35:41,551] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2025-05-29 17:35:41,755] INFO [kafka-log-cleaner-thread-0]: Starting (kafka.log.LogCleaner$CleanerThread)
[2025-05-29 17:35:41,760] INFO [LogDirFailureHandler]: Starting (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-05-29 17:35:41,762] INFO [AddPartitionsToTxnSenderThread-1]: Starting (kafka.server.AddPartitionsToTxnManager)
[2025-05-29 17:35:41,768] INFO [GroupCoordinator id=1] Starting up. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:35:41,771] INFO [GroupCoordinator id=1] Startup complete. (org.apache.kafka.coordinator.group.GroupCoordinatorService)
[2025-05-29 17:35:41,773] INFO [TransactionCoordinator id=1] Starting up. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:35:41,779] INFO [TxnMarkerSenderThread-1]: Starting (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-05-29 17:35:41,779] INFO [TransactionCoordinator id=1] Startup complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-05-29 17:35:41,843] INFO [Partition __consumer_offsets-13 broker=1] Log loaded for partition __consumer_offsets-13 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,859] INFO [Partition __consumer_offsets-46 broker=1] Log loaded for partition __consumer_offsets-46 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,867] INFO [Partition __consumer_offsets-9 broker=1] Log loaded for partition __consumer_offsets-9 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,870] INFO [Partition __consumer_offsets-42 broker=1] Log loaded for partition __consumer_offsets-42 with initial high watermark 7 (kafka.cluster.Partition)
[2025-05-29 17:35:41,872] INFO [Partition __consumer_offsets-21 broker=1] Log loaded for partition __consumer_offsets-21 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,874] INFO [Partition __consumer_offsets-17 broker=1] Log loaded for partition __consumer_offsets-17 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,877] INFO [Partition ssl-test-topic-0 broker=1] Log loaded for partition ssl-test-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,882] INFO [Partition __consumer_offsets-30 broker=1] Log loaded for partition __consumer_offsets-30 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,884] INFO [Partition __consumer_offsets-26 broker=1] Log loaded for partition __consumer_offsets-26 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,887] INFO [Partition __consumer_offsets-5 broker=1] Log loaded for partition __consumer_offsets-5 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,889] INFO [Partition __consumer_offsets-38 broker=1] Log loaded for partition __consumer_offsets-38 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,892] INFO [Partition my-topic-0 broker=1] Log loaded for partition my-topic-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,900] INFO [Partition __consumer_offsets-1 broker=1] Log loaded for partition __consumer_offsets-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,905] INFO [Partition __consumer_offsets-34 broker=1] Log loaded for partition __consumer_offsets-34 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,908] INFO [Partition __consumer_offsets-16 broker=1] Log loaded for partition __consumer_offsets-16 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,911] INFO [Partition __consumer_offsets-45 broker=1] Log loaded for partition __consumer_offsets-45 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,913] INFO [Partition __consumer_offsets-12 broker=1] Log loaded for partition __consumer_offsets-12 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,917] INFO [Partition __consumer_offsets-41 broker=1] Log loaded for partition __consumer_offsets-41 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,920] INFO [Partition __consumer_offsets-24 broker=1] Log loaded for partition __consumer_offsets-24 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,926] INFO [Partition __consumer_offsets-20 broker=1] Log loaded for partition __consumer_offsets-20 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,928] INFO [Partition __consumer_offsets-49 broker=1] Log loaded for partition __consumer_offsets-49 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,930] INFO [Partition __consumer_offsets-0 broker=1] Log loaded for partition __consumer_offsets-0 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,933] INFO [Partition ssl-test-topic-1 broker=1] Log loaded for partition ssl-test-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,935] INFO [Partition __consumer_offsets-29 broker=1] Log loaded for partition __consumer_offsets-29 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,942] INFO [Partition __consumer_offsets-25 broker=1] Log loaded for partition __consumer_offsets-25 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,944] INFO [Partition __consumer_offsets-8 broker=1] Log loaded for partition __consumer_offsets-8 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,945] INFO [Partition __consumer_offsets-37 broker=1] Log loaded for partition __consumer_offsets-37 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,947] INFO [Partition my-topic-1 broker=1] Log loaded for partition my-topic-1 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,949] INFO [Partition __consumer_offsets-4 broker=1] Log loaded for partition __consumer_offsets-4 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,950] INFO [Partition __consumer_offsets-33 broker=1] Log loaded for partition __consumer_offsets-33 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,952] INFO [Partition __consumer_offsets-15 broker=1] Log loaded for partition __consumer_offsets-15 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,960] INFO [Partition __consumer_offsets-48 broker=1] Log loaded for partition __consumer_offsets-48 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,962] INFO [Partition __consumer_offsets-11 broker=1] Log loaded for partition __consumer_offsets-11 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,964] INFO [Partition __consumer_offsets-44 broker=1] Log loaded for partition __consumer_offsets-44 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,965] INFO [Partition __consumer_offsets-23 broker=1] Log loaded for partition __consumer_offsets-23 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,967] INFO [Partition __consumer_offsets-19 broker=1] Log loaded for partition __consumer_offsets-19 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,974] INFO [Partition ssl-test-topic-2 broker=1] Log loaded for partition ssl-test-topic-2 with initial high watermark 2 (kafka.cluster.Partition)
[2025-05-29 17:35:41,977] INFO [Partition __consumer_offsets-32 broker=1] Log loaded for partition __consumer_offsets-32 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,980] INFO [Partition test-topic-0 broker=1] Log loaded for partition test-topic-0 with initial high watermark 1 (kafka.cluster.Partition)
[2025-05-29 17:35:41,982] INFO [Partition __consumer_offsets-28 broker=1] Log loaded for partition __consumer_offsets-28 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,985] INFO [Partition __consumer_offsets-7 broker=1] Log loaded for partition __consumer_offsets-7 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,991] INFO [Partition __consumer_offsets-40 broker=1] Log loaded for partition __consumer_offsets-40 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,996] INFO [Partition __consumer_offsets-3 broker=1] Log loaded for partition __consumer_offsets-3 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:41,998] INFO [Partition __consumer_offsets-36 broker=1] Log loaded for partition __consumer_offsets-36 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,003] INFO [Partition my-topic-2 broker=1] Log loaded for partition my-topic-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,006] INFO [Partition __consumer_offsets-47 broker=1] Log loaded for partition __consumer_offsets-47 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,008] INFO [Partition __consumer_offsets-14 broker=1] Log loaded for partition __consumer_offsets-14 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,010] INFO [Partition __consumer_offsets-43 broker=1] Log loaded for partition __consumer_offsets-43 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,013] INFO [Partition __consumer_offsets-10 broker=1] Log loaded for partition __consumer_offsets-10 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,017] INFO [Partition __consumer_offsets-22 broker=1] Log loaded for partition __consumer_offsets-22 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,020] INFO [Partition __consumer_offsets-18 broker=1] Log loaded for partition __consumer_offsets-18 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,023] INFO [Partition __consumer_offsets-31 broker=1] Log loaded for partition __consumer_offsets-31 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,026] INFO [Partition __consumer_offsets-27 broker=1] Log loaded for partition __consumer_offsets-27 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,029] INFO [Partition __consumer_offsets-39 broker=1] Log loaded for partition __consumer_offsets-39 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,032] INFO [Partition __consumer_offsets-6 broker=1] Log loaded for partition __consumer_offsets-6 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,034] INFO [Partition __consumer_offsets-35 broker=1] Log loaded for partition __consumer_offsets-35 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,038] INFO [Partition __consumer_offsets-2 broker=1] Log loaded for partition __consumer_offsets-2 with initial high watermark 0 (kafka.cluster.Partition)
[2025-05-29 17:35:42,045] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(__consumer_offsets-13, __consumer_offsets-46, __consumer_offsets-9, __consumer_offsets-42, __consumer_offsets-21, __consumer_offsets-17, ssl-test-topic-0, __consumer_offsets-30, __consumer_offsets-26, __consumer_offsets-5, __consumer_offsets-38, my-topic-0, __consumer_offsets-1, __consumer_offsets-34, __consumer_offsets-16, __consumer_offsets-45, __consumer_offsets-12, __consumer_offsets-41, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-49, __consumer_offsets-0, ssl-test-topic-1, __consumer_offsets-29, __consumer_offsets-25, __consumer_offsets-8, __consumer_offsets-37, my-topic-1, __consumer_offsets-4, __consumer_offsets-33, __consumer_offsets-15, __consumer_offsets-48, __consumer_offsets-11, __consumer_offsets-44, __consumer_offsets-23, __consumer_offsets-19, ssl-test-topic-2, __consumer_offsets-32, test-topic-0, __consumer_offsets-28, __consumer_offsets-7, __consumer_offsets-40, __consumer_offsets-3, __consumer_offsets-36, my-topic-2, __consumer_offsets-47, __consumer_offsets-14, __consumer_offsets-43, __consumer_offsets-10, __consumer_offsets-22, __consumer_offsets-18, __consumer_offsets-31, __consumer_offsets-27, __consumer_offsets-39, __consumer_offsets-6, __consumer_offsets-35, __consumer_offsets-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:42,291] INFO [ReplicaFetcherThread-0-3]: Starting (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:35:42,313] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Truncating partition my-topic-0 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:35:42,318] INFO [ReplicaFetcherManager on broker 1] Added fetcher to broker 3 for partitions HashMap(my-topic-0 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),22,0), my-topic-1 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),20,0), my-topic-2 -> InitialFetchState(Some(P_42li05RQ6ikIgdf1uRrA),BrokerEndPoint(id=3, host=172.23.38.230:9097),21,0)) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:42,330] INFO [UnifiedLog partition=my-topic-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:35:42,341] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Truncating partition my-topic-1 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:35:42,342] INFO [UnifiedLog partition=my-topic-1, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:35:42,342] INFO [ReplicaFetcher replicaId=1, leaderId=3, fetcherId=0] Truncating partition my-topic-2 with TruncationState(offset=0, completed=true) due to local high watermark 0 (kafka.server.ReplicaFetcherThread)
[2025-05-29 17:35:42,342] INFO [UnifiedLog partition=my-topic-2, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to 0 has no effect as the largest offset in the log is -1 (kafka.log.UnifiedLog)
[2025-05-29 17:35:42,419] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-13 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,431] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-46 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,431] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-9 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,431] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-13 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,431] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-46 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,431] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-42 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-21 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,431] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-9 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-42 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-21 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-17 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-30 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-17 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-26 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-30 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-26 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,432] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-5 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-38 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-5 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-1 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-38 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-34 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-16 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-45 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-16 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-12 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-41 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-34 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-24 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-45 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,433] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-1 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-20 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-24 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-41 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-49 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-12 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-49 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,434] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-20 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-0 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-29 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-0 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-25 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-8 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-29 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-37 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-25 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,435] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-8 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-4 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-37 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-33 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-4 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-15 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-48 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-33 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-11 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-15 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,436] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-48 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,437] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-44 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,437] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-11 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,437] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-23 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,437] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-44 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,437] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-19 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,437] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-23 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,438] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-19 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,438] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-32 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,446] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-28 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,447] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-7 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,447] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-40 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,447] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-3 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,447] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-36 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,447] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-32 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,447] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-3 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-36 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,447] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-47 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-7 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-40 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-28 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-14 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-47 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-43 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-14 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-10 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,448] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-43 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,449] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-10 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,452] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-22 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-18 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-22 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-31 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-18 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-27 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-31 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-39 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-27 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-6 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,453] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-39 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,454] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-35 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,454] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-6 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,454] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-35 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,454] INFO [GroupCoordinator id=1] Scheduling unloading of metadata for __consumer_offsets-2 with epoch OptionalInt[25] (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,459] INFO [GroupCoordinator id=1] Ignored unloading metadata for __consumer_offsets-2 in epoch OptionalInt[25] since metadata was never loaded. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:42,470] INFO [DynamicConfigPublisher broker id=1] Updating topic __consumer_offsets with new configuration : compression.type -> producer,cleanup.policy -> compact,segment.bytes -> 104857600 (kafka.server.metadata.DynamicConfigPublisher)
[2025-05-29 17:35:42,496] INFO [MetadataLoader id=1] InitializeNewPublishers: initializing BrokerRegistrationTracker(id=1) with a snapshot at offset 82414 (org.apache.kafka.image.loader.MetadataLoader)
[2025-05-29 17:35:42,506] INFO [BrokerLifecycleManager id=1] The broker has caught up. Transitioning from STARTING to RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:42,507] INFO [BrokerServer id=1] Finished waiting for the controller to acknowledge that we are caught up (kafka.server.BrokerServer)
[2025-05-29 17:35:42,507] INFO [BrokerServer id=1] Waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:35:42,507] INFO [BrokerServer id=1] Finished waiting for the initial broker metadata update to be published (kafka.server.BrokerServer)
[2025-05-29 17:35:42,510] INFO KafkaConfig values: 
	add.partitions.to.txn.retry.backoff.max.ms = 100
	add.partitions.to.txn.retry.backoff.ms = 20
	advertised.listeners = SSL://172.23.38.230:9092
	alter.config.policy.class.name = null
	alter.log.dirs.replication.quota.window.num = 11
	alter.log.dirs.replication.quota.window.size.seconds = 1
	authorizer.class.name = 
	auto.create.topics.enable = true
	auto.leader.rebalance.enable = true
	background.threads = 10
	broker.heartbeat.interval.ms = 2000
	broker.id = 1
	broker.rack = null
	broker.session.timeout.ms = 9000
	client.quota.callback.class = null
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = producer
	compression.zstd.level = 3
	connection.failed.authentication.delay.ms = 100
	connections.max.idle.ms = 600000
	connections.max.reauth.ms = 0
	controlled.shutdown.enable = true
	controller.listener.names = CONTROLLER
	controller.performance.always.log.threshold.ms = 2000
	controller.performance.sample.period.ms = 60000
	controller.quorum.append.linger.ms = 25
	controller.quorum.bootstrap.servers = []
	controller.quorum.election.backoff.max.ms = 1000
	controller.quorum.election.timeout.ms = 1000
	controller.quorum.fetch.timeout.ms = 2000
	controller.quorum.request.timeout.ms = 2000
	controller.quorum.retry.backoff.ms = 20
	controller.quorum.voters = [1@localhost:9093, 2@localhost:9096, 3@localhost:9099]
	controller.quota.window.num = 11
	controller.quota.window.size.seconds = 1
	controller.socket.timeout.ms = 30000
	create.topic.policy.class.name = null
	default.replication.factor = 3
	delegation.token.expiry.check.interval.ms = 3600000
	delegation.token.expiry.time.ms = 86400000
	delegation.token.max.lifetime.ms = 604800000
	delegation.token.secret.key = null
	delete.records.purgatory.purge.interval.requests = 1
	delete.topic.enable = true
	early.start.listeners = null
	fetch.max.bytes = 57671680
	fetch.purgatory.purge.interval.requests = 1000
	group.consumer.assignors = [uniform, range]
	group.consumer.heartbeat.interval.ms = 5000
	group.consumer.max.heartbeat.interval.ms = 15000
	group.consumer.max.session.timeout.ms = 60000
	group.consumer.max.size = 2147483647
	group.consumer.migration.policy = bidirectional
	group.consumer.min.heartbeat.interval.ms = 5000
	group.consumer.min.session.timeout.ms = 45000
	group.consumer.session.timeout.ms = 45000
	group.coordinator.append.linger.ms = 5
	group.coordinator.new.enable = true
	group.coordinator.rebalance.protocols = [classic, consumer]
	group.coordinator.threads = 4
	group.initial.rebalance.delay.ms = 3000
	group.max.session.timeout.ms = 1800000
	group.max.size = 2147483647
	group.min.session.timeout.ms = 6000
	group.share.delivery.count.limit = 5
	group.share.enable = false
	group.share.heartbeat.interval.ms = 5000
	group.share.max.groups = 10
	group.share.max.heartbeat.interval.ms = 15000
	group.share.max.record.lock.duration.ms = 60000
	group.share.max.session.timeout.ms = 60000
	group.share.max.size = 200
	group.share.min.heartbeat.interval.ms = 5000
	group.share.min.record.lock.duration.ms = 15000
	group.share.min.session.timeout.ms = 45000
	group.share.partition.max.record.locks = 200
	group.share.persister.class.name = org.apache.kafka.server.share.persister.DefaultStatePersister
	group.share.record.lock.duration.ms = 30000
	group.share.session.timeout.ms = 45000
	initial.broker.registration.timeout.ms = 60000
	inter.broker.listener.name = SSL
	kafka.metrics.polling.interval.secs = 10
	kafka.metrics.reporters = []
	leader.imbalance.check.interval.seconds = 300
	listener.security.protocol.map = SSL:SSL,CONTROLLER:SSL
	listeners = SSL://0.0.0.0:9092,CONTROLLER://:9093
	log.cleaner.backoff.ms = 15000
	log.cleaner.dedupe.buffer.size = 134217728
	log.cleaner.delete.retention.ms = 86400000
	log.cleaner.enable = true
	log.cleaner.io.buffer.load.factor = 0.9
	log.cleaner.io.buffer.size = 524288
	log.cleaner.io.max.bytes.per.second = 1.7976931348623157E308
	log.cleaner.max.compaction.lag.ms = 9223372036854775807
	log.cleaner.min.cleanable.ratio = 0.5
	log.cleaner.min.compaction.lag.ms = 0
	log.cleaner.threads = 1
	log.cleanup.policy = [delete]
	log.dir = /tmp/kafka-logs
	log.dir.failure.timeout.ms = 30000
	log.dirs = /home/ammar/kafka_data/broker1_4.0.0
	log.flush.interval.messages = 9223372036854775807
	log.flush.interval.ms = null
	log.flush.offset.checkpoint.interval.ms = 60000
	log.flush.scheduler.interval.ms = 9223372036854775807
	log.flush.start.offset.checkpoint.interval.ms = 60000
	log.index.interval.bytes = 4096
	log.index.size.max.bytes = 10485760
	log.initial.task.delay.ms = 30000
	log.local.retention.bytes = -2
	log.local.retention.ms = -2
	log.message.timestamp.after.max.ms = 3600000
	log.message.timestamp.before.max.ms = 9223372036854775807
	log.message.timestamp.type = CreateTime
	log.preallocate = false
	log.retention.bytes = -1
	log.retention.check.interval.ms = 300000
	log.retention.hours = 168
	log.retention.minutes = null
	log.retention.ms = null
	log.roll.hours = 168
	log.roll.jitter.hours = 0
	log.roll.jitter.ms = null
	log.roll.ms = null
	log.segment.bytes = 1073741824
	log.segment.delete.delay.ms = 60000
	max.connection.creation.rate = 2147483647
	max.connections = 2147483647
	max.connections.per.ip = 2147483647
	max.connections.per.ip.overrides = 
	max.incremental.fetch.session.cache.slots = 1000
	max.request.partition.size.limit = 2000
	message.max.bytes = 1048588
	metadata.log.dir = null
	metadata.log.max.record.bytes.between.snapshots = 20971520
	metadata.log.max.snapshot.interval.ms = 3600000
	metadata.log.segment.bytes = 1073741824
	metadata.log.segment.min.bytes = 8388608
	metadata.log.segment.ms = 604800000
	metadata.max.idle.interval.ms = 500
	metadata.max.retention.bytes = 104857600
	metadata.max.retention.ms = 604800000
	metric.reporters = [org.apache.kafka.common.metrics.JmxReporter]
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	min.insync.replicas = 2
	node.id = 1
	num.io.threads = 8
	num.network.threads = 3
	num.partitions = 1
	num.recovery.threads.per.data.dir = 1
	num.replica.alter.log.dirs.threads = null
	num.replica.fetchers = 1
	offset.metadata.max.bytes = 4096
	offsets.commit.timeout.ms = 5000
	offsets.load.buffer.size = 5242880
	offsets.retention.check.interval.ms = 600000
	offsets.retention.minutes = 10080
	offsets.topic.compression.codec = 0
	offsets.topic.num.partitions = 50
	offsets.topic.replication.factor = 3
	offsets.topic.segment.bytes = 104857600
	principal.builder.class = class org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder
	process.roles = [broker, controller]
	producer.id.expiration.check.interval.ms = 600000
	producer.id.expiration.ms = 86400000
	producer.purgatory.purge.interval.requests = 1000
	queued.max.request.bytes = -1
	queued.max.requests = 500
	quota.window.num = 11
	quota.window.size.seconds = 1
	remote.fetch.max.wait.ms = 500
	remote.list.offsets.request.timeout.ms = 30000
	remote.log.index.file.cache.total.size.bytes = 1073741824
	remote.log.manager.copier.thread.pool.size = 10
	remote.log.manager.copy.max.bytes.per.second = 9223372036854775807
	remote.log.manager.copy.quota.window.num = 11
	remote.log.manager.copy.quota.window.size.seconds = 1
	remote.log.manager.expiration.thread.pool.size = 10
	remote.log.manager.fetch.max.bytes.per.second = 9223372036854775807
	remote.log.manager.fetch.quota.window.num = 11
	remote.log.manager.fetch.quota.window.size.seconds = 1
	remote.log.manager.task.interval.ms = 30000
	remote.log.manager.task.retry.backoff.max.ms = 30000
	remote.log.manager.task.retry.backoff.ms = 500
	remote.log.manager.task.retry.jitter = 0.2
	remote.log.manager.thread.pool.size = 2
	remote.log.metadata.custom.metadata.max.bytes = 128
	remote.log.metadata.manager.class.name = org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager
	remote.log.metadata.manager.class.path = null
	remote.log.metadata.manager.impl.prefix = rlmm.config.
	remote.log.metadata.manager.listener.name = null
	remote.log.reader.max.pending.tasks = 100
	remote.log.reader.threads = 10
	remote.log.storage.manager.class.name = null
	remote.log.storage.manager.class.path = null
	remote.log.storage.manager.impl.prefix = rsm.config.
	remote.log.storage.system.enable = false
	replica.fetch.backoff.ms = 1000
	replica.fetch.max.bytes = 1048576
	replica.fetch.min.bytes = 1
	replica.fetch.response.max.bytes = 10485760
	replica.fetch.wait.max.ms = 500
	replica.high.watermark.checkpoint.interval.ms = 5000
	replica.lag.time.max.ms = 30000
	replica.selector.class = null
	replica.socket.receive.buffer.bytes = 65536
	replica.socket.timeout.ms = 30000
	replication.quota.window.num = 11
	replication.quota.window.size.seconds = 1
	request.timeout.ms = 30000
	sasl.client.callback.handler.class = null
	sasl.enabled.mechanisms = [GSSAPI]
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.principal.to.local.rules = [DEFAULT]
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism.controller.protocol = GSSAPI
	sasl.mechanism.inter.broker.protocol = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	sasl.server.callback.handler.class = null
	sasl.server.max.receive.size = 524288
	security.inter.broker.protocol = PLAINTEXT
	security.providers = null
	server.max.startup.time.ms = 9223372036854775807
	share.coordinator.append.linger.ms = 10
	share.coordinator.load.buffer.size = 5242880
	share.coordinator.snapshot.update.records.per.snapshot = 500
	share.coordinator.state.topic.compression.codec = 0
	share.coordinator.state.topic.min.isr = 2
	share.coordinator.state.topic.num.partitions = 50
	share.coordinator.state.topic.prune.interval.ms = 300000
	share.coordinator.state.topic.replication.factor = 3
	share.coordinator.state.topic.segment.bytes = 104857600
	share.coordinator.threads = 1
	share.coordinator.write.timeout.ms = 5000
	share.fetch.max.fetch.records = 2147483647
	share.fetch.purgatory.purge.interval.requests = 1000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	socket.listen.backlog.size = 50
	socket.receive.buffer.bytes = 102400
	socket.request.max.bytes = 104857600
	socket.send.buffer.bytes = 102400
	ssl.allow.dn.changes = false
	ssl.allow.san.changes = false
	ssl.cipher.suites = []
	ssl.client.auth = required
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = 
	ssl.engine.factory.class = null
	ssl.key.password = [hidden]
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.keystore.jks
	ssl.keystore.password = [hidden]
	ssl.keystore.type = JKS
	ssl.principal.mapping.rules = DEFAULT
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = /home/ammar/kafka_2.13-4.0.0/config/kraft/ssl/server/kafka.server.truststore.jks
	ssl.truststore.password = [hidden]
	ssl.truststore.type = JKS
	telemetry.max.bytes = 1048576
	transaction.abort.timed.out.transaction.cleanup.interval.ms = 10000
	transaction.max.timeout.ms = 900000
	transaction.partition.verification.enable = true
	transaction.remove.expired.transaction.cleanup.interval.ms = 3600000
	transaction.state.log.load.buffer.size = 5242880
	transaction.state.log.min.isr = 2
	transaction.state.log.num.partitions = 50
	transaction.state.log.replication.factor = 3
	transaction.state.log.segment.bytes = 104857600
	transactional.id.expiration.ms = 604800000
	unclean.leader.election.enable = false
	unclean.leader.election.interval.ms = 300000
	unstable.api.versions.enable = false
	unstable.feature.versions.enable = false
 (org.apache.kafka.common.config.AbstractConfig)
[2025-05-29 17:35:42,526] INFO [BrokerLifecycleManager id=1] The broker is in RECOVERY. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:42,529] INFO [BrokerServer id=1] Waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:35:42,618] INFO [BrokerLifecycleManager id=1] The broker has been unfenced. Transitioning from RECOVERY to RUNNING. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:35:42,618] INFO [BrokerServer id=1] Finished waiting for the broker to be unfenced (kafka.server.BrokerServer)
[2025-05-29 17:35:42,620] INFO authorizerStart completed for endpoint SSL. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2025-05-29 17:35:42,620] INFO [SocketServer listenerType=BROKER, nodeId=1] Enabling request processing. (kafka.network.SocketServer)
[2025-05-29 17:35:42,621] INFO Awaiting socket connections on 0.0.0.0:9092. (kafka.network.DataPlaneAcceptor)
[2025-05-29 17:35:42,623] INFO [BrokerServer id=1] Waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:35:42,623] INFO [BrokerServer id=1] Finished waiting for all of the authorizer futures to be completed (kafka.server.BrokerServer)
[2025-05-29 17:35:42,623] INFO [BrokerServer id=1] Waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:35:42,624] INFO [BrokerServer id=1] Finished waiting for all of the SocketServer Acceptors to be started (kafka.server.BrokerServer)
[2025-05-29 17:35:42,624] INFO [BrokerServer id=1] Transition from STARTING to STARTED (kafka.server.BrokerServer)
[2025-05-29 17:35:42,626] INFO Kafka version: 4.0.0 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:35:42,626] INFO Kafka commitId: 985bc99521dd22bb (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:35:42,627] INFO Kafka startTimeMs: 1748529342624 (org.apache.kafka.common.utils.AppInfoParser)
[2025-05-29 17:35:42,632] INFO [KafkaRaftServer nodeId=1] Kafka Server started (kafka.server.KafkaRaftServer)
[2025-05-29 17:35:42,873] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions Set(__consumer_offsets-13, __consumer_offsets-46, __consumer_offsets-9, __consumer_offsets-42, __consumer_offsets-21, __consumer_offsets-17, ssl-test-topic-0, __consumer_offsets-30, __consumer_offsets-26, __consumer_offsets-5, __consumer_offsets-38, __consumer_offsets-1, __consumer_offsets-34, __consumer_offsets-16, __consumer_offsets-45, __consumer_offsets-12, __consumer_offsets-41, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-49, __consumer_offsets-0, ssl-test-topic-1, __consumer_offsets-29, __consumer_offsets-25, __consumer_offsets-8, __consumer_offsets-37, __consumer_offsets-4, __consumer_offsets-33, __consumer_offsets-15, __consumer_offsets-48, __consumer_offsets-11, __consumer_offsets-44, __consumer_offsets-23, __consumer_offsets-19, ssl-test-topic-2, __consumer_offsets-32, test-topic-0, __consumer_offsets-28, __consumer_offsets-7, __consumer_offsets-40, __consumer_offsets-3, __consumer_offsets-36, __consumer_offsets-47, __consumer_offsets-14, __consumer_offsets-43, __consumer_offsets-10, __consumer_offsets-22, __consumer_offsets-18, __consumer_offsets-31, __consumer_offsets-27, __consumer_offsets-39, __consumer_offsets-6, __consumer_offsets-35, __consumer_offsets-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:43,062] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-0) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:43,063] INFO [Partition my-topic-0 broker=3] ISR updated to 3,2,1  and version updated to 55 (kafka.cluster.Partition)
[2025-05-29 17:35:43,110] INFO [ReplicaFetcherManager on broker 3] Removed fetcher for partitions Set(my-topic-1, my-topic-2) (kafka.server.ReplicaFetcherManager)
[2025-05-29 17:35:43,575] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-13 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,582] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-46 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,583] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-9 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,583] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-42 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,584] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-21 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,584] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-17 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,585] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-30 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,587] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-26 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,589] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-5 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,593] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-38 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,594] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-1 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,594] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-34 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,595] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-16 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,595] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-45 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,596] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-12 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,597] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-41 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,597] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-24 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,597] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-20 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,598] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-49 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,598] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-0 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,599] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-29 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,599] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-25 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,600] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-8 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,600] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-37 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,600] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-4 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,601] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-33 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,601] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-15 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,602] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-48 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,602] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-11 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,603] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-44 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,603] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-23 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,606] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-19 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,607] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-32 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,607] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-28 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,608] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-7 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,608] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-40 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,608] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-3 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,609] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-36 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,609] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-47 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,609] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-14 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,610] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-43 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,610] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-10 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,612] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-22 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,612] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-18 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,613] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-31 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,613] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-27 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,613] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-39 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,614] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-6 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,614] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-35 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,615] INFO [GroupCoordinator id=1] Scheduling loading of metadata from __consumer_offsets-2 with epoch 26 (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,647] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-13 with epoch 26 in 3ms where 2ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,670] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-42 with epoch 26 in 47ms where 5ms was spent in the scheduler. Loaded 3 records which total to 592 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-17 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-28 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,670] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-9 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-14 with epoch 26 in 44ms where 44ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-46 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-47 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-31 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-36 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-18 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-0 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-30 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-39 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,671] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-10 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-22 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-20 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-35 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-33 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-40 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-15 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-44 with epoch 26 in 43ms where 43ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-1 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-26 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-41 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,672] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-37 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-6 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-25 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-4 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-23 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-5 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-8 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-7 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-38 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-11 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,674] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-48 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,675] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-2 with epoch 26 in 41ms where 41ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,675] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-34 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,675] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-49 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,675] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-32 with epoch 26 in 40ms where 40ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,675] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-24 with epoch 26 in 38ms where 38ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,675] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-3 with epoch 26 in 38ms where 38ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,676] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-21 with epoch 26 in 37ms where 37ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,676] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-29 with epoch 26 in 37ms where 37ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,676] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-27 with epoch 26 in 37ms where 37ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,676] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-16 with epoch 26 in 37ms where 37ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,676] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-19 with epoch 26 in 34ms where 34ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,673] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-12 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,674] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-45 with epoch 26 in 42ms where 42ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:43,676] INFO [GroupCoordinator id=1] Finished loading of metadata from __consumer_offsets-43 with epoch 26 in 37ms where 37ms was spent in the scheduler. Loaded 0 records which total to 0 bytes. (org.apache.kafka.coordinator.common.runtime.CoordinatorRuntime)
[2025-05-29 17:35:55,558] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,559] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=536, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1567, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,560] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:55,560] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 3534 due to node 3 being disconnected (elapsed time since creation: 3200ms, elapsed time since send: 3200ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:55,571] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:35:55,571] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 82497 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,572] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 82497 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,573] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=536, voters=[1, 2, 3], electionTimeoutMs=1679, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=536, epochStartOffset=82078, highWatermark=Optional[LogOffsetMetadata(offset=82497, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899025)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82497, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899025)])], lastFetchTimestamp=1748529352362, lastCaughtUpTimestamp=1748529352362, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82497, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899025)])], lastFetchTimestamp=1748529352360, lastCaughtUpTimestamp=1748529352360, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82497, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899025)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,574] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,583] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=536, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=<undefined>)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1045, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=536, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=localhost/127.0.0.1:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=<undefined>)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,605] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=536, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=true)])]) with epoch 536 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,612] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=537, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1623) from ProspectiveState(epoch=536, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=<undefined>)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1045, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,659] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=536, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=true)])]) with epoch 536 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,663] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=536, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=true)])]) with epoch 536 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,664] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=537, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1445) from ProspectiveState(epoch=536, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1567, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,683] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=537, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1623) from ProspectiveState(epoch=536, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=<undefined>)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1045, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,687] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1564, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=536, voters=[1, 2, 3], electionTimeoutMs=1679, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,703] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=537, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1445) from ProspectiveState(epoch=536, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1567, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,704] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=537, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=false)])]) with epoch 537 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,721] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=537, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=false)])]) with epoch 537 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,733] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1564, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=536, voters=[1, 2, 3], electionTimeoutMs=1679, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,734] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1797, highWatermark=Optional.empty) from UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1564, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,756] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1797, highWatermark=Optional.empty) from UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1564, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,757] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=537, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=false)])]) with epoch 537 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,757] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=537, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=false)])]) with epoch 537 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,758] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,759] INFO [RaftManager id=2] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,759] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=537, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1679, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=537, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1445) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,760] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=537, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=true)])]) with epoch 537 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,762] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=538, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1644) from ProspectiveState(epoch=537, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1679, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,768] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=537, epochStartOffset=82497, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=537, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1623) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,776] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=538, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1644) from ProspectiveState(epoch=537, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1679, highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,779] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1753, highWatermark=Optional.empty) from UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1797, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,785] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=537, epochStartOffset=82497, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=537, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1623) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,799] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1753, highWatermark=Optional.empty) from UnattachedState(epoch=537, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1797, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,800] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) from UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1753, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,821] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) from UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1753, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,821] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=538, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=false)])]) with epoch 538 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,823] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=538, epochStartOffset=82497, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=538, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1644) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,853] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=538, epochStartOffset=82497, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=538, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82496, metadata=Optional.empty)], electionTimeoutMs=1644) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,876] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=537, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=true)])]) with epoch 537 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,880] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,881] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1400, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=537, epochStartOffset=82497, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82498, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899131)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,898] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,921] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1400, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=537, epochStartOffset=82497, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82498, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899131)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,923] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=538, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=536, lastOffset=82497, preVote=false)])]) with epoch 538 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,926] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1400, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,943] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=538, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1400, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:35:55,948] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to offset 82497 (kafka.log.UnifiedLog)
[2025-05-29 17:35:55,952] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 82497 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:55,953] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 82497 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:55,953] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=82394, file=/home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000082394.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:55,963] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=82498, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899131)]) for the first time for epoch 538 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82498, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899131)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82498, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2899131)])], lastFetchTimestamp=1748529355962, lastCaughtUpTimestamp=1748529355962, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:35:55,971] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 82497 with 0 producer ids in 14 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:35:55,971] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 1ms for snapshot load and 17ms for segment recovery from offset 82497 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:35:55,971] INFO [RaftManager id=1] Truncated to offset 82497 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:35:55,996] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=82498, metadata=Optional.empty)] for the first time for epoch 538 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:35:56,464] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=82498, metadata=Optional.empty)] for the first time for epoch 538 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:35:57,399] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=936, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=82499, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=936, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:34180-2-14', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@32dd0b6d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:35:57,399] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=927, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=82498, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=927, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:34172-1-14', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@566797dd]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:35:57,400] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:57,400] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:57,401] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:57,401] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:35:57,402] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=102, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=82498, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=102, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:50152-2-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7c3a9038]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:35:57,405] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:35:57,425] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:37:12,278] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,279] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=538, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1868, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,295] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=538, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=538, lastOffset=82557, preVote=true)])]) with epoch 538 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,296] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:37:12,296] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=538, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=538, lastOffset=82557, preVote=true)])]) with epoch 538 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,296] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 82557 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,297] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,297] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=538, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1673, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,298] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=538, voters=[1, 2, 3], electionTimeoutMs=1080, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=538, epochStartOffset=82497, highWatermark=Optional[LogOffsetMetadata(offset=82557, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903379)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82556, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903307)])], lastFetchTimestamp=1748529385019, lastCaughtUpTimestamp=1748529385019, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82557, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903379)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82557, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903379)])], lastFetchTimestamp=1748529385018, lastCaughtUpTimestamp=1748529385018, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,300] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=538, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=538, lastOffset=82557, preVote=true)])]) with epoch 538 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,300] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=538, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=538, lastOffset=82557, preVote=true)])]) with epoch 538 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,302] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=539, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], electionTimeoutMs=1589) from ProspectiveState(epoch=538, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1673, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,311] INFO [RaftManager id=1] Insufficient remaining votes to become candidate. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}).  (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,319] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=538, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), electionTimeoutMs=1868, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,339] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=539, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], electionTimeoutMs=1589) from ProspectiveState(epoch=538, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1673, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,341] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1037, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=538, voters=[1, 2, 3], electionTimeoutMs=1080, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,348] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from ProspectiveState(epoch=538, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), electionTimeoutMs=1868, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,350] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,377] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1037, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=538, voters=[1, 2, 3], electionTimeoutMs=1080, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,378] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1037, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,383] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=538, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,386] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1392, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,402] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1037, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,403] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=539, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=538, lastOffset=82557, preVote=false)])]) with epoch 539 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,405] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=539, epochStartOffset=82557, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=539, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], electionTimeoutMs=1589) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,416] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1392, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,416] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=539, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=538, lastOffset=82557, preVote=false)])]) with epoch 539 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:37:12,429] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=539, epochStartOffset=82557, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=539, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], electionTimeoutMs=1589) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,450] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=539, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,451] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=539, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1392, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,472] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=539, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1392, highWatermark=Optional[LogOffsetMetadata(offset=82556, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,480] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=539, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=539, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:37:12,506] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=82558, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903485)]) for the first time for epoch 539 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82558, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903485)])], lastFetchTimestamp=1748529432506, lastCaughtUpTimestamp=1748529432506, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82558, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903485)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82557, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2903379)])], lastFetchTimestamp=1748529432481, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:37:13,011] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=82558, metadata=Optional.empty)] for the first time for epoch 539 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:37:14,203] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=953, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=82559, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=953, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:36600-1-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@74a4d5e6]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:37:14,204] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:37:14,205] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:37:14,212] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=944, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=82560, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=944, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:36588-0-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b42f746]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:37:14,213] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:37:14,214] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:37:14,337] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=119, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=82559, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=119, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:36602-2-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@644cdded]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:37:14,338] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:37:14,340] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:04,712] INFO [RaftManager id=2] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,713] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,713] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 3911 due to node 3 being disconnected (elapsed time since creation: 44404ms, elapsed time since send: 44403ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,713] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:04,714] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=539, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1560, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=539, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,715] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=539, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=539, lastOffset=82856, preVote=true)])]) with epoch 539 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:04,716] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:04,717] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=539, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1563, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=539, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,718] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,719] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 410 due to node 3 being disconnected (elapsed time since creation: 44409ms, elapsed time since send: 44409ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,720] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=539, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=539, lastOffset=82856, preVote=true)])]) with epoch 539 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:04,741] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=540, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], electionTimeoutMs=1144) from ProspectiveState(epoch=539, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1563, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,772] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=540, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], electionTimeoutMs=1144) from ProspectiveState(epoch=539, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1563, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,774] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) from ProspectiveState(epoch=539, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1560, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,810] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) from ProspectiveState(epoch=539, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1560, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,810] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1925, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,847] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1606, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=539, epochStartOffset=82557, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], lastFetchTimestamp=1748529541162, lastCaughtUpTimestamp=1748529541162, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], lastFetchTimestamp=1748529541161, lastCaughtUpTimestamp=1748529541161, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,860] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1925, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,860] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=540, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=539, lastOffset=82856, preVote=false)])]) with epoch 540 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:04,863] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=540, epochStartOffset=82856, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=540, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], electionTimeoutMs=1144) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,979] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1606, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=539, epochStartOffset=82557, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], lastFetchTimestamp=1748529541162, lastCaughtUpTimestamp=1748529541162, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], lastFetchTimestamp=1748529541161, lastCaughtUpTimestamp=1748529541161, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,979] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1606, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:04,979] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(2060110684). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:39:04,980] INFO [QuorumController id=3] failAll(NotControllerException): failing maybeFenceStaleBroker(1286125978). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:39:04,980] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(2083801367). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:39:04,980] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(2142575127). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:39:04,981] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1401536150). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:39:04,981] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,981] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,981] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1524939028). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:39:04,982] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:04,993] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=540, epochStartOffset=82856, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=540, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], electionTimeoutMs=1144) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:05,056] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1606, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:05,057] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=540, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=539, lastOffset=82856, preVote=false)])]) with epoch 540 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:05,085] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,153] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=540, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1925, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:05,154] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=540, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:05,296] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=196, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=82855, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=196, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60108-2-0', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@20df2f63]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:39:05,326] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:05,327] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,378] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,418] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=540, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1925, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:05,434] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,463] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=199, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=82855, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=199, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60120-0-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6dd2fd3]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:39:05,469] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:05,470] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,500] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1030, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=82855, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1030, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60126-1-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4092fb08]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:39:05,511] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:05,512] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,520] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,534] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=540, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=540, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:05,563] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,583] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,595] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=202, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=82855, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=202, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60136-2-1', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@ce72c87]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:39:05,599] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:05,607] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,618] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1033, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=82855, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1033, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60150-0-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@ccd1b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:39:05,620] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:05,621] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,624] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1021, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=82855, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1021, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60156-1-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6974ad89]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:39:05,631] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:05,632] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,655] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=82857, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2925047)]) for the first time for epoch 540 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82857, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2925047)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82857, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2925047)])], lastFetchTimestamp=1748529545655, lastCaughtUpTimestamp=1748529545655, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82856, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2924941)])], lastFetchTimestamp=1748529545565, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:39:05,656] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,671] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:05,683] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:37,521] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:39:37,522] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 82914 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,524] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 82914 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,524] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,525] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=540, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1210, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=540, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,525] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,526] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=540, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1139, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=540, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,527] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=540, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=true)])]) with epoch 540 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,528] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=540, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=true)])]) with epoch 540 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,529] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=541, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1753) from ProspectiveState(epoch=540, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1210, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,530] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=541, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1933) from ProspectiveState(epoch=540, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1139, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,537] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=540, voters=[1, 2, 3], electionTimeoutMs=1737, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=540, epochStartOffset=82856, highWatermark=Optional[LogOffsetMetadata(offset=82914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929151)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929151)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929151)])], lastFetchTimestamp=1748529574309, lastCaughtUpTimestamp=1748529574309, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929151)])], lastFetchTimestamp=1748529574303, lastCaughtUpTimestamp=1748529574303, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,539] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=540, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=true)])]) with epoch 540 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,544] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=540, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=true)])]) with epoch 540 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,555] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=541, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1753) from ProspectiveState(epoch=540, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1210, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,555] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=541, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1933) from ProspectiveState(epoch=540, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1139, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,556] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=541, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=false)])]) with epoch 541 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,557] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=540, voters=[1, 2, 3], electionTimeoutMs=1737, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,557] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=541, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=false)])]) with epoch 541 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,577] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=540, voters=[1, 2, 3], electionTimeoutMs=1737, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,578] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(845539323). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:39:37,578] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1454, highWatermark=Optional.empty) from UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,622] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1454, highWatermark=Optional.empty) from UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,623] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=541, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=false)])]) with epoch 541 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,624] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=541, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=false)])]) with epoch 541 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,626] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,626] INFO [RaftManager id=2] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,627] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=541, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1113, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=541, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1933) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,628] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=541, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=true)])]) with epoch 541 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,628] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=541, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=true)])]) with epoch 541 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,630] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=541, epochStartOffset=82914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=541, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1753) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,632] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=542, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1375) from ProspectiveState(epoch=541, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1113, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,663] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=541, epochStartOffset=82914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=541, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1753) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,674] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=542, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1375) from ProspectiveState(epoch=541, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1113, highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,678] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) from UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1454, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,711] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) from UnattachedState(epoch=541, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1454, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,712] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1014, highWatermark=Optional.empty) from UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,719] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1943, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=541, epochStartOffset=82914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929257)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,732] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1014, highWatermark=Optional.empty) from UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1355, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,733] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=542, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=false)])]) with epoch 542 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,735] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=542, epochStartOffset=82914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=542, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1375) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,743] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1943, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=541, epochStartOffset=82914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929257)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,744] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=542, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=540, lastOffset=82914, preVote=false)])]) with epoch 542 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,761] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=542, epochStartOffset=82914, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=542, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82913, metadata=Optional.empty)], electionTimeoutMs=1375) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,798] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=542, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1943, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,798] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=542, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1014, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,819] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=542, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1943, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,819] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=542, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=542, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1014, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:39:37,821] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 82914 (kafka.log.UnifiedLog)
[2025-05-29 17:39:37,823] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 82914 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:39:37,823] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 82914 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:39:37,823] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=81599, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000081599.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:39:37,839] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 82914 with 0 producer ids in 15 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:39:37,839] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 0ms for snapshot load and 16ms for segment recovery from offset 82914 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:39:37,840] INFO [RaftManager id=3] Truncated to offset 82914 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:39:37,863] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=82915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929257)]) for the first time for epoch 542 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929257)])], lastFetchTimestamp=1748529577863, lastCaughtUpTimestamp=1748529577863, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82915, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929257)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82914, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2929151)])], lastFetchTimestamp=1748529577841, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:39:38,366] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=82915, metadata=Optional.empty)] for the first time for epoch 542 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:39:38,380] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=82915, metadata=Optional.empty)] for the first time for epoch 542 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:39:38,674] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=221, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=82914, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=221, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60158-2-2', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6922f77f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:39:38,675] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:38,676] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:38,680] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1052, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=82915, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1052, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60160-0-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@20d745d3]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:39:38,684] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:38,689] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:39:38,690] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1040, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=82914, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1040, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:60170-1-3', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@57e0abcf]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:39:38,692] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:39:38,696] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:40:52,448] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:40:52,449] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 82973 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,449] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 82973 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,450] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,453] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=542, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1740, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=542, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,453] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=542, voters=[1, 2, 3], electionTimeoutMs=1122, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=542, epochStartOffset=82914, highWatermark=Optional[LogOffsetMetadata(offset=82973, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933433)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82973, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933433)])], lastFetchTimestamp=1748529606974, lastCaughtUpTimestamp=1748529606974, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82973, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933433)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82973, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933433)])], lastFetchTimestamp=1748529606968, lastCaughtUpTimestamp=1748529606968, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,457] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=542, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=true)])]) with epoch 542 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,458] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,458] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=542, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1003, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=542, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,461] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=542, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=true)])]) with epoch 542 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,464] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=543, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1758) from ProspectiveState(epoch=542, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1740, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,469] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=542, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=true)])]) with epoch 542 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,473] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=543, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1475) from ProspectiveState(epoch=542, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1003, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,503] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=543, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1758) from ProspectiveState(epoch=542, leaderId=OptionalInt[2], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1740, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,505] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=542, voters=[1, 2, 3], electionTimeoutMs=1122, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,514] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=543, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1475) from ProspectiveState(epoch=542, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1003, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,515] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=543, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=false)])]) with epoch 543 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,516] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=543, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=false)])]) with epoch 543 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,529] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=542, voters=[1, 2, 3], electionTimeoutMs=1122, unackedVoters=[3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,530] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1525, highWatermark=Optional.empty) from UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,531] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1206438838). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:40:52,549] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1525, highWatermark=Optional.empty) from UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,550] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=543, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=false)])]) with epoch 543 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,551] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=543, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=false)])]) with epoch 543 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,552] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=543, epochStartOffset=82973, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=543, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1758) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,553] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,554] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,554] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=543, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1495, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=543, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1475) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,558] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=543, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=true)])]) with epoch 543 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,565] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=544, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1004) from ProspectiveState(epoch=543, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1495, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,594] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=543, epochStartOffset=82973, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=543, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1758) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,616] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=544, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1004) from ProspectiveState(epoch=543, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1495, highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,634] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1421, highWatermark=Optional.empty) from UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1525, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,709] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1421, highWatermark=Optional.empty) from UnattachedState(epoch=543, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1525, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,710] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1878, highWatermark=Optional.empty) from UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1421, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,720] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=543, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=true)])]) with epoch 543 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,722] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1240, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=543, epochStartOffset=82973, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82974, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933539)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,735] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1878, highWatermark=Optional.empty) from UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1421, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,735] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=544, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=false)])]) with epoch 544 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,737] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=544, epochStartOffset=82973, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=544, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1004) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,763] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1240, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=543, epochStartOffset=82973, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82974, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933539)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,763] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=544, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=542, lastOffset=82973, preVote=false)])]) with epoch 544 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,773] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=544, epochStartOffset=82973, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=544, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=82972, metadata=Optional.empty)], electionTimeoutMs=1004) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,796] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=544, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1240, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,796] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=544, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1878, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,808] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=544, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1240, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,810] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=544, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=544, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1878, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:40:52,816] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Truncating to offset 82973 (kafka.log.UnifiedLog)
[2025-05-29 17:40:52,817] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Loading producer state till offset 82973 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:40:52,817] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 82973 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:40:52,817] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=82914, file=/home/ammar/kafka_data/broker3_4.0.0/__cluster_metadata-0/00000000000000082914.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:40:52,835] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 82973 with 0 producer ids in 17 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:40:52,835] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker3_4.0.0] Producer state recovery took 1ms for snapshot load and 17ms for segment recovery from offset 82973 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:40:52,835] INFO [RaftManager id=3] Truncated to offset 82973 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:40:52,860] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=82974, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933539)]) for the first time for epoch 544 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82974, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933539)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82974, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933539)])], lastFetchTimestamp=1748529652859, lastCaughtUpTimestamp=1748529652859, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=82973, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2933433)])], lastFetchTimestamp=1748529652836, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:40:53,362] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=82974, metadata=Optional.empty)] for the first time for epoch 544 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:40:53,380] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=82974, metadata=Optional.empty)] for the first time for epoch 544 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:40:53,807] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1069, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=82973, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1069, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:45682-2-16', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@47bd02e5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:40:53,808] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:40:53,809] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:40:53,826] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=238, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=82974, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=238, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:45666-1-16', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@737f5e91]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:40:53,827] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:40:53,828] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:40:53,844] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1057, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=82973, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1057, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:45684-0-17', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@304e1bbb]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:40:53,845] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:40:53,846] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:42:13,661] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:13,662] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=544, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1001, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=544, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,663] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:13,663] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 4296 due to node 1 being disconnected (elapsed time since creation: 3203ms, elapsed time since send: 3203ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:13,663] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:13,664] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=544, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1861, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=544, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,664] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=544, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=544, lastOffset=83212, preVote=true)])]) with epoch 544 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:13,665] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:13,666] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 4154 due to node 1 being disconnected (elapsed time since creation: 3207ms, elapsed time since send: 3207ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:13,666] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=545, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], electionTimeoutMs=1985) from ProspectiveState(epoch=544, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1001, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,682] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:42:13,683] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 83212 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:13,685] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 83212 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:13,687] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=544, voters=[1, 2, 3], electionTimeoutMs=1708, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=544, epochStartOffset=82973, highWatermark=Optional[LogOffsetMetadata(offset=83212, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950675)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83212, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950675)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83212, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950675)])], lastFetchTimestamp=1748529730460, lastCaughtUpTimestamp=1748529730460, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83212, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950675)])], lastFetchTimestamp=1748529730460, lastCaughtUpTimestamp=1748529730460, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,710] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=545, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], electionTimeoutMs=1985) from ProspectiveState(epoch=544, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1001, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,711] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1813, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) from ProspectiveState(epoch=544, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1861, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,711] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=544, voters=[1, 2, 3], electionTimeoutMs=1708, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,744] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=544, voters=[1, 2, 3], electionTimeoutMs=1708, unackedVoters=[2], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,744] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1590906770). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:42:13,764] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1156, highWatermark=Optional.empty) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,785] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1813, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) from ProspectiveState(epoch=544, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1861, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,786] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1813, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,800] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1156, highWatermark=Optional.empty) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1683, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,800] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=545, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=544, lastOffset=83212, preVote=false)])]) with epoch 545 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:13,802] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=545, epochStartOffset=83212, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=545, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], electionTimeoutMs=1985) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,808] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1813, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,809] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=545, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=544, lastOffset=83212, preVote=false)])]) with epoch 545 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:13,837] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=545, epochStartOffset=83212, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=545, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], electionTimeoutMs=1985) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,899] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=545, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,902] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=545, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1156, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:13,999] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=545, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=83211, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:14,027] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=545, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=545, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1156, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:14,192] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=83213, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950781)]) for the first time for epoch 545 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83213, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950781)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83213, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950781)])], lastFetchTimestamp=1748529734192, lastCaughtUpTimestamp=1748529734192, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83212, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2950675)])], lastFetchTimestamp=1748529734035, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:42:14,731] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=83213, metadata=Optional.empty)] for the first time for epoch 545 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:42:15,434] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1131, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83214, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1131, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:39530-0-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3494164d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:42:15,435] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:15,436] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:42:15,519] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1119, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83213, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1119, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:39556-2-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5e0b1582]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:42:15,520] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:15,521] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:42:15,547] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=300, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83213, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=300, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:39542-1-4', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@12a6e417]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:42:15,548] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:15,549] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:42:46,452] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:42:46,452] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 83271 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:46,452] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 83271 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:46,453] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=545, voters=[1, 2, 3], electionTimeoutMs=1613, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=545, epochStartOffset=83212, highWatermark=Optional[LogOffsetMetadata(offset=83271, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2954957)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83271, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2954957)])], lastFetchTimestamp=1748529763267, lastCaughtUpTimestamp=1748529763267, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83271, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2954957)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83271, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2954957)])], lastFetchTimestamp=1748529763266, lastCaughtUpTimestamp=1748529763266, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,455] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:46,462] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=545, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1746, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=545, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,465] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=545, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=545, lastOffset=83271, preVote=true)])]) with epoch 545 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:46,466] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=545, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=545, lastOffset=83271, preVote=true)])]) with epoch 545 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:46,467] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=546, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], electionTimeoutMs=1643) from ProspectiveState(epoch=545, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1746, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,554] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=546, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], electionTimeoutMs=1643) from ProspectiveState(epoch=545, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1746, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,561] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1517, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=545, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,557] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1509, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=545, voters=[1, 2, 3], electionTimeoutMs=1613, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,653] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1517, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=545, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,654] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1884, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1517, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,675] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1509, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=545, voters=[1, 2, 3], electionTimeoutMs=1613, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,677] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1314, highWatermark=Optional.empty) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1509, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,678] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1768434169). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:42:46,770] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1884, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1517, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,770] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=546, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=545, lastOffset=83271, preVote=false)])]) with epoch 546 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:46,773] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=546, epochStartOffset=83271, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=546, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], electionTimeoutMs=1643) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,790] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1314, highWatermark=Optional.empty) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1509, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,798] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=546, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=545, lastOffset=83271, preVote=false)])]) with epoch 546 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:42:46,844] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=546, epochStartOffset=83271, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=546, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], electionTimeoutMs=1643) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,941] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=546, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1884, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:46,943] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=546, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1314, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:47,018] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=546, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1884, highWatermark=Optional[LogOffsetMetadata(offset=83270, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:47,037] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=546, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=546, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1314, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:42:47,251] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=83272, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2955063)]) for the first time for epoch 546 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83272, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2955063)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83272, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2955063)])], lastFetchTimestamp=1748529767251, lastCaughtUpTimestamp=1748529767251, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83271, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2954957)])], lastFetchTimestamp=1748529766940, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:42:47,772] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=83272, metadata=Optional.empty)] for the first time for epoch 546 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:42:48,231] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1148, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83271, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1148, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:42664-1-17', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@656be657]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:42:48,231] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:48,232] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:42:48,322] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1136, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83272, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1136, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:42680-2-17', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6a1ac36e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:42:48,324] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:48,325] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:42:48,377] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=317, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83273, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=317, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:42682-0-18', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7b7554cf]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:42:48,378] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:42:48,390] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:43:17,335] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:43:17,335] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:43:17,336] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 4427 due to node 1 being disconnected (elapsed time since creation: 44454ms, elapsed time since send: 44454ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:43:17,336] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 4302 due to node 1 being disconnected (elapsed time since creation: 44456ms, elapsed time since send: 44456ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:43:17,412] INFO [RaftManager id=2] Hostname for node 1 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:43:17,418] INFO [RaftManager id=3] Hostname for node 1 changed from localhost to DESKTOP-T3O0CHU.localdomain. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:44:21,158] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,159] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=546, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1343, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=546, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,159] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:44:21,159] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 83450 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,160] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 83450 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,160] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:44:21,160] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 4439 due to node 1 being disconnected (elapsed time since creation: 44451ms, elapsed time since send: 44451ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:44:21,160] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,161] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=546, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1391, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=546, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,161] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=546, voters=[1, 2, 3], electionTimeoutMs=1717, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=546, epochStartOffset=83271, highWatermark=Optional[LogOffsetMetadata(offset=83450, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967879)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83450, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967879)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83450, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967879)])], lastFetchTimestamp=1748529857572, lastCaughtUpTimestamp=1748529857572, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83450, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967879)])], lastFetchTimestamp=1748529857572, lastCaughtUpTimestamp=1748529857572, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,162] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=546, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=true)])]) with epoch 546 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,163] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=546, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=true)])]) with epoch 546 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,163] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=546, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=true)])]) with epoch 546 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,164] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=547, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1184) from ProspectiveState(epoch=546, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1343, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,164] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=547, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1232) from ProspectiveState(epoch=546, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1391, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,215] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=547, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1232) from ProspectiveState(epoch=546, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1391, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,217] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1660, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=546, voters=[1, 2, 3], electionTimeoutMs=1717, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,251] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=547, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1184) from ProspectiveState(epoch=546, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1343, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,253] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=547, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=false)])]) with epoch 547 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,253] INFO [RaftManager id=3] Hostname for node 1 changed from DESKTOP-T3O0CHU.localdomain to localhost. (org.apache.kafka.clients.ClusterConnectionStates)
[2025-05-29 17:44:21,267] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=547, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=false)])]) with epoch 547 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,281] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1660, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=546, voters=[1, 2, 3], electionTimeoutMs=1717, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,281] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1317, highWatermark=Optional.empty) from UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1660, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,297] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1317, highWatermark=Optional.empty) from UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1660, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,297] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=547, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=false)])]) with epoch 547 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,298] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=547, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=false)])]) with epoch 547 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,299] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,299] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,299] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=547, epochStartOffset=83450, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=547, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1232) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,299] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=547, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1461, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=547, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1184) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,301] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=547, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=true)])]) with epoch 547 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,302] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=548, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1259) from ProspectiveState(epoch=547, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1461, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,320] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=548, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1259) from ProspectiveState(epoch=547, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1461, highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,320] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=547, epochStartOffset=83450, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=547, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1232) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,322] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1276, highWatermark=Optional.empty) from UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1317, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,350] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1276, highWatermark=Optional.empty) from UnattachedState(epoch=547, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1317, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,350] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) from UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1276, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,355] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=547, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=true)])]) with epoch 547 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,357] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1375, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=547, epochStartOffset=83450, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83450, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967879)])], lastFetchTimestamp=1748529861355, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83451, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967985)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,371] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) from UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1276, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,371] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=548, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=false)])]) with epoch 548 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,375] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=548, epochStartOffset=83450, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=548, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1259) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,379] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1375, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=547, epochStartOffset=83450, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83450, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967879)])], lastFetchTimestamp=1748529861355, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83451, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967985)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,383] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=548, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=546, lastOffset=83450, preVote=false)])]) with epoch 548 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,453] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=548, epochStartOffset=83450, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=548, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83449, metadata=Optional.empty)], electionTimeoutMs=1259) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,538] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=548, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1375, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,538] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=548, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,590] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=548, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1375, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,590] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=548, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=548, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1287, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:44:21,591] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 83450 (kafka.log.UnifiedLog)
[2025-05-29 17:44:21,592] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 83450 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:44:21,593] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 83450 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:44:21,593] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=80950, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000080950.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:44:21,642] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 83450 with 0 producer ids in 48 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:44:21,643] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 50ms for segment recovery from offset 83450 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:44:21,643] INFO [RaftManager id=2] Truncated to offset 83450 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:44:21,727] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=83451, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967985)]) for the first time for epoch 548 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83451, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967985)])], lastFetchTimestamp=1748529861726, lastCaughtUpTimestamp=1748529861726, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83451, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967985)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83450, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2967879)])], lastFetchTimestamp=1748529861644, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:44:22,228] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=83451, metadata=Optional.empty)] for the first time for epoch 548 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:44:22,284] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=83451, metadata=Optional.empty)] for the first time for epoch 548 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:44:22,853] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1183, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83452, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1183, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:40206-0-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@38490b5e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:44:22,853] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1195, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83451, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1195, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:40194-2-5', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@15bf8e2d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:44:22,854] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:44:22,854] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:44:22,855] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:44:22,855] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:44:22,873] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=364, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83451, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=364, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:40210-1-6', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@32ddb2e3]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:44:22,878] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:44:22,879] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,283] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:45:24,283] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 83568 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,284] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 83568 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,284] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,285] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,285] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=548, voters=[1, 2, 3], electionTimeoutMs=1353, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=548, epochStartOffset=83450, highWatermark=Optional[LogOffsetMetadata(offset=83568, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976409)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83568, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976409)])], lastFetchTimestamp=1748529921061, lastCaughtUpTimestamp=1748529921061, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83568, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976409)])], lastFetchTimestamp=1748529921061, lastCaughtUpTimestamp=1748529921061, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83568, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976409)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,285] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=548, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1565, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=548, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,285] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=548, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1418, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=548, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,286] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=548, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=true)])]) with epoch 548 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,286] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=548, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=true)])]) with epoch 548 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,287] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=548, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=true)])]) with epoch 548 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,287] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=548, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=true)])]) with epoch 548 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,288] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=549, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1671) from ProspectiveState(epoch=548, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1565, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,288] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=549, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) from ProspectiveState(epoch=548, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1418, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,330] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=549, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) from ProspectiveState(epoch=548, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1418, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,332] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1305, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=548, voters=[1, 2, 3], electionTimeoutMs=1353, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,340] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=549, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1671) from ProspectiveState(epoch=548, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1565, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,340] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=549, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=false)])]) with epoch 549 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,341] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=549, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=false)])]) with epoch 549 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,359] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1305, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=548, voters=[1, 2, 3], electionTimeoutMs=1353, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,359] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1809, highWatermark=Optional.empty) from UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1305, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,391] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1809, highWatermark=Optional.empty) from UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1305, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,392] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=549, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=false)])]) with epoch 549 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,392] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=549, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=false)])]) with epoch 549 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,393] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,393] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=549, epochStartOffset=83568, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=549, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,394] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,394] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=549, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1979, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=549, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1671) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,396] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=549, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=true)])]) with epoch 549 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,398] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=550, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) from ProspectiveState(epoch=549, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1979, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,418] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=549, epochStartOffset=83568, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=549, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,439] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=550, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) from ProspectiveState(epoch=549, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1979, highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,441] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1727, highWatermark=Optional.empty) from UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1809, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,470] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1214, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83567, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1214, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38578-1-18', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@363ae556]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:45:24,470] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1226, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1226, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38584-2-18', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2ac80fc7]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:45:24,471] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,471] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,472] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,487] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1227, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1227, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:37174-1-18', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3f342c0c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:24,488] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,490] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,491] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1727, highWatermark=Optional.empty) from UnattachedState(epoch=549, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1809, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,506] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1488, highWatermark=Optional.empty) from UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1727, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,521] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=395, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=395, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:38598-0-19', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4362c7d5]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: No controller appears to be active.
[2025-05-29 17:45:24,522] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,526] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=549, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=true)])]) with epoch 549 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,527] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=549, epochStartOffset=83568, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83569, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976515)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83568, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976409)])], lastFetchTimestamp=1748529924526, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,540] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,567] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1230, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1230, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:37188-2-18', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4fd4960e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:24,568] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,568] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,618] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,641] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1233, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1233, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:37204-0-19', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6a437f4d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:24,642] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,649] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,693] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,723] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1236, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1236, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:37210-1-19', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@53a0146b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:24,724] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,724] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,727] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1488, highWatermark=Optional.empty) from UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1727, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,742] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=550, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=false)])]) with epoch 550 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:24,744] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=550, epochStartOffset=83568, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=550, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,774] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,795] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1239, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1239, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:37224-2-19', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4612db2f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:24,796] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:24,797] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:24,836] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=549, epochStartOffset=83568, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83569, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976515)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83568, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976409)])], lastFetchTimestamp=1748529924526, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:24,844] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=550, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=548, lastOffset=83568, preVote=false)])]) with epoch 550 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:25,069] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=550, epochStartOffset=83568, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=550, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83567, metadata=Optional.empty)], electionTimeoutMs=1307) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:25,125] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,156] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=396, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=396, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42744-2-7', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@408c2265]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,156] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,157] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,208] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,266] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=399, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=399, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42754-0-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4511191]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,266] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,267] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,312] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=550, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:25,312] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=550, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1488, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:25,318] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,358] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=402, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=402, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42768-1-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@52dcbf65]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,359] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,360] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,411] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,451] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=405, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=405, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42772-2-8', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@54be6247]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,454] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,455] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,506] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,525] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=550, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1488, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:25,521] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=550, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=550, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:25,538] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 83568 (kafka.log.UnifiedLog)
[2025-05-29 17:45:25,539] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 83568 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:45:25,539] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 83568 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:45:25,539] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=83450, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000083450.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:45:25,552] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,574] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,576] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=408, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=408, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42780-0-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@ac3c2a4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,577] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,578] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,602] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1242, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1242, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42796-1-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@522ca6b0]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,602] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,608] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,624] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 83568 with 0 producer ids in 85 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:45:25,627] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,627] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 88ms for segment recovery from offset 83568 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:45:25,627] INFO [RaftManager id=2] Truncated to offset 83568 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:25,634] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1215, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83567, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1215, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42800-2-9', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@2b18f1fa]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,635] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,636] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,657] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=411, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=411, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42804-0-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@176da05]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,658] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,661] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,662] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,684] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1245, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1245, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42818-1-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3c07d7a6]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,687] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,687] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,688] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,708] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1218, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83567, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1218, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42830-2-10', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6e1eecd]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,709] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,709] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,711] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,735] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=414, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=414, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42840-0-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@492b59dd]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,736] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,737] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,738] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,759] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,762] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1248, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1248, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42844-1-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@da78e23]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,763] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,772] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,789] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,793] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1221, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83567, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1221, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42858-2-11', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@b9760d4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,794] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,794] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,808] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=417, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83566, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=417, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42870-0-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@216a180c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:45:25,810] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:25,811] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,818] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=83569, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976515)]) for the first time for epoch 550 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83569, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976515)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83569, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976515)])], lastFetchTimestamp=1748529925817, lastCaughtUpTimestamp=1748529925817, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83568, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2976409)])], lastFetchTimestamp=1748529925628, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:45:25,825] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,844] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:25,861] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:26,320] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=83569, metadata=Optional.empty)] for the first time for epoch 550 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:45:26,608] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=83569, metadata=Optional.empty)] for the first time for epoch 550 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:45:56,976] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:45:56,976] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 83625 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,976] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 83625 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,977] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,977] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,978] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=550, voters=[1, 2, 3], electionTimeoutMs=1062, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=550, epochStartOffset=83568, highWatermark=Optional[LogOffsetMetadata(offset=83625, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980547)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83625, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980547)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83625, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980547)])], lastFetchTimestamp=1748529953865, lastCaughtUpTimestamp=1748529953865, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83625, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980547)])], lastFetchTimestamp=1748529953865, lastCaughtUpTimestamp=1748529953865, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:56,978] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=550, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1479, highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=550, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:56,978] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=550, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1832, highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=550, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:56,979] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=550, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=true)])]) with epoch 550 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,980] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=550, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=true)])]) with epoch 550 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,980] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=550, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=true)])]) with epoch 550 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,980] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=550, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=true)])]) with epoch 550 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:56,981] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1518) from ProspectiveState(epoch=550, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1479, highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:56,981] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1494) from ProspectiveState(epoch=550, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1832, highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,004] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1494) from ProspectiveState(epoch=550, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1832, highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,004] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1518) from ProspectiveState(epoch=550, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1479, highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,006] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=551, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=false)])]) with epoch 551 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:57,006] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=551, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=false)])]) with epoch 551 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:57,006] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1034, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=550, voters=[1, 2, 3], electionTimeoutMs=1062, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,019] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1034, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=550, voters=[1, 2, 3], electionTimeoutMs=1062, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,020] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1967923698). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:45:57,020] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1708, highWatermark=Optional.empty) from UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1034, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,031] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1708, highWatermark=Optional.empty) from UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1034, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,031] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=551, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=false)])]) with epoch 551 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:57,032] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=551, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=550, lastOffset=83625, preVote=false)])]) with epoch 551 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:57,033] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:45:57,033] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=551, epochStartOffset=83625, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1518) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,045] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=551, epochStartOffset=83625, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1518) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,071] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=551, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1494) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,071] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=551, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1708, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,088] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=551, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=551, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83624, metadata=Optional.empty)], electionTimeoutMs=1494) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,088] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=551, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=551, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1708, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:45:57,124] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=83626, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980653)]) for the first time for epoch 551 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83626, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980653)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83626, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980653)])], lastFetchTimestamp=1748529957124, lastCaughtUpTimestamp=1748529957124, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83625, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2980547)])], lastFetchTimestamp=1748529957090, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:45:57,629] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=83626, metadata=Optional.empty)] for the first time for epoch 551 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:45:58,655] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1267, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83627, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1267, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42872-1-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7acefeee]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:58,655] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1240, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83626, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1240, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42878-2-12', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@244a43fd]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:58,655] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:58,656] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=436, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83626, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=436, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42882-0-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5fee5b7a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:45:58,656] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:58,656] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:45:58,656] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:58,657] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:45:58,657] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:46:13,754] INFO [NodeToControllerChannelManager id=1 name=registration] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:46:17,364] INFO [NodeToControllerChannelManager id=3 name=alter-partition] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:12,103] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:47:12,103] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 83685 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,104] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 83685 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,104] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,105] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=551, voters=[1, 2, 3], electionTimeoutMs=1782, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=551, epochStartOffset=83625, highWatermark=Optional[LogOffsetMetadata(offset=83685, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2984901)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83685, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2984901)])], lastFetchTimestamp=1748529986678, lastCaughtUpTimestamp=1748529986678, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83685, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2984901)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83685, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2984901)])], lastFetchTimestamp=1748529986677, lastCaughtUpTimestamp=1748529986677, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,105] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,105] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=551, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1205, highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=551, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,106] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=551, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1566, highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=551, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,107] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=551, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=551, lastOffset=83685, preVote=true)])]) with epoch 551 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,108] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=551, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=551, lastOffset=83685, preVote=true)])]) with epoch 551 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,109] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=551, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=551, lastOffset=83685, preVote=true)])]) with epoch 551 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,109] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1646) from ProspectiveState(epoch=551, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1205, highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,111] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1700) from ProspectiveState(epoch=551, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1566, highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,128] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1646) from ProspectiveState(epoch=551, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1205, highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,130] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=551, voters=[1, 2, 3], electionTimeoutMs=1782, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,134] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1700) from ProspectiveState(epoch=551, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1566, highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,135] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=551, lastOffset=83685, preVote=false)])]) with epoch 552 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,135] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=551, lastOffset=83685, preVote=false)])]) with epoch 552 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,144] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=551, voters=[1, 2, 3], electionTimeoutMs=1782, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,144] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1995, highWatermark=Optional.empty) from UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,156] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1995, highWatermark=Optional.empty) from UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,156] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=551, lastOffset=83685, preVote=false)])]) with epoch 552 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,157] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=551, lastOffset=83685, preVote=false)])]) with epoch 552 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,158] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=552, epochStartOffset=83685, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1646) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,161] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:47:12,174] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=552, epochStartOffset=83685, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1646) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,190] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=552, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1995, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,191] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=552, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1700) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,207] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=552, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=552, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1995, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,212] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=552, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=552, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83684, metadata=Optional.empty)], electionTimeoutMs=1700) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:47:12,240] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=83686, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2985007)]) for the first time for epoch 552 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83686, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2985007)])], lastFetchTimestamp=1748530032239, lastCaughtUpTimestamp=1748530032239, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83686, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2985007)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83685, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2984901)])], lastFetchTimestamp=1748530032213, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:47:12,741] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=83686, metadata=Optional.empty)] for the first time for epoch 552 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:47:13,763] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1257, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83687, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1257, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:57644-2-20', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@259b637c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:47:13,763] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1284, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83686, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1284, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:57636-0-20', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@773c874c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:47:13,763] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=453, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83686, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=453, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:57638-1-20', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@75e4c3c3]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:47:13,763] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:13,763] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:13,764] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:13,764] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:13,764] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:13,765] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:02,954] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:02,954] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1300 due to node 3 being disconnected (elapsed time since creation: 48589ms, elapsed time since send: 48589ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:02,954] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:02,956] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:02,957] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 469 due to node 3 being disconnected (elapsed time since creation: 48590ms, elapsed time since send: 48590ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:02,957] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:02,957] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:02,958] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1273 due to node 3 being disconnected (elapsed time since creation: 48593ms, elapsed time since send: 48593ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:02,958] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:02,958] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:02,959] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:02,959] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:07,584] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:07,584] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1301 due to node 3 being disconnected (elapsed time since creation: 4524ms, elapsed time since send: 4505ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:07,584] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:07,584] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:07,592] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:07,592] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1274 due to node 3 being disconnected (elapsed time since creation: 4532ms, elapsed time since send: 4505ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:07,592] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:07,592] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:07,596] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:07,596] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 470 due to node 3 being disconnected (elapsed time since creation: 4535ms, elapsed time since send: 4502ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:07,597] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:07,598] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:12,307] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:12,307] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1303 due to node 3 being disconnected (elapsed time since creation: 4521ms, elapsed time since send: 4505ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:12,307] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:12,307] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:12,322] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:12,323] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1276 due to node 3 being disconnected (elapsed time since creation: 4528ms, elapsed time since send: 4504ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:12,323] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:12,323] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:16,832] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:16,833] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 472 due to node 3 being disconnected (elapsed time since creation: 9033ms, elapsed time since send: 9005ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:16,833] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:16,833] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:17,230] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:17,231] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1305 due to node 3 being disconnected (elapsed time since creation: 4518ms, elapsed time since send: 4503ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:17,231] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:17,231] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:17,238] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:17,239] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1278 due to node 3 being disconnected (elapsed time since creation: 4517ms, elapsed time since send: 4501ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:17,239] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:17,239] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:21,749] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:21,750] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 474 due to node 3 being disconnected (elapsed time since creation: 4520ms, elapsed time since send: 4505ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:21,750] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:21,750] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:22,558] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:22,558] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:22,559] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1307 due to node 3 being disconnected (elapsed time since creation: 4518ms, elapsed time since send: 4505ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:22,559] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1280 due to node 3 being disconnected (elapsed time since creation: 4515ms, elapsed time since send: 4503ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:22,559] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:22,559] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:22,559] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:22,559] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:27,089] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:27,090] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 476 due to node 3 being disconnected (elapsed time since creation: 4528ms, elapsed time since send: 4510ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:27,090] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:27,090] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:29,194] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:29,194] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1309 due to node 3 being disconnected (elapsed time since creation: 5029ms, elapsed time since send: 5016ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:29,195] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:29,195] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:29,207] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:29,207] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1282 due to node 3 being disconnected (elapsed time since creation: 5024ms, elapsed time since send: 5015ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:29,207] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:29,208] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:33,721] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:33,722] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 478 due to node 3 being disconnected (elapsed time since creation: 4516ms, elapsed time since send: 4504ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:33,722] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:33,722] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:36,881] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:36,882] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1311 due to node 3 being disconnected (elapsed time since creation: 4516ms, elapsed time since send: 4505ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:36,882] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:36,882] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:36,911] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:36,911] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 1284 due to node 3 being disconnected (elapsed time since creation: 4513ms, elapsed time since send: 4503ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:36,912] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:36,912] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:47:41,444] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:41,444] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 480 due to node 3 being disconnected (elapsed time since creation: 4516ms, elapsed time since send: 4503ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:47:41,444] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:47:41,444] INFO [BrokerLifecycleManager id=1] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-05-29 17:48:02,188] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:48:02,188] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 83865 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,189] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 83865 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,189] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,189] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,189] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=552, voters=[1, 2, 3], electionTimeoutMs=1468, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=552, epochStartOffset=83685, highWatermark=Optional[LogOffsetMetadata(offset=83865, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992732)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83865, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992732)])], lastFetchTimestamp=1748530078458, lastCaughtUpTimestamp=1748530078458, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83865, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992732)])], lastFetchTimestamp=1748530078458, lastCaughtUpTimestamp=1748530078458, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83865, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992732)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,190] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=552, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1807, highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=552, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,190] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=552, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1533, highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=552, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,191] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=true)])]) with epoch 552 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,191] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=true)])]) with epoch 552 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,192] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=true)])]) with epoch 552 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,192] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=552, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=true)])]) with epoch 552 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,193] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1998) from ProspectiveState(epoch=552, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1807, highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,193] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1411) from ProspectiveState(epoch=552, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1533, highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,207] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1998) from ProspectiveState(epoch=552, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1807, highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,207] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1411) from ProspectiveState(epoch=552, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1533, highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,209] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=false)])]) with epoch 553 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,209] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1449, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=552, voters=[1, 2, 3], electionTimeoutMs=1468, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,210] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=false)])]) with epoch 553 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,224] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1449, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=552, voters=[1, 2, 3], electionTimeoutMs=1468, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,224] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(296370481). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:48:02,224] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1948, highWatermark=Optional.empty) from UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1449, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,239] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1948, highWatermark=Optional.empty) from UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1449, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,239] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=false)])]) with epoch 553 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,240] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=552, lastOffset=83865, preVote=false)])]) with epoch 553 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,242] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:02,245] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=553, epochStartOffset=83865, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1411) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,259] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=553, epochStartOffset=83865, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1411) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,286] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=553, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1948, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,286] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=553, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1998) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,300] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=553, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=553, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1948, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,300] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=553, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=553, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83864, metadata=Optional.empty)], electionTimeoutMs=1998) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:02,335] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=83866, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992838)]) for the first time for epoch 553 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83866, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992838)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83866, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992838)])], lastFetchTimestamp=1748530082334, lastCaughtUpTimestamp=1748530082334, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83865, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2992732)])], lastFetchTimestamp=1748530082304, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:48:02,738] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1296, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83864, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1296, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:39678-1-26', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@72254163]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:48:02,738] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1323, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83863, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1323, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:39686-2-26', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@26489aba]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:48:02,738] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=490, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83865, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=490, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:32924-0-27', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@42e1647d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:48:02,738] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:48:02,739] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:48:02,739] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:48:02,739] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:48:02,740] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:48:02,740] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:48:02,837] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=83866, metadata=Optional.empty)] for the first time for epoch 553 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:48:34,605] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:48:34,605] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 83924 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,606] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 83924 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,606] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,607] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,607] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=553, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1321, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=553, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,607] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=553, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1213, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=553, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,609] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=true)])]) with epoch 553 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,609] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=553, voters=[1, 2, 3], electionTimeoutMs=1450, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=553, epochStartOffset=83865, highWatermark=Optional[LogOffsetMetadata(offset=83924, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997014)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83924, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997014)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83924, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997014)])], lastFetchTimestamp=1748530111384, lastCaughtUpTimestamp=1748530111384, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83924, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997014)])], lastFetchTimestamp=1748530111380, lastCaughtUpTimestamp=1748530111380, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,609] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=true)])]) with epoch 553 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,609] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=true)])]) with epoch 553 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,610] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=554, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1820) from ProspectiveState(epoch=553, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1321, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,610] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=554, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1455) from ProspectiveState(epoch=553, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1213, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,611] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=553, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=true)])]) with epoch 553 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,625] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=554, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1820) from ProspectiveState(epoch=553, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1321, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,625] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=554, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1455) from ProspectiveState(epoch=553, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1213, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,627] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=554, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=false)])]) with epoch 554 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,627] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=554, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=false)])]) with epoch 554 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,627] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1430, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=553, voters=[1, 2, 3], electionTimeoutMs=1450, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,639] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1430, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=553, voters=[1, 2, 3], electionTimeoutMs=1450, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,640] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1666801363). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:48:34,640] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) from UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1430, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,656] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) from UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1430, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,656] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=554, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=false)])]) with epoch 554 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,657] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=554, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=false)])]) with epoch 554 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,658] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,658] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=554, epochStartOffset=83924, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=554, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1455) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,658] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,658] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=554, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1733, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=554, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1820) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,660] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=554, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=true)])]) with epoch 554 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,662] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=555, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1070) from ProspectiveState(epoch=554, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1733, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,678] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=554, epochStartOffset=83924, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=554, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1455) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,684] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=555, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1070) from ProspectiveState(epoch=554, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1733, highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,686] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1103, highWatermark=Optional.empty) from UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,704] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1103, highWatermark=Optional.empty) from UnattachedState(epoch=554, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1149, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,705] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1958, highWatermark=Optional.empty) from UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1103, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,712] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=554, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=true)])]) with epoch 554 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,714] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1259, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=554, epochStartOffset=83924, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83924, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997014)])], lastFetchTimestamp=1748530114711, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83925, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997120)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,727] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1958, highWatermark=Optional.empty) from UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1103, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,728] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=555, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=false)])]) with epoch 555 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,730] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=555, epochStartOffset=83924, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=555, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1070) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,736] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1259, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=554, epochStartOffset=83924, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83924, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997014)])], lastFetchTimestamp=1748530114711, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83925, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997120)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,737] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=555, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=553, lastOffset=83924, preVote=false)])]) with epoch 555 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,748] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=555, epochStartOffset=83924, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=555, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83923, metadata=Optional.empty)], electionTimeoutMs=1070) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,764] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=555, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1259, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,765] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=555, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1958, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,778] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=555, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1259, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,780] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 83924 (kafka.log.UnifiedLog)
[2025-05-29 17:48:34,781] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 83924 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:48:34,781] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 83924 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:48:34,782] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=83568, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000083568.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:48:34,783] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=555, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=555, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1958, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:48:34,786] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 83924 with 0 producer ids in 4 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:48:34,786] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 4ms for segment recovery from offset 83924 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:48:34,786] INFO [RaftManager id=2] Truncated to offset 83924 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:48:34,811] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=83925, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997120)]) for the first time for epoch 555 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83925, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997120)])], lastFetchTimestamp=1748530114811, lastCaughtUpTimestamp=1748530114811, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83925, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997120)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83924, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=2997014)])], lastFetchTimestamp=1748530114787, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:48:35,311] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=83925, metadata=Optional.empty)] for the first time for epoch 555 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:48:35,318] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=83925, metadata=Optional.empty)] for the first time for epoch 555 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:48:35,545] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=507, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83924, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=507, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42870-0-14', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@56cf6702]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:48:35,545] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1313, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83925, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1313, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42858-1-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5701632c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:48:35,545] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:48:35,546] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:48:35,546] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:48:35,546] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:48:35,551] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1340, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83924, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1340, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:42862-2-13', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@46627d2e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:48:35,552] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:48:35,553] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:49:51,611] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,612] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,612] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=555, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1091, highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=555, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,612] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:49:51,612] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 83984 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,612] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=555, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1632, highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=555, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,613] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 83984 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,614] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=555, voters=[1, 2, 3], electionTimeoutMs=1906, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=555, epochStartOffset=83924, highWatermark=Optional[LogOffsetMetadata(offset=83984, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001368)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83984, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001368)])], lastFetchTimestamp=1748530144352, lastCaughtUpTimestamp=1748530144352, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83984, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001368)])], lastFetchTimestamp=1748530144352, lastCaughtUpTimestamp=1748530144352, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83984, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001368)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,615] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=555, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=true)])]) with epoch 555 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,615] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=555, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=true)])]) with epoch 555 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,615] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=555, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=true)])]) with epoch 555 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,616] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=555, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=true)])]) with epoch 555 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,617] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1323) from ProspectiveState(epoch=555, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1632, highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,617] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1454) from ProspectiveState(epoch=555, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1091, highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,631] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1323) from ProspectiveState(epoch=555, leaderId=OptionalInt[3], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1632, highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,631] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1454) from ProspectiveState(epoch=555, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1091, highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,634] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=556, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=false)])]) with epoch 556 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,634] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1885, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=555, voters=[1, 2, 3], electionTimeoutMs=1906, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,634] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=556, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=false)])]) with epoch 556 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,648] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1885, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=555, voters=[1, 2, 3], electionTimeoutMs=1906, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,649] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1609, highWatermark=Optional.empty) from UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1885, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,662] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1609, highWatermark=Optional.empty) from UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1885, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,662] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=556, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=false)])]) with epoch 556 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,662] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=556, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=555, lastOffset=83984, preVote=false)])]) with epoch 556 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,663] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:49:51,663] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=556, epochStartOffset=83984, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1323) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,675] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=556, epochStartOffset=83984, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1323) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,694] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=556, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1609, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,694] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=556, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1454) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,707] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=556, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=556, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1609, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,707] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=556, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=556, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=83983, metadata=Optional.empty)], electionTimeoutMs=1454) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:49:51,744] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=83985, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001474)]) for the first time for epoch 556 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83985, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001474)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83985, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001474)])], lastFetchTimestamp=1748530191744, lastCaughtUpTimestamp=1748530191744, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=83984, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3001368)])], lastFetchTimestamp=1748530191709, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:49:52,246] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=83985, metadata=Optional.empty)] for the first time for epoch 556 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:49:52,437] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1330, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=83984, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1330, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33528-2-27', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@35073585]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:49:52,437] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1357, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=83985, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1357, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33536-0-28', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@449f57ce]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:49:52,438] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:49:52,438] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:49:52,438] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=524, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=83984, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=524, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33516-1-27', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@723e962b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:49:52,439] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:49:52,439] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:49:52,439] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:49:52,444] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:52:14,108] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:52:14,108] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 84343 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,108] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 84343 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,109] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,110] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=556, voters=[1, 2, 3], electionTimeoutMs=1777, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=556, epochStartOffset=83984, highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027067)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84343, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027067)])], lastFetchTimestamp=1748530330384, lastCaughtUpTimestamp=1748530330384, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84343, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027067)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84343, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027067)])], lastFetchTimestamp=1748530330383, lastCaughtUpTimestamp=1748530330383, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,109] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,110] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=556, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1840, highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=556, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,111] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=556, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1435, highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=556, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,111] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=556, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=556, lastOffset=84343, preVote=true)])]) with epoch 556 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,112] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=556, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=556, lastOffset=84343, preVote=true)])]) with epoch 556 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,112] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1507) from ProspectiveState(epoch=556, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1840, highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,113] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=556, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=556, lastOffset=84343, preVote=true)])]) with epoch 556 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,114] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1828) from ProspectiveState(epoch=556, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1435, highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,136] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1507) from ProspectiveState(epoch=556, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1840, highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,137] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1749, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=556, voters=[1, 2, 3], electionTimeoutMs=1777, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,147] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1828) from ProspectiveState(epoch=556, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1435, highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,148] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=557, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=556, lastOffset=84343, preVote=false)])]) with epoch 557 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,149] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=557, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=556, lastOffset=84343, preVote=false)])]) with epoch 557 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,159] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1749, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=556, voters=[1, 2, 3], electionTimeoutMs=1777, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,159] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(744516058). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:52:14,159] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1803, highWatermark=Optional.empty) from UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1749, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,159] INFO [QuorumController id=2] failAll(NotControllerException): failing generatePeriodicPerformanceMessage(730967312). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:52:14,159] INFO [QuorumController id=2] failAll(NotControllerException): failing maybeFenceStaleBroker(641523400). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:52:14,160] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1614227164). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:52:14,169] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1803, highWatermark=Optional.empty) from UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1749, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,169] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=557, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=556, lastOffset=84343, preVote=false)])]) with epoch 557 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,170] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=557, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=556, lastOffset=84343, preVote=false)])]) with epoch 557 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,172] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:14,172] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=557, epochStartOffset=84343, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1507) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,187] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=557, epochStartOffset=84343, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1507) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,212] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=557, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1803, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,213] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=557, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1828) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,233] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=557, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=557, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84343, metadata=Optional.empty)], electionTimeoutMs=1828) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,239] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=557, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=557, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1803, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:14,289] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=84344, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027173)]) for the first time for epoch 557 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84344, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027173)])], lastFetchTimestamp=1748530334289, lastCaughtUpTimestamp=1748530334289, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84344, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027173)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84343, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3027067)])], lastFetchTimestamp=1748530334235, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:52:14,790] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=84344, metadata=Optional.empty)] for the first time for epoch 557 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:52:14,892] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1422, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=84344, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1422, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:32832-0-21', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4f39eb7f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:52:14,892] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1449, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=84343, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1449, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:32838-1-21', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3144355f]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:52:14,893] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:52:14,893] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:52:14,894] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:52:14,894] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:52:14,926] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=616, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=84343, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=616, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:32848-2-21', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@68109b9]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:52:14,927] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:52:14,928] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:52:46,510] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:52:46,511] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 84402 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,511] INFO [RaftManager id=3] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 84402 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,512] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,512] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,512] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=557, voters=[1, 2, 3], electionTimeoutMs=1693, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=557, epochStartOffset=84343, highWatermark=Optional[LogOffsetMetadata(offset=84402, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031349)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84402, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031349)])], lastFetchTimestamp=1748530363333, lastCaughtUpTimestamp=1748530363333, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84402, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031349)])], lastFetchTimestamp=1748530363332, lastCaughtUpTimestamp=1748530363332, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84402, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031349)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,512] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=557, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1210, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=557, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,513] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=557, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1179, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=557, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,514] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=557, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=true)])]) with epoch 557 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,514] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=557, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=true)])]) with epoch 557 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,515] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=558, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1009) from ProspectiveState(epoch=557, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1210, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,519] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=557, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=true)])]) with epoch 557 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,520] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=558, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1434) from ProspectiveState(epoch=557, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1179, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,548] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=558, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1009) from ProspectiveState(epoch=557, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1210, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,549] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1655, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=557, voters=[1, 2, 3], electionTimeoutMs=1693, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,556] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=558, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1434) from ProspectiveState(epoch=557, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1179, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,558] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=558, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=false)])]) with epoch 558 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,558] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=558, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=false)])]) with epoch 558 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,577] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1655, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=557, voters=[1, 2, 3], electionTimeoutMs=1693, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,578] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(416587383). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:52:46,578] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) from UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1655, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,601] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) from UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1655, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,601] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=558, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=false)])]) with epoch 558 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,602] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=558, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=false)])]) with epoch 558 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,603] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=558, epochStartOffset=84402, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=558, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1009) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,603] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,603] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,604] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=558, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1254, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=558, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1434) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,605] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=558, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=true)])]) with epoch 558 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,608] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=559, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1420) from ProspectiveState(epoch=558, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1254, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,624] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=558, epochStartOffset=84402, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=558, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1009) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,629] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=559, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1420) from ProspectiveState(epoch=558, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1254, highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,632] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1704, highWatermark=Optional.empty) from UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,655] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1704, highWatermark=Optional.empty) from UnattachedState(epoch=558, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1757, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,656] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) from UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1704, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,665] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=558, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=true)])]) with epoch 558 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,666] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1311, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=558, epochStartOffset=84402, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84403, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031455)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84402, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031349)])], lastFetchTimestamp=1748530366664, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,679] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) from UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1704, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,680] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=559, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=false)])]) with epoch 559 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,682] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=559, epochStartOffset=84402, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=559, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1420) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,687] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1311, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=558, epochStartOffset=84402, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84403, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031455)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84402, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031349)])], lastFetchTimestamp=1748530366664, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,698] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=559, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=557, lastOffset=84402, preVote=false)])]) with epoch 559 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,708] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=559, epochStartOffset=84402, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=559, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84401, metadata=Optional.empty)], electionTimeoutMs=1420) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,759] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=559, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,760] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=559, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1311, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,777] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=559, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1311, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,777] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=559, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=559, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1974, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:52:46,779] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 84402 (kafka.log.UnifiedLog)
[2025-05-29 17:52:46,780] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 84402 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:52:46,781] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 84402 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:52:46,781] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=83924, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000083924.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:52:46,789] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 84402 with 0 producer ids in 8 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:52:46,789] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 0ms for snapshot load and 8ms for segment recovery from offset 84402 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:52:46,789] INFO [RaftManager id=2] Truncated to offset 84402 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:52:46,809] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=84403, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031455)]) for the first time for epoch 559 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84403, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031455)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84403, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031455)])], lastFetchTimestamp=1748530366809, lastCaughtUpTimestamp=1748530366809, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84402, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3031349)])], lastFetchTimestamp=1748530366790, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:52:47,312] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=84403, metadata=Optional.empty)] for the first time for epoch 559 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:52:47,320] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=84403, metadata=Optional.empty)] for the first time for epoch 559 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:52:47,659] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1439, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=84402, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1439, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33726-2-28', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@295bb235]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:52:47,659] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1466, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=84402, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1466, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33720-1-28', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6aa1226b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:52:47,659] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:52:47,659] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:52:47,660] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:52:47,660] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:52:47,708] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=633, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=84403, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=633, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:33738-0-29', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@7f821bf2]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:52:47,709] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:52:47,710] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:53:19,545] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:53:19,545] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 84461 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,546] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 84461 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,546] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,546] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,547] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=559, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1688, highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=559, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,547] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=559, voters=[1, 2, 3], electionTimeoutMs=1160, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=559, epochStartOffset=84402, highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035631)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035631)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035631)])], lastFetchTimestamp=1748530395864, lastCaughtUpTimestamp=1748530395864, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035631)])], lastFetchTimestamp=1748530395864, lastCaughtUpTimestamp=1748530395864, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,547] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=559, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1921, highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=559, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,548] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=559, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=559, lastOffset=84461, preVote=true)])]) with epoch 559 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,549] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=559, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=559, lastOffset=84461, preVote=true)])]) with epoch 559 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,550] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1474) from ProspectiveState(epoch=559, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1688, highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,551] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=559, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=559, lastOffset=84461, preVote=true)])]) with epoch 559 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,552] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1179) from ProspectiveState(epoch=559, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1921, highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,572] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(844418940). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:53:19,592] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1474) from ProspectiveState(epoch=559, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1688, highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,594] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1113, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=559, voters=[1, 2, 3], electionTimeoutMs=1160, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,605] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1179) from ProspectiveState(epoch=559, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1921, highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,609] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=560, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=559, lastOffset=84461, preVote=false)])]) with epoch 560 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,610] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=560, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=559, lastOffset=84461, preVote=false)])]) with epoch 560 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,636] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1113, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=559, voters=[1, 2, 3], electionTimeoutMs=1160, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,637] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1839, highWatermark=Optional.empty) from UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1113, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,652] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1839, highWatermark=Optional.empty) from UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1113, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,653] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=560, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=559, lastOffset=84461, preVote=false)])]) with epoch 560 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,653] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=560, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=559, lastOffset=84461, preVote=false)])]) with epoch 560 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,654] INFO [RaftManager id=2] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:19,654] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=560, epochStartOffset=84461, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1474) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,681] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=560, epochStartOffset=84461, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1474) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,739] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=560, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1839, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,739] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=560, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1179) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,766] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=560, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=560, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1839, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,767] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=560, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=560, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84461, metadata=Optional.empty)], electionTimeoutMs=1179) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:19,811] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=84462, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035737)]) for the first time for epoch 560 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84462, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035737)])], lastFetchTimestamp=1748530399811, lastCaughtUpTimestamp=1748530399811, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84462, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035737)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84461, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3035631)])], lastFetchTimestamp=1748530399768, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:53:20,323] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=84462, metadata=Optional.empty)] for the first time for epoch 560 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:53:20,454] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1483, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=84461, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1483, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:45924-2-14', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@6ad16c7a]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:53:20,455] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:20,455] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:53:20,487] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1456, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=84462, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1456, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:45922-1-14', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@33ed907c]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:53:20,488] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:20,489] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:53:20,523] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=650, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=84461, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=650, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:45932-0-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@4344b5b8]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:53:20,524] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:20,524] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:53:41,518] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,518] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,519] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=560, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1100, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=560, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,519] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=560, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1202, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=560, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,520] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:41,520] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 5618 due to node 3 being disconnected (elapsed time since creation: 2146ms, elapsed time since send: 2146ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:41,520] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:41,521] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 2093 due to node 3 being disconnected (elapsed time since creation: 2146ms, elapsed time since send: 2146ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:41,521] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=560, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=true)])]) with epoch 560 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,522] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=560, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=true)])]) with epoch 560 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,523] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=561, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1040) from ProspectiveState(epoch=560, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1202, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,523] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=561, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1943) from ProspectiveState(epoch=560, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1100, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,558] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=561, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1040) from ProspectiveState(epoch=560, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1202, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,558] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=561, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1943) from ProspectiveState(epoch=560, leaderId=OptionalInt[3], retries=1, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1100, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,560] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=561, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=false)])]) with epoch 561 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,560] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=561, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=false)])]) with epoch 561 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,608] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=560, epochStartOffset=84461, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], lastFetchTimestamp=1748530419375, lastCaughtUpTimestamp=1748530419375, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], lastFetchTimestamp=1748530419375, lastCaughtUpTimestamp=1748530419375, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,638] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=560, epochStartOffset=84461, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], lastFetchTimestamp=1748530419375, lastCaughtUpTimestamp=1748530419375, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], lastFetchTimestamp=1748530419375, lastCaughtUpTimestamp=1748530419375, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,639] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1905, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,639] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(625826294). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:53:41,653] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1905, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1169, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,653] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=561, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=false)])]) with epoch 561 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,654] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=561, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=false)])]) with epoch 561 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,655] INFO [RaftManager id=1] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,655] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=561, epochStartOffset=84501, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=561, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1040) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,655] INFO [RaftManager id=1] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,656] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=561, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1456, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=561, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1943) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,657] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=561, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=true)])]) with epoch 561 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,659] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=562, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1654) from ProspectiveState(epoch=561, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1456, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,679] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=562, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1654) from ProspectiveState(epoch=561, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1456, highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,680] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1864, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1905, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,685] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=561, epochStartOffset=84501, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=561, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1040) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,699] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1864, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from UnattachedState(epoch=561, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1905, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,700] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1864, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,716] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=561, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=true)])]) with epoch 561 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,718] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1591, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=561, epochStartOffset=84501, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84502, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038651)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,719] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) from UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1864, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,720] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=562, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=false)])]) with epoch 562 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,721] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=562, epochStartOffset=84501, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=562, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1654) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,737] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1591, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=561, epochStartOffset=84501, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84502, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038651)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,738] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=562, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=560, lastOffset=84501, preVote=false)])]) with epoch 562 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,745] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=562, epochStartOffset=84501, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=562, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84500, metadata=Optional.empty)], electionTimeoutMs=1654) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,771] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=562, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1591, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,771] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=562, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,792] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=562, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1591, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,792] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=562, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=562, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:53:41,794] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Truncating to offset 84501 (kafka.log.UnifiedLog)
[2025-05-29 17:53:41,796] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Loading producer state till offset 84501 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:53:41,796] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 84501 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:53:41,796] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=84402, file=/home/ammar/kafka_data/broker2_4.0.0/__cluster_metadata-0/00000000000000084402.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:53:41,805] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 84501 with 0 producer ids in 9 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:53:41,806] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker2_4.0.0] Producer state recovery took 1ms for snapshot load and 9ms for segment recovery from offset 84501 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:53:41,806] INFO [RaftManager id=2] Truncated to offset 84501 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:53:41,830] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=84502, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038651)]) for the first time for epoch 562 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84502, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038651)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84502, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038651)])], lastFetchTimestamp=1748530421829, lastCaughtUpTimestamp=1748530421829, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84501, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3038545)])], lastFetchTimestamp=1748530421807, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:53:42,301] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1495, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=84499, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1495, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:55544-1-29', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@534fd6ef]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:53:42,302] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:42,303] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:53:42,330] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1468, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=84500, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1468, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:55548-2-29', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@71842897]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:53:42,331] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:42,332] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:53:42,378] ERROR [ControllerApis nodeId=3] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=662, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=84501, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=662, headerVersion=2), connectionId='127.0.0.1:9099-127.0.0.1:55550-0-30', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@5c70e696]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 1.
[2025-05-29 17:53:42,379] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:53:42,379] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=84502, metadata=Optional.empty)] for the first time for epoch 562 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:53:42,380] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9093 (id: 1 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:55:07,382] INFO [RaftManager id=1] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:55:07,382] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw) at 84579 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,383] INFO [RaftManager id=1] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 84579 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,383] INFO [RaftManager id=2] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,384] INFO [RaftManager id=2] Completed transition to ProspectiveState(epoch=562, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1865, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=562, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,384] INFO [RaftManager id=1] Completed transition to ResignedState(localId=1, epoch=562, voters=[1, 2, 3], electionTimeoutMs=1676, unackedVoters=[2, 3], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=562, epochStartOffset=84501, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044134)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84579, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044134)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84579, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044134)])], lastFetchTimestamp=1748530461291, lastCaughtUpTimestamp=1748530461291, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84579, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044134)])], lastFetchTimestamp=1748530461291, lastCaughtUpTimestamp=1748530461291, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,384] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:55:07,384] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 5578 due to node 1 being disconnected (elapsed time since creation: 88594ms, elapsed time since send: 88594ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:55:07,385] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,385] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=562, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1108, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=562, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9093}), votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,386] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=562, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=562, lastOffset=84579, preVote=true)])]) with epoch 562 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,387] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=562, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=562, lastOffset=84579, preVote=true)])]) with epoch 562 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,387] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=563, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], electionTimeoutMs=1299) from ProspectiveState(epoch=562, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1865, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,401] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=563, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], electionTimeoutMs=1299) from ProspectiveState(epoch=562, leaderId=OptionalInt[1], retries=1, votedKey=Optional.empty, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1865, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,402] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1657, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=562, voters=[1, 2, 3], electionTimeoutMs=1676, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,402] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1091, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) from ProspectiveState(epoch=562, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1108, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,425] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1091, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) from ProspectiveState(epoch=562, leaderId=OptionalInt[1], retries=1, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1108, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,425] INFO [RaftManager id=3] Attempting durable transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1500, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1091, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,430] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1657, highWatermark=Optional.empty) from ResignedState(localId=1, epoch=562, voters=[1, 2, 3], electionTimeoutMs=1676, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,430] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(637194684). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:55:07,431] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1298, highWatermark=Optional.empty) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1657, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,431] INFO [QuorumController id=1] failAll(NotControllerException): failing maybeFenceStaleBroker(1774130473). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:55:07,431] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1816935790). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-05-29 17:55:07,454] INFO [RaftManager id=3] Completed transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1500, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1091, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,454] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=563, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=562, lastOffset=84579, preVote=false)])]) with epoch 563 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,456] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=563, epochStartOffset=84579, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=563, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], electionTimeoutMs=1299) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,463] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1298, highWatermark=Optional.empty) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1657, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,464] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=563, replicaId=2, replicaDirectoryId=gQB9-WrcbSgXuubveXZaRw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=562, lastOffset=84579, preVote=false)])]) with epoch 563 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:55:07,474] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=563, epochStartOffset=84579, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=gQB9-WrcbSgXuubveXZaRw, epoch=563, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], electionTimeoutMs=1299) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,495] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=563, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1298, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,495] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=563, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1500, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,513] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=563, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1298, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,517] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=563, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from UnattachedState(epoch=563, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], electionTimeoutMs=1500, highWatermark=Optional[LogOffsetMetadata(offset=84579, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:55:07,547] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=84580, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044240)]) for the first time for epoch 563 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84580, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044240)])], lastFetchTimestamp=1748530507547, lastCaughtUpTimestamp=1748530507547, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84580, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044240)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84579, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3044134)])], lastFetchTimestamp=1748530507518, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:55:08,048] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=84580, metadata=Optional.empty)] for the first time for epoch 563 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:55:08,378] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1517, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=84580, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1517, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:54062-1-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@55ba821e]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:55:08,379] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:55:08,379] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:55:08,482] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=684, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=84579, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=684, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:54094-0-16', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@3182963b]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:55:08,483] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:55:08,483] ERROR [ControllerApis nodeId=1] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1490, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=84579, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1490, headerVersion=2), connectionId='127.0.0.1:9093-127.0.0.1:54078-2-15', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@67f6d6d4]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 2.
[2025-05-29 17:55:08,484] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:55:08,484] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:55:08,485] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9096 (id: 2 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:56:27,728] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are [ReplicaKey(id=3, directoryId=<undefined>), ReplicaKey(id=2, directoryId=<undefined>), ReplicaKey(id=1, directoryId=<undefined>)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:56:27,728] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA) at 84818 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,729] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ) at 84818 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,729] INFO [RaftManager id=3] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,730] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=563, voters=[1, 2, 3], electionTimeoutMs=1568, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw), epoch=563, epochStartOffset=84579, highWatermark=Optional[LogOffsetMetadata(offset=84818, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061376)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84818, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061376)])], lastFetchTimestamp=1748530584568, lastCaughtUpTimestamp=1748530584568, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84818, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061376)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84818, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061376)])], lastFetchTimestamp=1748530584567, lastCaughtUpTimestamp=1748530584567, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,730] INFO [RaftManager id=1] Transitioning to Prospective state due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,730] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=563, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1833, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=563, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,731] INFO [RaftManager id=1] Completed transition to ProspectiveState(epoch=563, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1005, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=563, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9096}), votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,733] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=563, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=true)])]) with epoch 563 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,733] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=563, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=true)])]) with epoch 563 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,734] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=564, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1814) from ProspectiveState(epoch=563, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1005, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,736] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=563, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=true)])]) with epoch 563 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,738] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=564, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1980) from ProspectiveState(epoch=563, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1833, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,762] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=564, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1814) from ProspectiveState(epoch=563, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=UNRECORDED)}), electionTimeoutMs=1005, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,764] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1533, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=563, voters=[1, 2, 3], electionTimeoutMs=1568, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,767] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=564, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1980) from ProspectiveState(epoch=563, leaderId=OptionalInt[2], retries=1, votedKey=Optional[ReplicaKey(id=2, directoryId=gQB9-WrcbSgXuubveXZaRw)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1833, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,768] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=564, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=false)])]) with epoch 564 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,768] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=564, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=false)])]) with epoch 564 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,776] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1533, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=563, voters=[1, 2, 3], electionTimeoutMs=1568, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=<undefined>), ReplicaKey(id=3, directoryId=<undefined>)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,777] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1435, highWatermark=Optional.empty) from UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1533, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,787] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1435, highWatermark=Optional.empty) from UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1533, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,787] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=564, replicaId=1, replicaDirectoryId=9BipxcnV0iPfo3dF7zTczQ, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=false)])]) with epoch 564 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,788] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=564, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=false)])]) with epoch 564 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,789] INFO [RaftManager id=3] Insufficient remaining votes to become leader. We will backoff before retrying election again. Current epoch election state is EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}). (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,789] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=564, epochStartOffset=84818, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=564, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1814) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,789] INFO [RaftManager id=3] Transition to prospective after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,789] INFO [RaftManager id=3] Completed transition to ProspectiveState(epoch=564, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1625, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=564, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=REJECTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=REJECTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1980) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,791] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=564, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=true)])]) with epoch 564 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,792] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=565, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1934) from ProspectiveState(epoch=564, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1625, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,806] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=564, epochStartOffset=84818, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=9BipxcnV0iPfo3dF7zTczQ, epoch=564, retries=1, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=GRANTED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=REJECTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1814) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,812] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=565, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=UNRECORDED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1934) from ProspectiveState(epoch=564, leaderId=OptionalInt.empty, retries=2, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), electionTimeoutMs=1625, highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,813] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1399, highWatermark=Optional.empty) from UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1435, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,830] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1399, highWatermark=Optional.empty) from UnattachedState(epoch=564, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ)], voters=[1, 2, 3], electionTimeoutMs=1435, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,830] INFO [RaftManager id=2] Attempting durable transition to UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1135, highWatermark=Optional.empty) from UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1399, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,836] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=564, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=true)])]) with epoch 564 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,837] INFO [RaftManager id=1] Attempting durable transition to UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=564, epochStartOffset=84818, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84819, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061482)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,848] INFO [RaftManager id=2] Completed transition to UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1135, highWatermark=Optional.empty) from UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1399, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,849] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=565, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=false)])]) with epoch 565 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,850] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=565, epochStartOffset=84818, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=565, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1934) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,854] INFO [RaftManager id=1] Completed transition to UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=9BipxcnV0iPfo3dF7zTczQ), epoch=564, epochStartOffset=84818, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84819, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061482)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,855] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='vN8K3C85SQS4roeM5v3xFg', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, replicaEpoch=565, replicaId=3, replicaDirectoryId=4z4bdkITtiFi0ZO59qN5tA, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=563, lastOffset=84818, preVote=false)])]) with epoch 565 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,864] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA), epoch=565, epochStartOffset=84818, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=4z4bdkITtiFi0ZO59qN5tA, epoch=565, retries=2, epochElection=EpochElection(voterStates={1=VoterState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), state=UNRECORDED), 2=VoterState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), state=GRANTED), 3=VoterState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), state=GRANTED)}), highWatermark=Optional[LogOffsetMetadata(offset=84817, metadata=Optional.empty)], electionTimeoutMs=1934) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,879] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=565, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1135, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,879] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=565, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,896] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=565, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional[ReplicaKey(id=3, directoryId=4z4bdkITtiFi0ZO59qN5tA)], voters=[1, 2, 3], electionTimeoutMs=1135, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,901] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=565, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=DESKTOP-T3O0CHU.localdomain/<unresolved>:9099}), votedKey=Optional.empty, voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from UnattachedState(epoch=565, leaderId=OptionalInt.empty, votedKey=Optional.empty, voters=[1, 2, 3], electionTimeoutMs=1338, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-05-29 17:56:27,902] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Truncating to offset 84818 (kafka.log.UnifiedLog)
[2025-05-29 17:56:27,903] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Loading producer state till offset 84818 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:56:27,903] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Reloading from producer snapshot and rebuilding producer state from offset 84818 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:56:27,903] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=82497, file=/home/ammar/kafka_data/broker1_4.0.0/__cluster_metadata-0/00000000000000082497.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:56:27,910] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 84818 with 0 producer ids in 7 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-05-29 17:56:27,910] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/home/ammar/kafka_data/broker1_4.0.0] Producer state recovery took 0ms for snapshot load and 7ms for segment recovery from offset 84818 (org.apache.kafka.storage.internals.log.UnifiedLog)
[2025-05-29 17:56:27,911] INFO [RaftManager id=1] Truncated to offset 84818 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-05-29 17:56:27,927] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=84819, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061482)]) for the first time for epoch 565 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84819, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061482)])], lastFetchTimestamp=1748530587927, lastCaughtUpTimestamp=1748530587927, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84819, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061482)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=<undefined>), endOffset=Optional[LogOffsetMetadata(offset=84818, metadata=Optional[(segmentBaseOffset=41651,relativePositionInSegment=3061376)])], lastFetchTimestamp=1748530587912, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-05-29 17:56:28,427] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=84819, metadata=Optional.empty)] for the first time for epoch 565 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:56:28,440] INFO [RaftManager id=1] High watermark set to Optional[LogOffsetMetadata(offset=84819, metadata=Optional.empty)] for the first time for epoch 565 (org.apache.kafka.raft.FollowerState)
[2025-05-29 17:56:29,141] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1579, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=2, brokerEpoch=79171, currentMetadataOffset=84819, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=2, correlationId=1579, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:42820-0-22', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@b345c0d]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:56:29,141] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:56:29,142] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:56:29,383] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=746, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=1, brokerEpoch=82415, currentMetadataOffset=84819, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=1, correlationId=746, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:42836-1-22', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@231bd6cc]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:56:29,383] ERROR [ControllerApis nodeId=2] Unexpected error handling request RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1552, headerVersion=2) -- BrokerHeartbeatRequestData(brokerId=3, brokerEpoch=79176, currentMetadataOffset=84820, wantFence=false, wantShutDown=false, offlineLogDirs=[]) with context RequestContext(header=RequestHeader(apiKey=BROKER_HEARTBEAT, apiVersion=1, clientId=3, correlationId=1552, headerVersion=2), connectionId='127.0.0.1:9096-127.0.0.1:42842-2-22', clientAddress=/127.0.0.1, principal=User:CN=kafka,OU=None,O=None,L=None,ST=None,C=None, listenerName=ListenerName(CONTROLLER), securityProtocol=SSL, clientInformation=ClientInformation(softwareName=apache-kafka-java, softwareVersion=4.0.0), fromPrivilegedListener=false, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@75ca5e94]) (kafka.server.ControllerApis)
org.apache.kafka.common.errors.NotControllerException: The active controller appears to be node 3.
[2025-05-29 17:56:29,384] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:56:29,384] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-05-29 17:56:29,385] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
[2025-05-29 17:56:29,385] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:9099 (id: 3 rack: null isFenced: false) (kafka.server.NodeToControllerRequestThread)
